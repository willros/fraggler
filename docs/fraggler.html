<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>fraggler API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>
            <img src="./examples/logo.png" class="logo" alt="project logo"/>


            <h2>Contents</h2>
            <ul>
  <li><a href="#description">Description</a></li>
  <li><a href="#install">Install</a></li>
  <li><a href="#usage">Usage</a></li>
  <li><a href="#cli-tool">CLI Tool</a></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#FitLadderModel">FitLadderModel</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FitLadderModel.__init__">FitLadderModel</a>
                        </li>
                        <li>
                                <a class="variable" href="#FitLadderModel.n_knots">n_knots</a>
                        </li>
                        <li>
                                <a class="variable" href="#FitLadderModel.ladder_assigner">ladder_assigner</a>
                        </li>
                        <li>
                                <a class="variable" href="#FitLadderModel.fsa_file">fsa_file</a>
                        </li>
                        <li>
                                <a class="variable" href="#FitLadderModel.best_combination">best_combination</a>
                        </li>
                        <li>
                                <a class="variable" href="#FitLadderModel.adjusted_baisepair_df">adjusted_baisepair_df</a>
                        </li>
                        <li>
                                <a class="function" href="#FitLadderModel.fit_model">fit_model</a>
                        </li>
                        <li>
                                <a class="function" href="#FitLadderModel.model_score">model_score</a>
                        </li>
                        <li>
                                <a class="function" href="#FitLadderModel.generate_adjusted_trace_df">generate_adjusted_trace_df</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PeakLadderAssigner">PeakLadderAssigner</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PeakLadderAssigner.__init__">PeakLadderAssigner</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakLadderAssigner.fsa_file">fsa_file</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakLadderAssigner.assign_ladder_peak_sizes">assign_ladder_peak_sizes</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakLadderAssigner.get_peaks">get_peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakLadderAssigner.generate_graph">generate_graph</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakLadderAssigner.generate_combinations">generate_combinations</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakLadderAssigner.get_best_fit">get_best_fit</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#LADDERS">LADDERS</a>
            </li>
            <li>
                    <a class="function" href="#baseline_arPLS">baseline_arPLS</a>
            </li>
            <li>
                    <a class="class" href="#FsaFile">FsaFile</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FsaFile.__init__">FsaFile</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.file">file</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.file_name">file_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.fsa">fsa</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.ladder">ladder</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.trace_channel">trace_channel</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.normalize">normalize</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.ref_sizes">ref_sizes</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.ref_count">ref_count</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.size_standard_channel">size_standard_channel</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.min_interpeak_distance">min_interpeak_distance</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.min_height">min_height</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.max_ladder_trace_distance">max_ladder_trace_distance</a>
                        </li>
                        <li>
                                <a class="variable" href="#FsaFile.max_peak_count">max_peak_count</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#PeakArea">PeakArea</a>
            </li>
            <li>
                    <a class="class" href="#PeakAreaDeMultiplex">PeakAreaDeMultiplex</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PeakAreaDeMultiplex.__init__">PeakAreaDeMultiplex</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.peaks">peaks</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.cutoff">cutoff</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.peaks_dataframe">peaks_dataframe</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.peak_information">peak_information</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.file_name">file_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.peaks_index">peaks_index</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.found_peaks">found_peaks</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.area_plots">area_plots</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.divided_assays">divided_assays</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.number_of_assays">number_of_assays</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakAreaDeMultiplex.divided_peaks">divided_peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakAreaDeMultiplex.find_peak_widths">find_peak_widths</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakAreaDeMultiplex.divide_peak_assays">divide_peak_assays</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakAreaDeMultiplex.divide_peaks">divide_peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakAreaDeMultiplex.fit_lmfit_model">fit_lmfit_model</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakAreaDeMultiplex.calculate_quotient">calculate_quotient</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakAreaDeMultiplex.peak_position_area_dataframe">peak_position_area_dataframe</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakAreaDeMultiplex.plot_areas">plot_areas</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakAreaDeMultiplex.fit_assay_peaks">fit_assay_peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakAreaDeMultiplex.assays_dataframe">assays_dataframe</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PlotPeakArea">PlotPeakArea</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PlotPeakArea.__init__">PlotPeakArea</a>
                        </li>
                        <li>
                                <a class="variable" href="#PlotPeakArea.peak_area">peak_area</a>
                        </li>
                        <li>
                                <a class="function" href="#PlotPeakArea.plot_areas">plot_areas</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PlotLadder">PlotLadder</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PlotLadder.__init__">PlotLadder</a>
                        </li>
                        <li>
                                <a class="variable" href="#PlotLadder.model">model</a>
                        </li>
                        <li>
                                <a class="variable" href="#PlotLadder.plot_ladder_peaks">plot_ladder_peaks</a>
                        </li>
                        <li>
                                <a class="variable" href="#PlotLadder.plot_model_fit">plot_model_fit</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PlotRawData">PlotRawData</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PlotRawData.__init__">PlotRawData</a>
                        </li>
                        <li>
                                <a class="variable" href="#PlotRawData.fsa">fsa</a>
                        </li>
                        <li>
                                <a class="variable" href="#PlotRawData.plot_raw_data">plot_raw_data</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PlotPeaks">PlotPeaks</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PlotPeaks.__init__">PlotPeaks</a>
                        </li>
                        <li>
                                <a class="variable" href="#PlotPeaks.peaks">peaks</a>
                        </li>
                        <li>
                                <a class="variable" href="#PlotPeaks.plot_peaks">plot_peaks</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#generate_peak_table">generate_peak_table</a>
            </li>
            <li>
                    <a class="function" href="#get_files">get_files</a>
            </li>
            <li>
                    <a class="function" href="#setup_logging">setup_logging</a>
            </li>
            <li>
                    <a class="function" href="#make_fsa_data_df">make_fsa_data_df</a>
            </li>
            <li>
                    <a class="function" href="#plot_fsa_data">plot_fsa_data</a>
            </li>
            <li>
                    <a class="class" href="#PeakFinder">PeakFinder</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PeakFinder.__init__">PeakFinder</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakFinder.model">model</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakFinder.raw_data">raw_data</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakFinder.file_name">file_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakFinder.search_peaks_start">search_peaks_start</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakFinder.peak_height">peak_height</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakFinder.min_ratio">min_ratio</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakFinder.distance_between_assays">distance_between_assays</a>
                        </li>
                        <li>
                                <a class="variable" href="#PeakFinder.custom_peaks">custom_peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakFinder.run_validation">run_validation</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakFinder.find_peaks">find_peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakFinder.found_peaks">found_peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakFinder.find_peaks_agnostic">find_peaks_agnostic</a>
                        </li>
                        <li>
                                <a class="function" href="#PeakFinder.find_peaks_customized">find_peaks_customized</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FragglerPeak">FragglerPeak</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FragglerPeak.__init__">FragglerPeak</a>
                        </li>
                        <li>
                                <a class="variable" href="#FragglerPeak.fsa">fsa</a>
                        </li>
                        <li>
                                <a class="variable" href="#FragglerPeak.ladder_assigner">ladder_assigner</a>
                        </li>
                        <li>
                                <a class="variable" href="#FragglerPeak.model">model</a>
                        </li>
                        <li>
                                <a class="variable" href="#FragglerPeak.peaks">peaks</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FragglerArea">FragglerArea</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FragglerArea.__init__">FragglerArea</a>
                        </li>
                        <li>
                                <a class="variable" href="#FragglerArea.fsa">fsa</a>
                        </li>
                        <li>
                                <a class="variable" href="#FragglerArea.ladder_assigner">ladder_assigner</a>
                        </li>
                        <li>
                                <a class="variable" href="#FragglerArea.model">model</a>
                        </li>
                        <li>
                                <a class="variable" href="#FragglerArea.peaks">peaks</a>
                        </li>
                        <li>
                                <a class="variable" href="#FragglerArea.areas">areas</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#make_fraggler_peak">make_fraggler_peak</a>
            </li>
            <li>
                    <a class="function" href="#make_fraggler_area">make_fraggler_area</a>
            </li>
            <li>
                    <a class="function" href="#generate_peak_report">generate_peak_report</a>
            </li>
            <li>
                    <a class="function" href="#generate_area_report">generate_area_report</a>
            </li>
            <li>
                    <a class="function" href="#generate_no_peaks_report">generate_no_peaks_report</a>
            </li>
            <li>
                    <a class="function" href="#peak_report">peak_report</a>
            </li>
            <li>
                    <a class="function" href="#area_report">area_report</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
fraggler    </h1>

                        <div class="docstring"><p><img 
width="481" height="555" src="data:image/png;base64,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"></p>

<h2 id="description">Description</h2>

<p>Fraggler is for fragment analysis in Python!
Fraggler is a Python package that provides functionality for analyzing and generating reports for fsa files. It offers both a Python API and a command-line tool for ease of use.</p>

<hr />

<h3 id="features">Features</h3>

<p><code>Peak Area Report Generation</code>: Fraggler allows you to generate peak area reports for all input files. The package calculates peak areas based on specified parameters and generates a report summarizing the results.</p>

<p><code>Combined Peak Table Generation</code>: Fraggler provides a command-line tool to generate a combined dataframe of peaks for all input files. This allows you to easily analyze and compare peaks across multiple files.</p>

<p><code>Customization Options</code>: Fraggler offers various customization options to tailor the analysis to your specific needs. You can specify parameters such as ladder type, peak model, minimum ratio, minimum height, cutoff value, trace channel, peak height, and even provide a custom peaks file for specific assays and intervals.</p>

<h2 id="install">Install</h2>

<p>Via pip:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>fraggler
</code></pre>
</div>

<h2 id="usage">Usage</h2>

<p>To get an overview how the library can be used in a python environment, please look at <code>tutorial.ipynb</code>.</p>

<h2 id="cli-tool">CLI Tool</h2>

<h3 id="fraggler-area-and-fraggler-peak"><code>fraggler area</code> and <code>fraggler peak</code></h3>

<h4 id="usage-2">Usage</h4>

<p>To generate peak area reports and a peak table for all input files, use the <code>fraggler area</code> or <code>fraggler peak</code> command followed by the required positional arguments and any optional flags.</p>

<ul>
<li>If not specified, fraggler finds peaks agnostic in the <code>fsa file</code>. To specifiy custom assays with certain peaks and intervals, the user can add a .csv file to the <code>--custom_peaks</code> argument. The csv file MUST have the following shape:</li>
</ul>

<table>
<thead>
<tr>
  <th>name</th>
  <th>start</th>
  <th>stop</th>
  <th>amount</th>
  <th>min_ratio</th>
  <th>which</th>
</tr>
</thead>
<tbody>
<tr>
  <td>prt1</td>
  <td>140</td>
  <td>150</td>
  <td>2</td>
  <td>0.2</td>
  <td>FIRST</td>
</tr>
</tbody>
</table>

<p>If <code>amount</code> or <code>min_ratio</code> are left emtpy, <code><a href="">fraggler</a></code> will take all peaks inside the interval. If amount is not empty, fraggler will include the top <code>N</code> peaks in the interval, based on height. If <code>min_ratio</code> is set, only peaks with the a ratio of the <code>min_ratio</code> of the highest peak is included, <em>e.g.</em> if <code>min_ratio == .02</code>, only peaks with a height of 20 is included, if the highest peak is 100 units. The <code>which</code> column decides which peaks that should be included if there is more than the number in <code>amount</code> peaks found in that area. if <code>FIRST</code> is set, then the two first peaks are chosen. If <code>LARGEST</code> are set, then the two largests peaks in the area are chosen. If <code>which</code> is left empty, the default of is <code>LARGEST</code>.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">fraggler peak IN_PATH OUT_FOLDER --ladder LIZ &lt;flags&gt;</span>
</code></pre>
</div>

<h4 id="positional-arguments">Positional Arguments</h4>

<p>The following positional arguments are required:</p>

<ul>
<li><code>IN_PATH</code>: Type <code>str</code>. Specifies the input path.</li>
<li><code>OUT_FOLDER</code>: Type <code>str</code>. Specifies the output folder.</li>
<li><code>LADDER</code>: Type <code>str</code>. Specifies the ladder used in the experiment.</li>
</ul>

<h4 id="flags">Flags</h4>

<p>The following flags can be used with the <code>fraggler peak</code> or <code>fraggler area</code> command:</p>

<ul>
<li><code>-l, --ladder=LADDER</code>: Type <code>str</code>. Specifies the ladder. Default value: 'LIZ'.</li>
<li><code>--peak_model=PEAK_MODEL</code>: Type <code>str</code>. Specifies the peak model. Default value: 'gauss'.</li>
<li><code>--min_ratio=MIN_RATIO</code>: Type <code>float</code>. Specifies the minimum ratio. Default value: 0.3.</li>
<li><code>--min_height=MIN_HEIGHT</code>: Type <code>int</code>. Specifies the minimum height. Default value: 100.</li>
<li><code>--cutoff=CUTOFF</code>: Type <code>int</code>. Specifies the cutoff value. Default value: 175.</li>
<li><code>-t, --trace_channel=TRACE_CHANNEL</code>: Type <code>str</code>. Specifies the trace channel. Default value: 'DATA9'.</li>
<li><code>--peak_height=PEAK_HEIGHT</code>: Type <code>int</code>. Specifies the peak height. Default value: 200.</li>
<li><code>--custom_peaks=CUSTOM_PEAKS</code>: Type <code>Optional[str]</code>. Specifies custom peaks. Default value: None.</li>
<li><code>-e, --excel=EXCEL</code>: Type: <code>bool</code>, Default: True</li>
</ul>

<h4 id="typical-usage">Typical usage</h4>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="go">fraggler peak IN_FOLDER OUT_FOLDER ORANGE --min_ratio=0.2 </span>
</code></pre>
</div>
</div>

                        <input id="mod-fraggler-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-fraggler-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="sd">.. include:: ../README.md</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;William Rosenbaum and Pr Larsson&quot;</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="kn">from</span> <span class="nn">.ladder_fitting.fit_ladder_model</span> <span class="kn">import</span> <span class="n">FitLadderModel</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="kn">from</span> <span class="nn">.ladder_fitting.peak_ladder_assigner</span> <span class="kn">import</span> <span class="n">PeakLadderAssigner</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="kn">from</span> <span class="nn">.ladders.ladders</span> <span class="kn">import</span> <span class="n">LADDERS</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="kn">from</span> <span class="nn">.plotting.plot_ladder</span> <span class="kn">import</span> <span class="n">PlotLadder</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="kn">from</span> <span class="nn">.utils.baseline_removal</span> <span class="kn">import</span> <span class="n">baseline_arPLS</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="kn">from</span> <span class="nn">.utils.fsa_file</span> <span class="kn">import</span> <span class="n">FsaFile</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="kn">from</span> <span class="nn">.utils.utils</span> <span class="kn">import</span> <span class="n">get_files</span><span class="p">,</span> <span class="n">setup_logging</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="kn">from</span> <span class="nn">.utils.fraggler_object</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a>    <span class="n">FragglerPeak</span><span class="p">,</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>    <span class="n">FragglerArea</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a>    <span class="n">make_fraggler_peak</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a>    <span class="n">make_fraggler_area</span><span class="p">,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="p">)</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="kn">from</span> <span class="nn">.applications.peak_area_multiplex</span> <span class="kn">import</span> <span class="n">PeakAreaDeMultiplex</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="kn">from</span> <span class="nn">.plotting.plot_peak_area</span> <span class="kn">import</span> <span class="n">PlotPeakArea</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="kn">from</span> <span class="nn">.plotting.plot_raw_data</span> <span class="kn">import</span> <span class="n">PlotRawData</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="kn">from</span> <span class="nn">.plotting.plot_peaks</span> <span class="kn">import</span> <span class="n">PlotPeaks</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="kn">from</span> <span class="nn">.plotting.plot_channels</span> <span class="kn">import</span> <span class="n">make_fsa_data_df</span><span class="p">,</span> <span class="n">plot_fsa_data</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a><span class="kn">from</span> <span class="nn">.reports.reports</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>    <span class="n">generate_peak_report</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>    <span class="n">generate_area_report</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>    <span class="n">generate_no_peaks_report</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="p">)</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a><span class="kn">from</span> <span class="nn">.functions.generate_peak_table</span> <span class="kn">import</span> <span class="n">generate_peak_table</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a><span class="kn">from</span> <span class="nn">.utils.peak_finder</span> <span class="kn">import</span> <span class="n">PeakFinder</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a><span class="kn">from</span> <span class="nn">.cli</span> <span class="kn">import</span> <span class="n">peak_report</span><span class="p">,</span> <span class="n">area_report</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>    <span class="s2">&quot;FitLadderModel&quot;</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>    <span class="s2">&quot;PeakLadderAssigner&quot;</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="s2">&quot;LADDERS&quot;</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="s2">&quot;baseline_arPLS&quot;</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>    <span class="s2">&quot;FsaFile&quot;</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="s2">&quot;PeakArea&quot;</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="s2">&quot;PeakAreaDeMultiplex&quot;</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>    <span class="s2">&quot;PlotPeakArea&quot;</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="s2">&quot;PlotLadder&quot;</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>    <span class="s2">&quot;PlotRawData&quot;</span><span class="p">,</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="s2">&quot;PlotPeaks&quot;</span><span class="p">,</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>    <span class="s2">&quot;generate_peak_table&quot;</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="s2">&quot;get_files&quot;</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>    <span class="s2">&quot;setup_logging&quot;</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>    <span class="s2">&quot;make_fsa_data_df&quot;</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a>    <span class="s2">&quot;plot_fsa_data&quot;</span><span class="p">,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>    <span class="s2">&quot;PeakFinder&quot;</span><span class="p">,</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>    <span class="s2">&quot;FragglerPeak&quot;</span><span class="p">,</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>    <span class="s2">&quot;FragglerArea&quot;</span><span class="p">,</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a>    <span class="s2">&quot;make_fraggler_peak&quot;</span><span class="p">,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>    <span class="s2">&quot;make_fraggler_area&quot;</span><span class="p">,</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a>    <span class="s2">&quot;generate_peak_report&quot;</span><span class="p">,</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a>    <span class="s2">&quot;generate_area_report&quot;</span><span class="p">,</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a>    <span class="s2">&quot;generate_no_peaks_report&quot;</span><span class="p">,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">60</span></a>    <span class="s2">&quot;peak_report&quot;</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">61</span></a>    <span class="s2">&quot;area_report&quot;</span><span class="p">,</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">62</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="FitLadderModel">
                            <input id="FitLadderModel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FitLadderModel</span>:

                <label class="view-source-button" for="FitLadderModel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FitLadderModel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FitLadderModel-25"><a href="#FitLadderModel-25"><span class="linenos"> 25</span></a><span class="k">class</span> <span class="nc">FitLadderModel</span><span class="p">:</span>
</span><span id="FitLadderModel-26"><a href="#FitLadderModel-26"><span class="linenos"> 26</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ladder_assigner</span><span class="p">:</span> <span class="n">PeakLadderAssigner</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FitLadderModel-27"><a href="#FitLadderModel-27"><span class="linenos"> 27</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FitLadderModel-28"><a href="#FitLadderModel-28"><span class="linenos"> 28</span></a><span class="sd">        Initialize FitLadderModel object with ladder_assigner object and its attributes.</span>
</span><span id="FitLadderModel-29"><a href="#FitLadderModel-29"><span class="linenos"> 29</span></a>
</span><span id="FitLadderModel-30"><a href="#FitLadderModel-30"><span class="linenos"> 30</span></a><span class="sd">        Args:</span>
</span><span id="FitLadderModel-31"><a href="#FitLadderModel-31"><span class="linenos"> 31</span></a><span class="sd">            ladder_assigner (PeakLadderAssigner): Object of PeakLadderAssigner class.</span>
</span><span id="FitLadderModel-32"><a href="#FitLadderModel-32"><span class="linenos"> 32</span></a>
</span><span id="FitLadderModel-33"><a href="#FitLadderModel-33"><span class="linenos"> 33</span></a><span class="sd">        Returns:</span>
</span><span id="FitLadderModel-34"><a href="#FitLadderModel-34"><span class="linenos"> 34</span></a><span class="sd">            None.</span>
</span><span id="FitLadderModel-35"><a href="#FitLadderModel-35"><span class="linenos"> 35</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FitLadderModel-36"><a href="#FitLadderModel-36"><span class="linenos"> 36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_knots</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="FitLadderModel-37"><a href="#FitLadderModel-37"><span class="linenos"> 37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ladder_assigner</span> <span class="o">=</span> <span class="n">ladder_assigner</span>
</span><span id="FitLadderModel-38"><a href="#FitLadderModel-38"><span class="linenos"> 38</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ladder_assigner</span><span class="o">.</span><span class="n">fsa_file</span>
</span><span id="FitLadderModel-39"><a href="#FitLadderModel-39"><span class="linenos"> 39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">best_combination</span> <span class="o">=</span> <span class="n">ladder_assigner</span><span class="o">.</span><span class="n">assign_ladder_peak_sizes</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="FitLadderModel-40"><a href="#FitLadderModel-40"><span class="linenos"> 40</span></a>            <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="FitLadderModel-41"><a href="#FitLadderModel-41"><span class="linenos"> 41</span></a>        <span class="p">)</span>
</span><span id="FitLadderModel-42"><a href="#FitLadderModel-42"><span class="linenos"> 42</span></a>
</span><span id="FitLadderModel-43"><a href="#FitLadderModel-43"><span class="linenos"> 43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_model</span><span class="p">()</span>
</span><span id="FitLadderModel-44"><a href="#FitLadderModel-44"><span class="linenos"> 44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_score</span><span class="p">()</span>
</span><span id="FitLadderModel-45"><a href="#FitLadderModel-45"><span class="linenos"> 45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_baisepair_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_adjusted_trace_df</span><span class="p">()</span>
</span><span id="FitLadderModel-46"><a href="#FitLadderModel-46"><span class="linenos"> 46</span></a>
</span><span id="FitLadderModel-47"><a href="#FitLadderModel-47"><span class="linenos"> 47</span></a>    <span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FitLadderModel-48"><a href="#FitLadderModel-48"><span class="linenos"> 48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FitLadderModel-49"><a href="#FitLadderModel-49"><span class="linenos"> 49</span></a><span class="sd">        Fit model based on ladder type.</span>
</span><span id="FitLadderModel-50"><a href="#FitLadderModel-50"><span class="linenos"> 50</span></a>
</span><span id="FitLadderModel-51"><a href="#FitLadderModel-51"><span class="linenos"> 51</span></a><span class="sd">        Returns:</span>
</span><span id="FitLadderModel-52"><a href="#FitLadderModel-52"><span class="linenos"> 52</span></a><span class="sd">            None.</span>
</span><span id="FitLadderModel-53"><a href="#FitLadderModel-53"><span class="linenos"> 53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FitLadderModel-54"><a href="#FitLadderModel-54"><span class="linenos"> 54</span></a>        <span class="n">ladder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ladder</span>
</span><span id="FitLadderModel-55"><a href="#FitLadderModel-55"><span class="linenos"> 55</span></a>        <span class="k">if</span> <span class="n">ladder</span> <span class="o">==</span> <span class="s2">&quot;ROX&quot;</span><span class="p">:</span>
</span><span id="FitLadderModel-56"><a href="#FitLadderModel-56"><span class="linenos"> 56</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fit_ROX_ladder</span><span class="p">()</span>
</span><span id="FitLadderModel-57"><a href="#FitLadderModel-57"><span class="linenos"> 57</span></a>        <span class="k">elif</span> <span class="n">ladder</span> <span class="o">==</span> <span class="s2">&quot;LIZ&quot;</span> <span class="ow">or</span> <span class="n">ladder</span> <span class="o">==</span> <span class="s2">&quot;ORANGE&quot;</span><span class="p">:</span>
</span><span id="FitLadderModel-58"><a href="#FitLadderModel-58"><span class="linenos"> 58</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fit_LIZ_ladder</span><span class="p">()</span>
</span><span id="FitLadderModel-59"><a href="#FitLadderModel-59"><span class="linenos"> 59</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FitLadderModel-60"><a href="#FitLadderModel-60"><span class="linenos"> 60</span></a>            <span class="k">raise</span> <span class="n">LadderNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">ladder</span><span class="si">}</span><span class="s2">&#39; is not a valid ladder&quot;</span><span class="p">)</span>
</span><span id="FitLadderModel-61"><a href="#FitLadderModel-61"><span class="linenos"> 61</span></a>
</span><span id="FitLadderModel-62"><a href="#FitLadderModel-62"><span class="linenos"> 62</span></a>    <span class="k">def</span> <span class="nf">model_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="FitLadderModel-63"><a href="#FitLadderModel-63"><span class="linenos"> 63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FitLadderModel-64"><a href="#FitLadderModel-64"><span class="linenos"> 64</span></a><span class="sd">        Calculate mean squared error and R-squared score of the fitted model.</span>
</span><span id="FitLadderModel-65"><a href="#FitLadderModel-65"><span class="linenos"> 65</span></a>
</span><span id="FitLadderModel-66"><a href="#FitLadderModel-66"><span class="linenos"> 66</span></a><span class="sd">        Returns:</span>
</span><span id="FitLadderModel-67"><a href="#FitLadderModel-67"><span class="linenos"> 67</span></a><span class="sd">            Tuple (mse, r2).</span>
</span><span id="FitLadderModel-68"><a href="#FitLadderModel-68"><span class="linenos"> 68</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FitLadderModel-69"><a href="#FitLadderModel-69"><span class="linenos"> 69</span></a>        <span class="n">true_Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span>
</span><span id="FitLadderModel-70"><a href="#FitLadderModel-70"><span class="linenos"> 70</span></a>        <span class="n">predicted_Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_combination</span><span class="p">)</span>
</span><span id="FitLadderModel-71"><a href="#FitLadderModel-71"><span class="linenos"> 71</span></a>        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">true_Y</span><span class="p">,</span> <span class="n">predicted_Y</span><span class="p">)</span>
</span><span id="FitLadderModel-72"><a href="#FitLadderModel-72"><span class="linenos"> 72</span></a>        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">true_Y</span><span class="p">,</span> <span class="n">predicted_Y</span><span class="p">)</span>
</span><span id="FitLadderModel-73"><a href="#FitLadderModel-73"><span class="linenos"> 73</span></a>
</span><span id="FitLadderModel-74"><a href="#FitLadderModel-74"><span class="linenos"> 74</span></a>        <span class="k">return</span> <span class="n">mse</span><span class="p">,</span> <span class="n">r2</span>
</span><span id="FitLadderModel-75"><a href="#FitLadderModel-75"><span class="linenos"> 75</span></a>
</span><span id="FitLadderModel-76"><a href="#FitLadderModel-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="nf">generate_adjusted_trace_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="FitLadderModel-77"><a href="#FitLadderModel-77"><span class="linenos"> 77</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FitLadderModel-78"><a href="#FitLadderModel-78"><span class="linenos"> 78</span></a><span class="sd">        Generate a dataframe with adjusted basepairs and peaks.</span>
</span><span id="FitLadderModel-79"><a href="#FitLadderModel-79"><span class="linenos"> 79</span></a>
</span><span id="FitLadderModel-80"><a href="#FitLadderModel-80"><span class="linenos"> 80</span></a><span class="sd">        Returns:</span>
</span><span id="FitLadderModel-81"><a href="#FitLadderModel-81"><span class="linenos"> 81</span></a><span class="sd">            Dataframe with columns time, peaks and basepairs.</span>
</span><span id="FitLadderModel-82"><a href="#FitLadderModel-82"><span class="linenos"> 82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FitLadderModel-83"><a href="#FitLadderModel-83"><span class="linenos"> 83</span></a>        <span class="c1"># Continue loop until all basepairs are unique by changing n_knots in SplineTransformer</span>
</span><span id="FitLadderModel-84"><a href="#FitLadderModel-84"><span class="linenos"> 84</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span><span id="FitLadderModel-85"><a href="#FitLadderModel-85"><span class="linenos"> 85</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FitLadderModel-86"><a href="#FitLadderModel-86"><span class="linenos"> 86</span></a>                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;peaks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">trace</span><span class="p">})</span>
</span><span id="FitLadderModel-87"><a href="#FitLadderModel-87"><span class="linenos"> 87</span></a>                <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="FitLadderModel-88"><a href="#FitLadderModel-88"><span class="linenos"> 88</span></a>                <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">})</span>
</span><span id="FitLadderModel-89"><a href="#FitLadderModel-89"><span class="linenos"> 89</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
</span><span id="FitLadderModel-90"><a href="#FitLadderModel-90"><span class="linenos"> 90</span></a>                    <span class="n">basepairs</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="FitLadderModel-91"><a href="#FitLadderModel-91"><span class="linenos"> 91</span></a>                        <span class="n">x</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="FitLadderModel-92"><a href="#FitLadderModel-92"><span class="linenos"> 92</span></a>                    <span class="p">)</span>
</span><span id="FitLadderModel-93"><a href="#FitLadderModel-93"><span class="linenos"> 93</span></a>                <span class="p">)</span>
</span><span id="FitLadderModel-94"><a href="#FitLadderModel-94"><span class="linenos"> 94</span></a>                <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="FitLadderModel-95"><a href="#FitLadderModel-95"><span class="linenos"> 95</span></a>            <span class="p">)</span>
</span><span id="FitLadderModel-96"><a href="#FitLadderModel-96"><span class="linenos"> 96</span></a>
</span><span id="FitLadderModel-97"><a href="#FitLadderModel-97"><span class="linenos"> 97</span></a>            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">nunique</span><span class="p">():</span>
</span><span id="FitLadderModel-98"><a href="#FitLadderModel-98"><span class="linenos"> 98</span></a>                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ladder fitting model: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FitLadderModel-99"><a href="#FitLadderModel-99"><span class="linenos"> 99</span></a>                <span class="k">return</span> <span class="n">df</span>
</span><span id="FitLadderModel-100"><a href="#FitLadderModel-100"><span class="linenos">100</span></a>            <span class="c1"># If not all bp are unique</span>
</span><span id="FitLadderModel-101"><a href="#FitLadderModel-101"><span class="linenos">101</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_knots</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="FitLadderModel-102"><a href="#FitLadderModel-102"><span class="linenos">102</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit_model</span><span class="p">()</span>
</span><span id="FitLadderModel-103"><a href="#FitLadderModel-103"><span class="linenos">103</span></a>
</span><span id="FitLadderModel-104"><a href="#FitLadderModel-104"><span class="linenos">104</span></a>        <span class="k">raise</span> <span class="n">ModelFittingError</span><span class="p">(</span>
</span><span id="FitLadderModel-105"><a href="#FitLadderModel-105"><span class="linenos">105</span></a>            <span class="s2">&quot;There is a problem with the fitting of the model to the ladder&quot;</span>
</span><span id="FitLadderModel-106"><a href="#FitLadderModel-106"><span class="linenos">106</span></a>        <span class="p">)</span>
</span><span id="FitLadderModel-107"><a href="#FitLadderModel-107"><span class="linenos">107</span></a>
</span><span id="FitLadderModel-108"><a href="#FitLadderModel-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">_fit_ROX_ladder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FitLadderModel-109"><a href="#FitLadderModel-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FitLadderModel-110"><a href="#FitLadderModel-110"><span class="linenos">110</span></a><span class="sd">        Fit model with ROX ladder.</span>
</span><span id="FitLadderModel-111"><a href="#FitLadderModel-111"><span class="linenos">111</span></a>
</span><span id="FitLadderModel-112"><a href="#FitLadderModel-112"><span class="linenos">112</span></a><span class="sd">        Returns:</span>
</span><span id="FitLadderModel-113"><a href="#FitLadderModel-113"><span class="linenos">113</span></a><span class="sd">            None.</span>
</span><span id="FitLadderModel-114"><a href="#FitLadderModel-114"><span class="linenos">114</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FitLadderModel-115"><a href="#FitLadderModel-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
</span><span id="FitLadderModel-116"><a href="#FitLadderModel-116"><span class="linenos">116</span></a>            <span class="n">SplineTransformer</span><span class="p">(</span>
</span><span id="FitLadderModel-117"><a href="#FitLadderModel-117"><span class="linenos">117</span></a>                <span class="n">degree</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_knots</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_knots</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">extrapolation</span><span class="o">=</span><span class="s2">&quot;continue&quot;</span>
</span><span id="FitLadderModel-118"><a href="#FitLadderModel-118"><span class="linenos">118</span></a>            <span class="p">),</span>
</span><span id="FitLadderModel-119"><a href="#FitLadderModel-119"><span class="linenos">119</span></a>            <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="FitLadderModel-120"><a href="#FitLadderModel-120"><span class="linenos">120</span></a>        <span class="p">)</span>
</span><span id="FitLadderModel-121"><a href="#FitLadderModel-121"><span class="linenos">121</span></a>
</span><span id="FitLadderModel-122"><a href="#FitLadderModel-122"><span class="linenos">122</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_combination</span>
</span><span id="FitLadderModel-123"><a href="#FitLadderModel-123"><span class="linenos">123</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span>
</span><span id="FitLadderModel-124"><a href="#FitLadderModel-124"><span class="linenos">124</span></a>
</span><span id="FitLadderModel-125"><a href="#FitLadderModel-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="FitLadderModel-126"><a href="#FitLadderModel-126"><span class="linenos">126</span></a>
</span><span id="FitLadderModel-127"><a href="#FitLadderModel-127"><span class="linenos">127</span></a>    <span class="k">def</span> <span class="nf">_fit_LIZ_ladder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FitLadderModel-128"><a href="#FitLadderModel-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FitLadderModel-129"><a href="#FitLadderModel-129"><span class="linenos">129</span></a><span class="sd">        Fit model with LIZ ladder.</span>
</span><span id="FitLadderModel-130"><a href="#FitLadderModel-130"><span class="linenos">130</span></a>
</span><span id="FitLadderModel-131"><a href="#FitLadderModel-131"><span class="linenos">131</span></a><span class="sd">        Returns:</span>
</span><span id="FitLadderModel-132"><a href="#FitLadderModel-132"><span class="linenos">132</span></a><span class="sd">            None.</span>
</span><span id="FitLadderModel-133"><a href="#FitLadderModel-133"><span class="linenos">133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FitLadderModel-134"><a href="#FitLadderModel-134"><span class="linenos">134</span></a>        <span class="c1"># NB!</span>
</span><span id="FitLadderModel-135"><a href="#FitLadderModel-135"><span class="linenos">135</span></a>        <span class="c1"># Changed the SplineTransformer(n_knots=2) instead of 3!!</span>
</span><span id="FitLadderModel-136"><a href="#FitLadderModel-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
</span><span id="FitLadderModel-137"><a href="#FitLadderModel-137"><span class="linenos">137</span></a>            <span class="n">SplineTransformer</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_knots</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_knots</span><span class="p">,</span> <span class="n">extrapolation</span><span class="o">=</span><span class="s2">&quot;continue&quot;</span><span class="p">),</span>
</span><span id="FitLadderModel-138"><a href="#FitLadderModel-138"><span class="linenos">138</span></a>            <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="FitLadderModel-139"><a href="#FitLadderModel-139"><span class="linenos">139</span></a>        <span class="p">)</span>
</span><span id="FitLadderModel-140"><a href="#FitLadderModel-140"><span class="linenos">140</span></a>
</span><span id="FitLadderModel-141"><a href="#FitLadderModel-141"><span class="linenos">141</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_combination</span>
</span><span id="FitLadderModel-142"><a href="#FitLadderModel-142"><span class="linenos">142</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span>
</span><span id="FitLadderModel-143"><a href="#FitLadderModel-143"><span class="linenos">143</span></a>
</span><span id="FitLadderModel-144"><a href="#FitLadderModel-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></pre></div>


    

                            <div id="FitLadderModel.__init__" class="classattr">
                                        <input id="FitLadderModel.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">FitLadderModel</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">ladder_assigner</span><span class="p">:</span> <span class="n"><a href="#PeakLadderAssigner">PeakLadderAssigner</a></span></span>)</span>

                <label class="view-source-button" for="FitLadderModel.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FitLadderModel.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FitLadderModel.__init__-26"><a href="#FitLadderModel.__init__-26"><span class="linenos">26</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ladder_assigner</span><span class="p">:</span> <span class="n">PeakLadderAssigner</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FitLadderModel.__init__-27"><a href="#FitLadderModel.__init__-27"><span class="linenos">27</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FitLadderModel.__init__-28"><a href="#FitLadderModel.__init__-28"><span class="linenos">28</span></a><span class="sd">        Initialize FitLadderModel object with ladder_assigner object and its attributes.</span>
</span><span id="FitLadderModel.__init__-29"><a href="#FitLadderModel.__init__-29"><span class="linenos">29</span></a>
</span><span id="FitLadderModel.__init__-30"><a href="#FitLadderModel.__init__-30"><span class="linenos">30</span></a><span class="sd">        Args:</span>
</span><span id="FitLadderModel.__init__-31"><a href="#FitLadderModel.__init__-31"><span class="linenos">31</span></a><span class="sd">            ladder_assigner (PeakLadderAssigner): Object of PeakLadderAssigner class.</span>
</span><span id="FitLadderModel.__init__-32"><a href="#FitLadderModel.__init__-32"><span class="linenos">32</span></a>
</span><span id="FitLadderModel.__init__-33"><a href="#FitLadderModel.__init__-33"><span class="linenos">33</span></a><span class="sd">        Returns:</span>
</span><span id="FitLadderModel.__init__-34"><a href="#FitLadderModel.__init__-34"><span class="linenos">34</span></a><span class="sd">            None.</span>
</span><span id="FitLadderModel.__init__-35"><a href="#FitLadderModel.__init__-35"><span class="linenos">35</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FitLadderModel.__init__-36"><a href="#FitLadderModel.__init__-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_knots</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="FitLadderModel.__init__-37"><a href="#FitLadderModel.__init__-37"><span class="linenos">37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ladder_assigner</span> <span class="o">=</span> <span class="n">ladder_assigner</span>
</span><span id="FitLadderModel.__init__-38"><a href="#FitLadderModel.__init__-38"><span class="linenos">38</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ladder_assigner</span><span class="o">.</span><span class="n">fsa_file</span>
</span><span id="FitLadderModel.__init__-39"><a href="#FitLadderModel.__init__-39"><span class="linenos">39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">best_combination</span> <span class="o">=</span> <span class="n">ladder_assigner</span><span class="o">.</span><span class="n">assign_ladder_peak_sizes</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="FitLadderModel.__init__-40"><a href="#FitLadderModel.__init__-40"><span class="linenos">40</span></a>            <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="FitLadderModel.__init__-41"><a href="#FitLadderModel.__init__-41"><span class="linenos">41</span></a>        <span class="p">)</span>
</span><span id="FitLadderModel.__init__-42"><a href="#FitLadderModel.__init__-42"><span class="linenos">42</span></a>
</span><span id="FitLadderModel.__init__-43"><a href="#FitLadderModel.__init__-43"><span class="linenos">43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_model</span><span class="p">()</span>
</span><span id="FitLadderModel.__init__-44"><a href="#FitLadderModel.__init__-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_score</span><span class="p">()</span>
</span><span id="FitLadderModel.__init__-45"><a href="#FitLadderModel.__init__-45"><span class="linenos">45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_baisepair_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_adjusted_trace_df</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Initialize FitLadderModel object with ladder_assigner object and its attributes.</p>

<p>Args:
    ladder_assigner (PeakLadderAssigner): Object of PeakLadderAssigner class.</p>

<p>Returns:
    None.</p>
</div>


                            </div>
                            <div id="FitLadderModel.n_knots" class="classattr">
                                <div class="attr variable">
            <span class="name">n_knots</span>

        
    </div>
    <a class="headerlink" href="#FitLadderModel.n_knots"></a>
    
    

                            </div>
                            <div id="FitLadderModel.ladder_assigner" class="classattr">
                                <div class="attr variable">
            <span class="name">ladder_assigner</span>

        
    </div>
    <a class="headerlink" href="#FitLadderModel.ladder_assigner"></a>
    
    

                            </div>
                            <div id="FitLadderModel.fsa_file" class="classattr">
                                <div class="attr variable">
            <span class="name">fsa_file</span>

        
    </div>
    <a class="headerlink" href="#FitLadderModel.fsa_file"></a>
    
    

                            </div>
                            <div id="FitLadderModel.best_combination" class="classattr">
                                <div class="attr variable">
            <span class="name">best_combination</span>

        
    </div>
    <a class="headerlink" href="#FitLadderModel.best_combination"></a>
    
    

                            </div>
                            <div id="FitLadderModel.adjusted_baisepair_df" class="classattr">
                                <div class="attr variable">
            <span class="name">adjusted_baisepair_df</span>

        
    </div>
    <a class="headerlink" href="#FitLadderModel.adjusted_baisepair_df"></a>
    
    

                            </div>
                            <div id="FitLadderModel.fit_model" class="classattr">
                                        <input id="FitLadderModel.fit_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FitLadderModel.fit_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FitLadderModel.fit_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FitLadderModel.fit_model-47"><a href="#FitLadderModel.fit_model-47"><span class="linenos">47</span></a>    <span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FitLadderModel.fit_model-48"><a href="#FitLadderModel.fit_model-48"><span class="linenos">48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FitLadderModel.fit_model-49"><a href="#FitLadderModel.fit_model-49"><span class="linenos">49</span></a><span class="sd">        Fit model based on ladder type.</span>
</span><span id="FitLadderModel.fit_model-50"><a href="#FitLadderModel.fit_model-50"><span class="linenos">50</span></a>
</span><span id="FitLadderModel.fit_model-51"><a href="#FitLadderModel.fit_model-51"><span class="linenos">51</span></a><span class="sd">        Returns:</span>
</span><span id="FitLadderModel.fit_model-52"><a href="#FitLadderModel.fit_model-52"><span class="linenos">52</span></a><span class="sd">            None.</span>
</span><span id="FitLadderModel.fit_model-53"><a href="#FitLadderModel.fit_model-53"><span class="linenos">53</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FitLadderModel.fit_model-54"><a href="#FitLadderModel.fit_model-54"><span class="linenos">54</span></a>        <span class="n">ladder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ladder</span>
</span><span id="FitLadderModel.fit_model-55"><a href="#FitLadderModel.fit_model-55"><span class="linenos">55</span></a>        <span class="k">if</span> <span class="n">ladder</span> <span class="o">==</span> <span class="s2">&quot;ROX&quot;</span><span class="p">:</span>
</span><span id="FitLadderModel.fit_model-56"><a href="#FitLadderModel.fit_model-56"><span class="linenos">56</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fit_ROX_ladder</span><span class="p">()</span>
</span><span id="FitLadderModel.fit_model-57"><a href="#FitLadderModel.fit_model-57"><span class="linenos">57</span></a>        <span class="k">elif</span> <span class="n">ladder</span> <span class="o">==</span> <span class="s2">&quot;LIZ&quot;</span> <span class="ow">or</span> <span class="n">ladder</span> <span class="o">==</span> <span class="s2">&quot;ORANGE&quot;</span><span class="p">:</span>
</span><span id="FitLadderModel.fit_model-58"><a href="#FitLadderModel.fit_model-58"><span class="linenos">58</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_fit_LIZ_ladder</span><span class="p">()</span>
</span><span id="FitLadderModel.fit_model-59"><a href="#FitLadderModel.fit_model-59"><span class="linenos">59</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FitLadderModel.fit_model-60"><a href="#FitLadderModel.fit_model-60"><span class="linenos">60</span></a>            <span class="k">raise</span> <span class="n">LadderNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">ladder</span><span class="si">}</span><span class="s2">&#39; is not a valid ladder&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fit model based on ladder type.</p>

<p>Returns:
    None.</p>
</div>


                            </div>
                            <div id="FitLadderModel.model_score" class="classattr">
                                        <input id="FitLadderModel.model_score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">model_score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FitLadderModel.model_score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FitLadderModel.model_score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FitLadderModel.model_score-62"><a href="#FitLadderModel.model_score-62"><span class="linenos">62</span></a>    <span class="k">def</span> <span class="nf">model_score</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="FitLadderModel.model_score-63"><a href="#FitLadderModel.model_score-63"><span class="linenos">63</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FitLadderModel.model_score-64"><a href="#FitLadderModel.model_score-64"><span class="linenos">64</span></a><span class="sd">        Calculate mean squared error and R-squared score of the fitted model.</span>
</span><span id="FitLadderModel.model_score-65"><a href="#FitLadderModel.model_score-65"><span class="linenos">65</span></a>
</span><span id="FitLadderModel.model_score-66"><a href="#FitLadderModel.model_score-66"><span class="linenos">66</span></a><span class="sd">        Returns:</span>
</span><span id="FitLadderModel.model_score-67"><a href="#FitLadderModel.model_score-67"><span class="linenos">67</span></a><span class="sd">            Tuple (mse, r2).</span>
</span><span id="FitLadderModel.model_score-68"><a href="#FitLadderModel.model_score-68"><span class="linenos">68</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FitLadderModel.model_score-69"><a href="#FitLadderModel.model_score-69"><span class="linenos">69</span></a>        <span class="n">true_Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span>
</span><span id="FitLadderModel.model_score-70"><a href="#FitLadderModel.model_score-70"><span class="linenos">70</span></a>        <span class="n">predicted_Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best_combination</span><span class="p">)</span>
</span><span id="FitLadderModel.model_score-71"><a href="#FitLadderModel.model_score-71"><span class="linenos">71</span></a>        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">true_Y</span><span class="p">,</span> <span class="n">predicted_Y</span><span class="p">)</span>
</span><span id="FitLadderModel.model_score-72"><a href="#FitLadderModel.model_score-72"><span class="linenos">72</span></a>        <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">true_Y</span><span class="p">,</span> <span class="n">predicted_Y</span><span class="p">)</span>
</span><span id="FitLadderModel.model_score-73"><a href="#FitLadderModel.model_score-73"><span class="linenos">73</span></a>
</span><span id="FitLadderModel.model_score-74"><a href="#FitLadderModel.model_score-74"><span class="linenos">74</span></a>        <span class="k">return</span> <span class="n">mse</span><span class="p">,</span> <span class="n">r2</span>
</span></pre></div>


            <div class="docstring"><p>Calculate mean squared error and R-squared score of the fitted model.</p>

<p>Returns:
    Tuple (mse, r2).</p>
</div>


                            </div>
                            <div id="FitLadderModel.generate_adjusted_trace_df" class="classattr">
                                        <input id="FitLadderModel.generate_adjusted_trace_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_adjusted_trace_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="FitLadderModel.generate_adjusted_trace_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FitLadderModel.generate_adjusted_trace_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FitLadderModel.generate_adjusted_trace_df-76"><a href="#FitLadderModel.generate_adjusted_trace_df-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="nf">generate_adjusted_trace_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-77"><a href="#FitLadderModel.generate_adjusted_trace_df-77"><span class="linenos"> 77</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-78"><a href="#FitLadderModel.generate_adjusted_trace_df-78"><span class="linenos"> 78</span></a><span class="sd">        Generate a dataframe with adjusted basepairs and peaks.</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-79"><a href="#FitLadderModel.generate_adjusted_trace_df-79"><span class="linenos"> 79</span></a>
</span><span id="FitLadderModel.generate_adjusted_trace_df-80"><a href="#FitLadderModel.generate_adjusted_trace_df-80"><span class="linenos"> 80</span></a><span class="sd">        Returns:</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-81"><a href="#FitLadderModel.generate_adjusted_trace_df-81"><span class="linenos"> 81</span></a><span class="sd">            Dataframe with columns time, peaks and basepairs.</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-82"><a href="#FitLadderModel.generate_adjusted_trace_df-82"><span class="linenos"> 82</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-83"><a href="#FitLadderModel.generate_adjusted_trace_df-83"><span class="linenos"> 83</span></a>        <span class="c1"># Continue loop until all basepairs are unique by changing n_knots in SplineTransformer</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-84"><a href="#FitLadderModel.generate_adjusted_trace_df-84"><span class="linenos"> 84</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-85"><a href="#FitLadderModel.generate_adjusted_trace_df-85"><span class="linenos"> 85</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-86"><a href="#FitLadderModel.generate_adjusted_trace_df-86"><span class="linenos"> 86</span></a>                <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;peaks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">trace</span><span class="p">})</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-87"><a href="#FitLadderModel.generate_adjusted_trace_df-87"><span class="linenos"> 87</span></a>                <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-88"><a href="#FitLadderModel.generate_adjusted_trace_df-88"><span class="linenos"> 88</span></a>                <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">})</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-89"><a href="#FitLadderModel.generate_adjusted_trace_df-89"><span class="linenos"> 89</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-90"><a href="#FitLadderModel.generate_adjusted_trace_df-90"><span class="linenos"> 90</span></a>                    <span class="n">basepairs</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-91"><a href="#FitLadderModel.generate_adjusted_trace_df-91"><span class="linenos"> 91</span></a>                        <span class="n">x</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-92"><a href="#FitLadderModel.generate_adjusted_trace_df-92"><span class="linenos"> 92</span></a>                    <span class="p">)</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-93"><a href="#FitLadderModel.generate_adjusted_trace_df-93"><span class="linenos"> 93</span></a>                <span class="p">)</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-94"><a href="#FitLadderModel.generate_adjusted_trace_df-94"><span class="linenos"> 94</span></a>                <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-95"><a href="#FitLadderModel.generate_adjusted_trace_df-95"><span class="linenos"> 95</span></a>            <span class="p">)</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-96"><a href="#FitLadderModel.generate_adjusted_trace_df-96"><span class="linenos"> 96</span></a>
</span><span id="FitLadderModel.generate_adjusted_trace_df-97"><a href="#FitLadderModel.generate_adjusted_trace_df-97"><span class="linenos"> 97</span></a>            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">nunique</span><span class="p">():</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-98"><a href="#FitLadderModel.generate_adjusted_trace_df-98"><span class="linenos"> 98</span></a>                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ladder fitting model: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-99"><a href="#FitLadderModel.generate_adjusted_trace_df-99"><span class="linenos"> 99</span></a>                <span class="k">return</span> <span class="n">df</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-100"><a href="#FitLadderModel.generate_adjusted_trace_df-100"><span class="linenos">100</span></a>            <span class="c1"># If not all bp are unique</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-101"><a href="#FitLadderModel.generate_adjusted_trace_df-101"><span class="linenos">101</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_knots</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-102"><a href="#FitLadderModel.generate_adjusted_trace_df-102"><span class="linenos">102</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit_model</span><span class="p">()</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-103"><a href="#FitLadderModel.generate_adjusted_trace_df-103"><span class="linenos">103</span></a>
</span><span id="FitLadderModel.generate_adjusted_trace_df-104"><a href="#FitLadderModel.generate_adjusted_trace_df-104"><span class="linenos">104</span></a>        <span class="k">raise</span> <span class="n">ModelFittingError</span><span class="p">(</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-105"><a href="#FitLadderModel.generate_adjusted_trace_df-105"><span class="linenos">105</span></a>            <span class="s2">&quot;There is a problem with the fitting of the model to the ladder&quot;</span>
</span><span id="FitLadderModel.generate_adjusted_trace_df-106"><a href="#FitLadderModel.generate_adjusted_trace_df-106"><span class="linenos">106</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate a dataframe with adjusted basepairs and peaks.</p>

<p>Returns:
    Dataframe with columns time, peaks and basepairs.</p>
</div>


                            </div>
                </section>
                <section id="PeakLadderAssigner">
                            <input id="PeakLadderAssigner-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PeakLadderAssigner</span>:

                <label class="view-source-button" for="PeakLadderAssigner-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakLadderAssigner"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakLadderAssigner-13"><a href="#PeakLadderAssigner-13"><span class="linenos"> 13</span></a><span class="k">class</span> <span class="nc">PeakLadderAssigner</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-14"><a href="#PeakLadderAssigner-14"><span class="linenos"> 14</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-15"><a href="#PeakLadderAssigner-15"><span class="linenos"> 15</span></a><span class="sd">    A class that assigns peak sizes to a ladder for use in DNA fragment size analysis.</span>
</span><span id="PeakLadderAssigner-16"><a href="#PeakLadderAssigner-16"><span class="linenos"> 16</span></a><span class="sd">    The peak sizes are generated based on a given size standard and the input parameters.</span>
</span><span id="PeakLadderAssigner-17"><a href="#PeakLadderAssigner-17"><span class="linenos"> 17</span></a>
</span><span id="PeakLadderAssigner-18"><a href="#PeakLadderAssigner-18"><span class="linenos"> 18</span></a><span class="sd">    Attributes:</span>
</span><span id="PeakLadderAssigner-19"><a href="#PeakLadderAssigner-19"><span class="linenos"> 19</span></a><span class="sd">    fsa_file (FsaFile): an object of the FsaFile class that contains parameters for analysis</span>
</span><span id="PeakLadderAssigner-20"><a href="#PeakLadderAssigner-20"><span class="linenos"> 20</span></a>
</span><span id="PeakLadderAssigner-21"><a href="#PeakLadderAssigner-21"><span class="linenos"> 21</span></a><span class="sd">    Methods:</span>
</span><span id="PeakLadderAssigner-22"><a href="#PeakLadderAssigner-22"><span class="linenos"> 22</span></a><span class="sd">    assign_ladder_peak_sizes(): Assigns peak sizes to a ladder based on the given parameters and returns the best combination.</span>
</span><span id="PeakLadderAssigner-23"><a href="#PeakLadderAssigner-23"><span class="linenos"> 23</span></a><span class="sd">    get_peaks(size_standard): Finds peaks in the size standard based on given parameters and returns the peaks.</span>
</span><span id="PeakLadderAssigner-24"><a href="#PeakLadderAssigner-24"><span class="linenos"> 24</span></a><span class="sd">    generate_graph(peaks): Generates a graph based on the peaks and returns the graph.</span>
</span><span id="PeakLadderAssigner-25"><a href="#PeakLadderAssigner-25"><span class="linenos"> 25</span></a><span class="sd">    generate_combinations(graph): Generates combinations of peaks based on the graph and returns the combinations.</span>
</span><span id="PeakLadderAssigner-26"><a href="#PeakLadderAssigner-26"><span class="linenos"> 26</span></a><span class="sd">    get_best_fit(combinations, method): Finds the best fit for the given combinations and returns the best combination.</span>
</span><span id="PeakLadderAssigner-27"><a href="#PeakLadderAssigner-27"><span class="linenos"> 27</span></a><span class="sd">    _polynomial_model_inv_r2_score(ladder, comb): Returns a score based on the polynomial model inverse r2 score.</span>
</span><span id="PeakLadderAssigner-28"><a href="#PeakLadderAssigner-28"><span class="linenos"> 28</span></a><span class="sd">    _max_fractional_deviation_score(ladder, comb): Returns a score based on the maximum fractional deviation.</span>
</span><span id="PeakLadderAssigner-29"><a href="#PeakLadderAssigner-29"><span class="linenos"> 29</span></a><span class="sd">    _max_first_derivative_score(combination): Returns a score based on the maximum first derivative.</span>
</span><span id="PeakLadderAssigner-30"><a href="#PeakLadderAssigner-30"><span class="linenos"> 30</span></a><span class="sd">    _max_second_derivative_score(combination): Returns a score based on the maximum second derivative.</span>
</span><span id="PeakLadderAssigner-31"><a href="#PeakLadderAssigner-31"><span class="linenos"> 31</span></a><span class="sd">    _max_spline_second_derivative_score(combination): Returns a score based on the maximum spline second derivative.</span>
</span><span id="PeakLadderAssigner-32"><a href="#PeakLadderAssigner-32"><span class="linenos"> 32</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-33"><a href="#PeakLadderAssigner-33"><span class="linenos"> 33</span></a>
</span><span id="PeakLadderAssigner-34"><a href="#PeakLadderAssigner-34"><span class="linenos"> 34</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fsa_file</span><span class="p">:</span> <span class="n">FsaFile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-35"><a href="#PeakLadderAssigner-35"><span class="linenos"> 35</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-36"><a href="#PeakLadderAssigner-36"><span class="linenos"> 36</span></a><span class="sd">        Initializes the class with an object of the FsaFile class.</span>
</span><span id="PeakLadderAssigner-37"><a href="#PeakLadderAssigner-37"><span class="linenos"> 37</span></a>
</span><span id="PeakLadderAssigner-38"><a href="#PeakLadderAssigner-38"><span class="linenos"> 38</span></a><span class="sd">        Args:</span>
</span><span id="PeakLadderAssigner-39"><a href="#PeakLadderAssigner-39"><span class="linenos"> 39</span></a><span class="sd">        fsa_file (FsaFile): an object of the FsaFile class that contains parameters for analysis</span>
</span><span id="PeakLadderAssigner-40"><a href="#PeakLadderAssigner-40"><span class="linenos"> 40</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-41"><a href="#PeakLadderAssigner-41"><span class="linenos"> 41</span></a>
</span><span id="PeakLadderAssigner-42"><a href="#PeakLadderAssigner-42"><span class="linenos"> 42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span> <span class="o">=</span> <span class="n">fsa_file</span>
</span><span id="PeakLadderAssigner-43"><a href="#PeakLadderAssigner-43"><span class="linenos"> 43</span></a>
</span><span id="PeakLadderAssigner-44"><a href="#PeakLadderAssigner-44"><span class="linenos"> 44</span></a>    <span class="k">def</span> <span class="nf">assign_ladder_peak_sizes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PeakLadderAssigner-45"><a href="#PeakLadderAssigner-45"><span class="linenos"> 45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-46"><a href="#PeakLadderAssigner-46"><span class="linenos"> 46</span></a><span class="sd">        Assigns peak sizes to a ladder based on the given parameters and returns the best combination.</span>
</span><span id="PeakLadderAssigner-47"><a href="#PeakLadderAssigner-47"><span class="linenos"> 47</span></a>
</span><span id="PeakLadderAssigner-48"><a href="#PeakLadderAssigner-48"><span class="linenos"> 48</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner-49"><a href="#PeakLadderAssigner-49"><span class="linenos"> 49</span></a><span class="sd">        np.array: the best combination of peak sizes</span>
</span><span id="PeakLadderAssigner-50"><a href="#PeakLadderAssigner-50"><span class="linenos"> 50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-51"><a href="#PeakLadderAssigner-51"><span class="linenos"> 51</span></a>        <span class="n">peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">size_standard</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-52"><a href="#PeakLadderAssigner-52"><span class="linenos"> 52</span></a>        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_graph</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-53"><a href="#PeakLadderAssigner-53"><span class="linenos"> 53</span></a>        <span class="n">combinations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_combinations</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-54"><a href="#PeakLadderAssigner-54"><span class="linenos"> 54</span></a>        <span class="n">best_combination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best_fit</span><span class="p">(</span><span class="n">combinations</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-55"><a href="#PeakLadderAssigner-55"><span class="linenos"> 55</span></a>
</span><span id="PeakLadderAssigner-56"><a href="#PeakLadderAssigner-56"><span class="linenos"> 56</span></a>        <span class="k">return</span> <span class="n">best_combination</span>
</span><span id="PeakLadderAssigner-57"><a href="#PeakLadderAssigner-57"><span class="linenos"> 57</span></a>
</span><span id="PeakLadderAssigner-58"><a href="#PeakLadderAssigner-58"><span class="linenos"> 58</span></a>    <span class="k">def</span> <span class="nf">get_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size_standard</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-59"><a href="#PeakLadderAssigner-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-60"><a href="#PeakLadderAssigner-60"><span class="linenos"> 60</span></a><span class="sd">        Finds peaks in the size standard based on given parameters and returns the peaks.</span>
</span><span id="PeakLadderAssigner-61"><a href="#PeakLadderAssigner-61"><span class="linenos"> 61</span></a>
</span><span id="PeakLadderAssigner-62"><a href="#PeakLadderAssigner-62"><span class="linenos"> 62</span></a><span class="sd">        Args:</span>
</span><span id="PeakLadderAssigner-63"><a href="#PeakLadderAssigner-63"><span class="linenos"> 63</span></a><span class="sd">        size_standard (np.array): the size standard array</span>
</span><span id="PeakLadderAssigner-64"><a href="#PeakLadderAssigner-64"><span class="linenos"> 64</span></a>
</span><span id="PeakLadderAssigner-65"><a href="#PeakLadderAssigner-65"><span class="linenos"> 65</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner-66"><a href="#PeakLadderAssigner-66"><span class="linenos"> 66</span></a><span class="sd">        np.array: the peaks array</span>
</span><span id="PeakLadderAssigner-67"><a href="#PeakLadderAssigner-67"><span class="linenos"> 67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-68"><a href="#PeakLadderAssigner-68"><span class="linenos"> 68</span></a>
</span><span id="PeakLadderAssigner-69"><a href="#PeakLadderAssigner-69"><span class="linenos"> 69</span></a>        <span class="n">peaks_obj</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span>
</span><span id="PeakLadderAssigner-70"><a href="#PeakLadderAssigner-70"><span class="linenos"> 70</span></a>            <span class="n">size_standard</span><span class="p">,</span>
</span><span id="PeakLadderAssigner-71"><a href="#PeakLadderAssigner-71"><span class="linenos"> 71</span></a>            <span class="n">distance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">min_interpeak_distance</span><span class="p">,</span>
</span><span id="PeakLadderAssigner-72"><a href="#PeakLadderAssigner-72"><span class="linenos"> 72</span></a>            <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">min_height</span><span class="p">,</span>
</span><span id="PeakLadderAssigner-73"><a href="#PeakLadderAssigner-73"><span class="linenos"> 73</span></a>        <span class="p">)</span>
</span><span id="PeakLadderAssigner-74"><a href="#PeakLadderAssigner-74"><span class="linenos"> 74</span></a>
</span><span id="PeakLadderAssigner-75"><a href="#PeakLadderAssigner-75"><span class="linenos"> 75</span></a>        <span class="n">peaks</span> <span class="o">=</span> <span class="n">peaks_obj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PeakLadderAssigner-76"><a href="#PeakLadderAssigner-76"><span class="linenos"> 76</span></a>        <span class="n">heights</span> <span class="o">=</span> <span class="n">peaks_obj</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;peak_heights&quot;</span><span class="p">]</span>
</span><span id="PeakLadderAssigner-77"><a href="#PeakLadderAssigner-77"><span class="linenos"> 77</span></a>
</span><span id="PeakLadderAssigner-78"><a href="#PeakLadderAssigner-78"><span class="linenos"> 78</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;peaks&quot;</span><span class="p">:</span> <span class="n">peaks</span><span class="p">,</span> <span class="s2">&quot;heights&quot;</span><span class="p">:</span> <span class="n">heights</span><span class="p">})</span>
</span><span id="PeakLadderAssigner-79"><a href="#PeakLadderAssigner-79"><span class="linenos"> 79</span></a>
</span><span id="PeakLadderAssigner-80"><a href="#PeakLadderAssigner-80"><span class="linenos"> 80</span></a>        <span class="c1"># TODO</span>
</span><span id="PeakLadderAssigner-81"><a href="#PeakLadderAssigner-81"><span class="linenos"> 81</span></a>        <span class="c1"># Dropped the below, then it worked with the new test files</span>
</span><span id="PeakLadderAssigner-82"><a href="#PeakLadderAssigner-82"><span class="linenos"> 82</span></a>        <span class="c1"># idxmax = df[&quot;heights&quot;].idxmax()</span>
</span><span id="PeakLadderAssigner-83"><a href="#PeakLadderAssigner-83"><span class="linenos"> 83</span></a>        <span class="c1"># df = df.drop(idxmax)</span>
</span><span id="PeakLadderAssigner-84"><a href="#PeakLadderAssigner-84"><span class="linenos"> 84</span></a>
</span><span id="PeakLadderAssigner-85"><a href="#PeakLadderAssigner-85"><span class="linenos"> 85</span></a>        <span class="n">peaks_adj</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">max_peak_count</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;heights&quot;</span><span class="p">])</span>
</span><span id="PeakLadderAssigner-86"><a href="#PeakLadderAssigner-86"><span class="linenos"> 86</span></a>
</span><span id="PeakLadderAssigner-87"><a href="#PeakLadderAssigner-87"><span class="linenos"> 87</span></a>        <span class="k">return</span> <span class="n">peaks_adj</span><span class="p">[</span><span class="s2">&quot;peaks&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="PeakLadderAssigner-88"><a href="#PeakLadderAssigner-88"><span class="linenos"> 88</span></a>
</span><span id="PeakLadderAssigner-89"><a href="#PeakLadderAssigner-89"><span class="linenos"> 89</span></a>    <span class="k">def</span> <span class="nf">generate_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peaks</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-90"><a href="#PeakLadderAssigner-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-91"><a href="#PeakLadderAssigner-91"><span class="linenos"> 91</span></a><span class="sd">        Generates a graph based on the peaks and returns the graph.</span>
</span><span id="PeakLadderAssigner-92"><a href="#PeakLadderAssigner-92"><span class="linenos"> 92</span></a>
</span><span id="PeakLadderAssigner-93"><a href="#PeakLadderAssigner-93"><span class="linenos"> 93</span></a><span class="sd">        Args:</span>
</span><span id="PeakLadderAssigner-94"><a href="#PeakLadderAssigner-94"><span class="linenos"> 94</span></a><span class="sd">        peaks (np.array): the peaks array</span>
</span><span id="PeakLadderAssigner-95"><a href="#PeakLadderAssigner-95"><span class="linenos"> 95</span></a>
</span><span id="PeakLadderAssigner-96"><a href="#PeakLadderAssigner-96"><span class="linenos"> 96</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner-97"><a href="#PeakLadderAssigner-97"><span class="linenos"> 97</span></a><span class="sd">        nx.DiGraph: the graph object</span>
</span><span id="PeakLadderAssigner-98"><a href="#PeakLadderAssigner-98"><span class="linenos"> 98</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-99"><a href="#PeakLadderAssigner-99"><span class="linenos"> 99</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
</span><span id="PeakLadderAssigner-100"><a href="#PeakLadderAssigner-100"><span class="linenos">100</span></a>
</span><span id="PeakLadderAssigner-101"><a href="#PeakLadderAssigner-101"><span class="linenos">101</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">peaks</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-102"><a href="#PeakLadderAssigner-102"><span class="linenos">102</span></a>            <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-103"><a href="#PeakLadderAssigner-103"><span class="linenos">103</span></a>
</span><span id="PeakLadderAssigner-104"><a href="#PeakLadderAssigner-104"><span class="linenos">104</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PeakLadderAssigner-105"><a href="#PeakLadderAssigner-105"><span class="linenos">105</span></a>        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">peaks</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-106"><a href="#PeakLadderAssigner-106"><span class="linenos">106</span></a>            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="PeakLadderAssigner-107"><a href="#PeakLadderAssigner-107"><span class="linenos">107</span></a>            <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">peaks</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-108"><a href="#PeakLadderAssigner-108"><span class="linenos">108</span></a>                <span class="n">diff</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">peaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PeakLadderAssigner-109"><a href="#PeakLadderAssigner-109"><span class="linenos">109</span></a>                <span class="k">if</span> <span class="n">diff</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">max_ladder_trace_distance</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-110"><a href="#PeakLadderAssigner-110"><span class="linenos">110</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">peaks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">peaks</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">length</span><span class="o">=</span><span class="n">diff</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-111"><a href="#PeakLadderAssigner-111"><span class="linenos">111</span></a>                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PeakLadderAssigner-112"><a href="#PeakLadderAssigner-112"><span class="linenos">112</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PeakLadderAssigner-113"><a href="#PeakLadderAssigner-113"><span class="linenos">113</span></a>
</span><span id="PeakLadderAssigner-114"><a href="#PeakLadderAssigner-114"><span class="linenos">114</span></a>        <span class="k">return</span> <span class="n">G</span>
</span><span id="PeakLadderAssigner-115"><a href="#PeakLadderAssigner-115"><span class="linenos">115</span></a>
</span><span id="PeakLadderAssigner-116"><a href="#PeakLadderAssigner-116"><span class="linenos">116</span></a>    <span class="k">def</span> <span class="nf">generate_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">):</span>
</span><span id="PeakLadderAssigner-117"><a href="#PeakLadderAssigner-117"><span class="linenos">117</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-118"><a href="#PeakLadderAssigner-118"><span class="linenos">118</span></a><span class="sd">        Generates combinations of nodes from a given directed acyclic graph (DAG)</span>
</span><span id="PeakLadderAssigner-119"><a href="#PeakLadderAssigner-119"><span class="linenos">119</span></a><span class="sd">        that satisfy certain conditions.</span>
</span><span id="PeakLadderAssigner-120"><a href="#PeakLadderAssigner-120"><span class="linenos">120</span></a>
</span><span id="PeakLadderAssigner-121"><a href="#PeakLadderAssigner-121"><span class="linenos">121</span></a><span class="sd">        Parameters:</span>
</span><span id="PeakLadderAssigner-122"><a href="#PeakLadderAssigner-122"><span class="linenos">122</span></a><span class="sd">        graph (networkx.DiGraph): a DAG representing a state machine</span>
</span><span id="PeakLadderAssigner-123"><a href="#PeakLadderAssigner-123"><span class="linenos">123</span></a>
</span><span id="PeakLadderAssigner-124"><a href="#PeakLadderAssigner-124"><span class="linenos">124</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner-125"><a href="#PeakLadderAssigner-125"><span class="linenos">125</span></a><span class="sd">        A numpy array representing a sequence of nodes that satisfies the</span>
</span><span id="PeakLadderAssigner-126"><a href="#PeakLadderAssigner-126"><span class="linenos">126</span></a><span class="sd">        conditions of the DAG.</span>
</span><span id="PeakLadderAssigner-127"><a href="#PeakLadderAssigner-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-128"><a href="#PeakLadderAssigner-128"><span class="linenos">128</span></a>
</span><span id="PeakLadderAssigner-129"><a href="#PeakLadderAssigner-129"><span class="linenos">129</span></a>        <span class="c1"># Get start nodes that have zero in-degree</span>
</span><span id="PeakLadderAssigner-130"><a href="#PeakLadderAssigner-130"><span class="linenos">130</span></a>        <span class="n">start_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="PeakLadderAssigner-131"><a href="#PeakLadderAssigner-131"><span class="linenos">131</span></a>
</span><span id="PeakLadderAssigner-132"><a href="#PeakLadderAssigner-132"><span class="linenos">132</span></a>        <span class="c1"># Get end nodes that have zero out-degree</span>
</span><span id="PeakLadderAssigner-133"><a href="#PeakLadderAssigner-133"><span class="linenos">133</span></a>        <span class="n">end_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="PeakLadderAssigner-134"><a href="#PeakLadderAssigner-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">start_nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">end_nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-135"><a href="#PeakLadderAssigner-135"><span class="linenos">135</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Graph does not have start or end nodes&quot;</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-136"><a href="#PeakLadderAssigner-136"><span class="linenos">136</span></a>
</span><span id="PeakLadderAssigner-137"><a href="#PeakLadderAssigner-137"><span class="linenos">137</span></a>        <span class="c1"># Get all simple paths from start node to end node</span>
</span><span id="PeakLadderAssigner-138"><a href="#PeakLadderAssigner-138"><span class="linenos">138</span></a>        <span class="n">all_paths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakLadderAssigner-139"><a href="#PeakLadderAssigner-139"><span class="linenos">139</span></a>        <span class="k">for</span> <span class="n">start_node</span> <span class="ow">in</span> <span class="n">start_nodes</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-140"><a href="#PeakLadderAssigner-140"><span class="linenos">140</span></a>            <span class="k">for</span> <span class="n">end_node</span> <span class="ow">in</span> <span class="n">end_nodes</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-141"><a href="#PeakLadderAssigner-141"><span class="linenos">141</span></a>                <span class="n">paths</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start_node</span><span class="p">,</span> <span class="n">end_node</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-142"><a href="#PeakLadderAssigner-142"><span class="linenos">142</span></a>                <span class="n">all_paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-143"><a href="#PeakLadderAssigner-143"><span class="linenos">143</span></a>
</span><span id="PeakLadderAssigner-144"><a href="#PeakLadderAssigner-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-145"><a href="#PeakLadderAssigner-145"><span class="linenos">145</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No paths found from start to end nodes&quot;</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-146"><a href="#PeakLadderAssigner-146"><span class="linenos">146</span></a>
</span><span id="PeakLadderAssigner-147"><a href="#PeakLadderAssigner-147"><span class="linenos">147</span></a>        <span class="c1"># Generate combinations of nodes that satisfy certain conditions</span>
</span><span id="PeakLadderAssigner-148"><a href="#PeakLadderAssigner-148"><span class="linenos">148</span></a>        <span class="k">for</span> <span class="n">p_arr</span> <span class="ow">in</span> <span class="n">all_paths</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-149"><a href="#PeakLadderAssigner-149"><span class="linenos">149</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_arr</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="PeakLadderAssigner-150"><a href="#PeakLadderAssigner-150"><span class="linenos">150</span></a>                <span class="k">yield</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p_arr</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_count</span><span class="p">])</span>
</span><span id="PeakLadderAssigner-151"><a href="#PeakLadderAssigner-151"><span class="linenos">151</span></a>
</span><span id="PeakLadderAssigner-152"><a href="#PeakLadderAssigner-152"><span class="linenos">152</span></a>    <span class="k">def</span> <span class="nf">get_best_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combinations</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;2nd_derivative&quot;</span><span class="p">):</span>
</span><span id="PeakLadderAssigner-153"><a href="#PeakLadderAssigner-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-154"><a href="#PeakLadderAssigner-154"><span class="linenos">154</span></a><span class="sd">        Calculates the best fit for a given set of combinations using a specified method.</span>
</span><span id="PeakLadderAssigner-155"><a href="#PeakLadderAssigner-155"><span class="linenos">155</span></a>
</span><span id="PeakLadderAssigner-156"><a href="#PeakLadderAssigner-156"><span class="linenos">156</span></a><span class="sd">        Parameters:</span>
</span><span id="PeakLadderAssigner-157"><a href="#PeakLadderAssigner-157"><span class="linenos">157</span></a><span class="sd">        combinations (iterable): an iterable containing combinations of nodes</span>
</span><span id="PeakLadderAssigner-158"><a href="#PeakLadderAssigner-158"><span class="linenos">158</span></a><span class="sd">        method (str): a string indicating the method to use. The default method is</span>
</span><span id="PeakLadderAssigner-159"><a href="#PeakLadderAssigner-159"><span class="linenos">159</span></a><span class="sd">            &quot;2nd_derivative&quot;.</span>
</span><span id="PeakLadderAssigner-160"><a href="#PeakLadderAssigner-160"><span class="linenos">160</span></a>
</span><span id="PeakLadderAssigner-161"><a href="#PeakLadderAssigner-161"><span class="linenos">161</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner-162"><a href="#PeakLadderAssigner-162"><span class="linenos">162</span></a><span class="sd">        A numpy array representing the combination of nodes with the best fit.</span>
</span><span id="PeakLadderAssigner-163"><a href="#PeakLadderAssigner-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-164"><a href="#PeakLadderAssigner-164"><span class="linenos">164</span></a>
</span><span id="PeakLadderAssigner-165"><a href="#PeakLadderAssigner-165"><span class="linenos">165</span></a>        <span class="c1"># Create an empty dataframe to store combinations and scores</span>
</span><span id="PeakLadderAssigner-166"><a href="#PeakLadderAssigner-166"><span class="linenos">166</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="PeakLadderAssigner-167"><a href="#PeakLadderAssigner-167"><span class="linenos">167</span></a>
</span><span id="PeakLadderAssigner-168"><a href="#PeakLadderAssigner-168"><span class="linenos">168</span></a>        <span class="c1"># Store the combinations in the dataframe</span>
</span><span id="PeakLadderAssigner-169"><a href="#PeakLadderAssigner-169"><span class="linenos">169</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;combination&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-170"><a href="#PeakLadderAssigner-170"><span class="linenos">170</span></a>
</span><span id="PeakLadderAssigner-171"><a href="#PeakLadderAssigner-171"><span class="linenos">171</span></a>        <span class="c1"># Calculate the score for each combination using the specified method</span>
</span><span id="PeakLadderAssigner-172"><a href="#PeakLadderAssigner-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;2nd_derivative&quot;</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-173"><a href="#PeakLadderAssigner-173"><span class="linenos">173</span></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_max_spline_second_derivative_score</span><span class="p">)(</span>
</span><span id="PeakLadderAssigner-174"><a href="#PeakLadderAssigner-174"><span class="linenos">174</span></a>                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;combination&quot;</span><span class="p">]</span>
</span><span id="PeakLadderAssigner-175"><a href="#PeakLadderAssigner-175"><span class="linenos">175</span></a>            <span class="p">)</span>
</span><span id="PeakLadderAssigner-176"><a href="#PeakLadderAssigner-176"><span class="linenos">176</span></a>
</span><span id="PeakLadderAssigner-177"><a href="#PeakLadderAssigner-177"><span class="linenos">177</span></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;first_derivative&quot;</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-178"><a href="#PeakLadderAssigner-178"><span class="linenos">178</span></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_max_first_derivative_score</span><span class="p">)(</span>
</span><span id="PeakLadderAssigner-179"><a href="#PeakLadderAssigner-179"><span class="linenos">179</span></a>                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;combination&quot;</span><span class="p">]</span>
</span><span id="PeakLadderAssigner-180"><a href="#PeakLadderAssigner-180"><span class="linenos">180</span></a>            <span class="p">)</span>
</span><span id="PeakLadderAssigner-181"><a href="#PeakLadderAssigner-181"><span class="linenos">181</span></a>
</span><span id="PeakLadderAssigner-182"><a href="#PeakLadderAssigner-182"><span class="linenos">182</span></a>        <span class="c1"># Sort the dataframe by score in ascending order</span>
</span><span id="PeakLadderAssigner-183"><a href="#PeakLadderAssigner-183"><span class="linenos">183</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-184"><a href="#PeakLadderAssigner-184"><span class="linenos">184</span></a>
</span><span id="PeakLadderAssigner-185"><a href="#PeakLadderAssigner-185"><span class="linenos">185</span></a>        <span class="c1"># Get the best combination (i.e., the one with the lowest score)</span>
</span><span id="PeakLadderAssigner-186"><a href="#PeakLadderAssigner-186"><span class="linenos">186</span></a>        <span class="n">best</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-187"><a href="#PeakLadderAssigner-187"><span class="linenos">187</span></a>
</span><span id="PeakLadderAssigner-188"><a href="#PeakLadderAssigner-188"><span class="linenos">188</span></a>        <span class="c1"># Return the best combination as a numpy array</span>
</span><span id="PeakLadderAssigner-189"><a href="#PeakLadderAssigner-189"><span class="linenos">189</span></a>        <span class="k">return</span> <span class="n">best</span><span class="o">.</span><span class="n">combination</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</span><span id="PeakLadderAssigner-190"><a href="#PeakLadderAssigner-190"><span class="linenos">190</span></a>
</span><span id="PeakLadderAssigner-191"><a href="#PeakLadderAssigner-191"><span class="linenos">191</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PeakLadderAssigner-192"><a href="#PeakLadderAssigner-192"><span class="linenos">192</span></a>    <span class="k">def</span> <span class="nf">_polynomial_model_inv_r2_score</span><span class="p">(</span><span class="n">ladder</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">comb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-193"><a href="#PeakLadderAssigner-193"><span class="linenos">193</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-194"><a href="#PeakLadderAssigner-194"><span class="linenos">194</span></a><span class="sd">        Calculates the inverse of the R^2 (coefficient of determination) score for a polynomial regression model.</span>
</span><span id="PeakLadderAssigner-195"><a href="#PeakLadderAssigner-195"><span class="linenos">195</span></a>
</span><span id="PeakLadderAssigner-196"><a href="#PeakLadderAssigner-196"><span class="linenos">196</span></a><span class="sd">        Parameters:</span>
</span><span id="PeakLadderAssigner-197"><a href="#PeakLadderAssigner-197"><span class="linenos">197</span></a><span class="sd">        - ladder (np.array): array containing the ladder positions of a dataset</span>
</span><span id="PeakLadderAssigner-198"><a href="#PeakLadderAssigner-198"><span class="linenos">198</span></a><span class="sd">        - comb (np.array): array containing the corresponding comb heights of a dataset</span>
</span><span id="PeakLadderAssigner-199"><a href="#PeakLadderAssigner-199"><span class="linenos">199</span></a>
</span><span id="PeakLadderAssigner-200"><a href="#PeakLadderAssigner-200"><span class="linenos">200</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner-201"><a href="#PeakLadderAssigner-201"><span class="linenos">201</span></a><span class="sd">        - float: the inverse of the R^2 score for the polynomial model</span>
</span><span id="PeakLadderAssigner-202"><a href="#PeakLadderAssigner-202"><span class="linenos">202</span></a>
</span><span id="PeakLadderAssigner-203"><a href="#PeakLadderAssigner-203"><span class="linenos">203</span></a><span class="sd">        Notes:</span>
</span><span id="PeakLadderAssigner-204"><a href="#PeakLadderAssigner-204"><span class="linenos">204</span></a><span class="sd">        - This method fits a polynomial regression model of degree 3 to the dataset using NumPy&#39;s polyfit function.</span>
</span><span id="PeakLadderAssigner-205"><a href="#PeakLadderAssigner-205"><span class="linenos">205</span></a><span class="sd">        - It then calculates the predicted values of the comb heights using NumPy&#39;s poly1d function.</span>
</span><span id="PeakLadderAssigner-206"><a href="#PeakLadderAssigner-206"><span class="linenos">206</span></a><span class="sd">        - Finally, it calculates the R^2 score between the predicted comb heights and the actual comb heights using the r2_score function</span>
</span><span id="PeakLadderAssigner-207"><a href="#PeakLadderAssigner-207"><span class="linenos">207</span></a><span class="sd">          from the scikit-learn library, and returns the inverse of that score.</span>
</span><span id="PeakLadderAssigner-208"><a href="#PeakLadderAssigner-208"><span class="linenos">208</span></a>
</span><span id="PeakLadderAssigner-209"><a href="#PeakLadderAssigner-209"><span class="linenos">209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-210"><a href="#PeakLadderAssigner-210"><span class="linenos">210</span></a>        <span class="c1"># fit polynomial regression model</span>
</span><span id="PeakLadderAssigner-211"><a href="#PeakLadderAssigner-211"><span class="linenos">211</span></a>        <span class="n">fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">ladder</span><span class="p">,</span> <span class="n">comb</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-212"><a href="#PeakLadderAssigner-212"><span class="linenos">212</span></a>
</span><span id="PeakLadderAssigner-213"><a href="#PeakLadderAssigner-213"><span class="linenos">213</span></a>        <span class="c1"># create predicted values using fitted model</span>
</span><span id="PeakLadderAssigner-214"><a href="#PeakLadderAssigner-214"><span class="linenos">214</span></a>        <span class="n">predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-215"><a href="#PeakLadderAssigner-215"><span class="linenos">215</span></a>
</span><span id="PeakLadderAssigner-216"><a href="#PeakLadderAssigner-216"><span class="linenos">216</span></a>        <span class="c1"># calculate R^2 score between predicted and actual values, and return its inverse</span>
</span><span id="PeakLadderAssigner-217"><a href="#PeakLadderAssigner-217"><span class="linenos">217</span></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">comb</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="n">ladder</span><span class="p">))</span>
</span><span id="PeakLadderAssigner-218"><a href="#PeakLadderAssigner-218"><span class="linenos">218</span></a>
</span><span id="PeakLadderAssigner-219"><a href="#PeakLadderAssigner-219"><span class="linenos">219</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PeakLadderAssigner-220"><a href="#PeakLadderAssigner-220"><span class="linenos">220</span></a>    <span class="k">def</span> <span class="nf">_max_fractional_deviation_score</span><span class="p">(</span><span class="n">ladder</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">comb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="PeakLadderAssigner-221"><a href="#PeakLadderAssigner-221"><span class="linenos">221</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-222"><a href="#PeakLadderAssigner-222"><span class="linenos">222</span></a><span class="sd">        Calculates the maximum fractional deviation score for a dataset.</span>
</span><span id="PeakLadderAssigner-223"><a href="#PeakLadderAssigner-223"><span class="linenos">223</span></a>
</span><span id="PeakLadderAssigner-224"><a href="#PeakLadderAssigner-224"><span class="linenos">224</span></a><span class="sd">        Parameters:</span>
</span><span id="PeakLadderAssigner-225"><a href="#PeakLadderAssigner-225"><span class="linenos">225</span></a><span class="sd">        - ladder (np.ndarray): array containing the ladder positions of a dataset</span>
</span><span id="PeakLadderAssigner-226"><a href="#PeakLadderAssigner-226"><span class="linenos">226</span></a><span class="sd">        - comb (np.ndarray): array containing the corresponding comb heights of a dataset</span>
</span><span id="PeakLadderAssigner-227"><a href="#PeakLadderAssigner-227"><span class="linenos">227</span></a>
</span><span id="PeakLadderAssigner-228"><a href="#PeakLadderAssigner-228"><span class="linenos">228</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner-229"><a href="#PeakLadderAssigner-229"><span class="linenos">229</span></a><span class="sd">        - float: the maximum fractional deviation score</span>
</span><span id="PeakLadderAssigner-230"><a href="#PeakLadderAssigner-230"><span class="linenos">230</span></a>
</span><span id="PeakLadderAssigner-231"><a href="#PeakLadderAssigner-231"><span class="linenos">231</span></a><span class="sd">        Notes:</span>
</span><span id="PeakLadderAssigner-232"><a href="#PeakLadderAssigner-232"><span class="linenos">232</span></a><span class="sd">        - This method calculates the interval lengths between adjacent ladder positions and corresponding comb heights using NumPy&#39;s</span>
</span><span id="PeakLadderAssigner-233"><a href="#PeakLadderAssigner-233"><span class="linenos">233</span></a><span class="sd">          diff function and min-max scaling with a feature range equal to the range of ladder positions.</span>
</span><span id="PeakLadderAssigner-234"><a href="#PeakLadderAssigner-234"><span class="linenos">234</span></a><span class="sd">        - It then calculates the fractional deviation between the interval lengths and the scaled comb heights, and returns the</span>
</span><span id="PeakLadderAssigner-235"><a href="#PeakLadderAssigner-235"><span class="linenos">235</span></a><span class="sd">          maximum deviation.</span>
</span><span id="PeakLadderAssigner-236"><a href="#PeakLadderAssigner-236"><span class="linenos">236</span></a>
</span><span id="PeakLadderAssigner-237"><a href="#PeakLadderAssigner-237"><span class="linenos">237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-238"><a href="#PeakLadderAssigner-238"><span class="linenos">238</span></a>        <span class="c1"># calculate interval lengths and scaled comb height intervals</span>
</span><span id="PeakLadderAssigner-239"><a href="#PeakLadderAssigner-239"><span class="linenos">239</span></a>        <span class="n">l_intervals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ladder</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-240"><a href="#PeakLadderAssigner-240"><span class="linenos">240</span></a>        <span class="n">c_intervals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">minmax_scale</span><span class="p">(</span><span class="n">comb</span><span class="p">,</span> <span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="n">ladder</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ladder</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
</span><span id="PeakLadderAssigner-241"><a href="#PeakLadderAssigner-241"><span class="linenos">241</span></a>
</span><span id="PeakLadderAssigner-242"><a href="#PeakLadderAssigner-242"><span class="linenos">242</span></a>        <span class="c1"># calculate fractional deviation between interval lengths and scaled comb height intervals</span>
</span><span id="PeakLadderAssigner-243"><a href="#PeakLadderAssigner-243"><span class="linenos">243</span></a>        <span class="n">frac_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">l_intervals</span> <span class="o">-</span> <span class="n">c_intervals</span><span class="p">)</span> <span class="o">/</span> <span class="n">l_intervals</span>
</span><span id="PeakLadderAssigner-244"><a href="#PeakLadderAssigner-244"><span class="linenos">244</span></a>
</span><span id="PeakLadderAssigner-245"><a href="#PeakLadderAssigner-245"><span class="linenos">245</span></a>        <span class="c1"># find index of maximum deviation and return the corresponding value</span>
</span><span id="PeakLadderAssigner-246"><a href="#PeakLadderAssigner-246"><span class="linenos">246</span></a>        <span class="n">max_frac_deviation_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">frac_deviation</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-247"><a href="#PeakLadderAssigner-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="n">frac_deviation</span><span class="p">[</span><span class="n">max_frac_deviation_idx</span><span class="p">]</span>
</span><span id="PeakLadderAssigner-248"><a href="#PeakLadderAssigner-248"><span class="linenos">248</span></a>
</span><span id="PeakLadderAssigner-249"><a href="#PeakLadderAssigner-249"><span class="linenos">249</span></a>    <span class="k">def</span> <span class="nf">_max_first_derivative_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-250"><a href="#PeakLadderAssigner-250"><span class="linenos">250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-251"><a href="#PeakLadderAssigner-251"><span class="linenos">251</span></a><span class="sd">        Calculates the maximum first derivative score for the given combination of features.</span>
</span><span id="PeakLadderAssigner-252"><a href="#PeakLadderAssigner-252"><span class="linenos">252</span></a>
</span><span id="PeakLadderAssigner-253"><a href="#PeakLadderAssigner-253"><span class="linenos">253</span></a><span class="sd">        Args:</span>
</span><span id="PeakLadderAssigner-254"><a href="#PeakLadderAssigner-254"><span class="linenos">254</span></a><span class="sd">            combination (np.ndarray): A 1-dimensional numpy array containing a combination of features.</span>
</span><span id="PeakLadderAssigner-255"><a href="#PeakLadderAssigner-255"><span class="linenos">255</span></a>
</span><span id="PeakLadderAssigner-256"><a href="#PeakLadderAssigner-256"><span class="linenos">256</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner-257"><a href="#PeakLadderAssigner-257"><span class="linenos">257</span></a><span class="sd">            float: The maximum first derivative score for the given combination of features.</span>
</span><span id="PeakLadderAssigner-258"><a href="#PeakLadderAssigner-258"><span class="linenos">258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-259"><a href="#PeakLadderAssigner-259"><span class="linenos">259</span></a>        <span class="c1"># Scale the combination to the range of reference sizes</span>
</span><span id="PeakLadderAssigner-260"><a href="#PeakLadderAssigner-260"><span class="linenos">260</span></a>        <span class="n">comb_scaled</span> <span class="o">=</span> <span class="n">minmax_scale</span><span class="p">(</span>
</span><span id="PeakLadderAssigner-261"><a href="#PeakLadderAssigner-261"><span class="linenos">261</span></a>            <span class="n">combination</span><span class="p">,</span>
</span><span id="PeakLadderAssigner-262"><a href="#PeakLadderAssigner-262"><span class="linenos">262</span></a>            <span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="PeakLadderAssigner-263"><a href="#PeakLadderAssigner-263"><span class="linenos">263</span></a>        <span class="p">)</span>
</span><span id="PeakLadderAssigner-264"><a href="#PeakLadderAssigner-264"><span class="linenos">264</span></a>
</span><span id="PeakLadderAssigner-265"><a href="#PeakLadderAssigner-265"><span class="linenos">265</span></a>        <span class="c1"># Calculate the differences between consecutive values of the scaled combination and the reference sizes</span>
</span><span id="PeakLadderAssigner-266"><a href="#PeakLadderAssigner-266"><span class="linenos">266</span></a>        <span class="n">diff_intervals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">comb_scaled</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-267"><a href="#PeakLadderAssigner-267"><span class="linenos">267</span></a>
</span><span id="PeakLadderAssigner-268"><a href="#PeakLadderAssigner-268"><span class="linenos">268</span></a>        <span class="c1"># Calculate the absolute gradient of the differences between consecutive values</span>
</span><span id="PeakLadderAssigner-269"><a href="#PeakLadderAssigner-269"><span class="linenos">269</span></a>        <span class="n">abs_diff_intervals_gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">diff_intervals</span><span class="p">))</span>
</span><span id="PeakLadderAssigner-270"><a href="#PeakLadderAssigner-270"><span class="linenos">270</span></a>
</span><span id="PeakLadderAssigner-271"><a href="#PeakLadderAssigner-271"><span class="linenos">271</span></a>        <span class="c1"># Find the index of the maximum absolute gradient</span>
</span><span id="PeakLadderAssigner-272"><a href="#PeakLadderAssigner-272"><span class="linenos">272</span></a>        <span class="n">max_abs_diff_intervals_gradient_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">abs_diff_intervals_gradient</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-273"><a href="#PeakLadderAssigner-273"><span class="linenos">273</span></a>
</span><span id="PeakLadderAssigner-274"><a href="#PeakLadderAssigner-274"><span class="linenos">274</span></a>        <span class="c1"># Return the maximum absolute gradient</span>
</span><span id="PeakLadderAssigner-275"><a href="#PeakLadderAssigner-275"><span class="linenos">275</span></a>        <span class="k">return</span> <span class="n">abs_diff_intervals_gradient</span><span class="p">[</span><span class="n">max_abs_diff_intervals_gradient_idx</span><span class="p">]</span>
</span><span id="PeakLadderAssigner-276"><a href="#PeakLadderAssigner-276"><span class="linenos">276</span></a>
</span><span id="PeakLadderAssigner-277"><a href="#PeakLadderAssigner-277"><span class="linenos">277</span></a>    <span class="k">def</span> <span class="nf">_max_second_derivative_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-278"><a href="#PeakLadderAssigner-278"><span class="linenos">278</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-279"><a href="#PeakLadderAssigner-279"><span class="linenos">279</span></a><span class="sd">        Calculates the maximum absolute second derivative score of the given combination.</span>
</span><span id="PeakLadderAssigner-280"><a href="#PeakLadderAssigner-280"><span class="linenos">280</span></a>
</span><span id="PeakLadderAssigner-281"><a href="#PeakLadderAssigner-281"><span class="linenos">281</span></a><span class="sd">        Args:</span>
</span><span id="PeakLadderAssigner-282"><a href="#PeakLadderAssigner-282"><span class="linenos">282</span></a><span class="sd">            combination (np.ndarray): An array of feature values for a given combination.</span>
</span><span id="PeakLadderAssigner-283"><a href="#PeakLadderAssigner-283"><span class="linenos">283</span></a>
</span><span id="PeakLadderAssigner-284"><a href="#PeakLadderAssigner-284"><span class="linenos">284</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner-285"><a href="#PeakLadderAssigner-285"><span class="linenos">285</span></a><span class="sd">            float: The maximum absolute second derivative score of the given combination.</span>
</span><span id="PeakLadderAssigner-286"><a href="#PeakLadderAssigner-286"><span class="linenos">286</span></a>
</span><span id="PeakLadderAssigner-287"><a href="#PeakLadderAssigner-287"><span class="linenos">287</span></a><span class="sd">        Raises:</span>
</span><span id="PeakLadderAssigner-288"><a href="#PeakLadderAssigner-288"><span class="linenos">288</span></a><span class="sd">            None.</span>
</span><span id="PeakLadderAssigner-289"><a href="#PeakLadderAssigner-289"><span class="linenos">289</span></a>
</span><span id="PeakLadderAssigner-290"><a href="#PeakLadderAssigner-290"><span class="linenos">290</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-291"><a href="#PeakLadderAssigner-291"><span class="linenos">291</span></a>        <span class="c1"># Scale the combination to match the range of reference sizes.</span>
</span><span id="PeakLadderAssigner-292"><a href="#PeakLadderAssigner-292"><span class="linenos">292</span></a>        <span class="n">comb_scaled</span> <span class="o">=</span> <span class="n">minmax_scale</span><span class="p">(</span>
</span><span id="PeakLadderAssigner-293"><a href="#PeakLadderAssigner-293"><span class="linenos">293</span></a>            <span class="n">combination</span><span class="p">,</span>
</span><span id="PeakLadderAssigner-294"><a href="#PeakLadderAssigner-294"><span class="linenos">294</span></a>            <span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="PeakLadderAssigner-295"><a href="#PeakLadderAssigner-295"><span class="linenos">295</span></a>        <span class="p">)</span>
</span><span id="PeakLadderAssigner-296"><a href="#PeakLadderAssigner-296"><span class="linenos">296</span></a>
</span><span id="PeakLadderAssigner-297"><a href="#PeakLadderAssigner-297"><span class="linenos">297</span></a>        <span class="c1"># Calculate the difference between the scaled combination and reference sizes.</span>
</span><span id="PeakLadderAssigner-298"><a href="#PeakLadderAssigner-298"><span class="linenos">298</span></a>        <span class="n">diff_intervals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">comb_scaled</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-299"><a href="#PeakLadderAssigner-299"><span class="linenos">299</span></a>
</span><span id="PeakLadderAssigner-300"><a href="#PeakLadderAssigner-300"><span class="linenos">300</span></a>        <span class="c1"># Calculate the absolute second derivative of the difference intervals.</span>
</span><span id="PeakLadderAssigner-301"><a href="#PeakLadderAssigner-301"><span class="linenos">301</span></a>        <span class="n">abs_second_derivative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">diff_intervals</span><span class="p">)))</span>
</span><span id="PeakLadderAssigner-302"><a href="#PeakLadderAssigner-302"><span class="linenos">302</span></a>
</span><span id="PeakLadderAssigner-303"><a href="#PeakLadderAssigner-303"><span class="linenos">303</span></a>        <span class="c1"># Find the index of the maximum absolute second derivative score.</span>
</span><span id="PeakLadderAssigner-304"><a href="#PeakLadderAssigner-304"><span class="linenos">304</span></a>        <span class="n">max_second_derivative_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">abs_second_derivative</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-305"><a href="#PeakLadderAssigner-305"><span class="linenos">305</span></a>
</span><span id="PeakLadderAssigner-306"><a href="#PeakLadderAssigner-306"><span class="linenos">306</span></a>        <span class="c1"># Return the maximum absolute second derivative score.</span>
</span><span id="PeakLadderAssigner-307"><a href="#PeakLadderAssigner-307"><span class="linenos">307</span></a>        <span class="k">return</span> <span class="n">abs_second_derivative</span><span class="p">[</span><span class="n">max_second_derivative_idx</span><span class="p">]</span>
</span><span id="PeakLadderAssigner-308"><a href="#PeakLadderAssigner-308"><span class="linenos">308</span></a>
</span><span id="PeakLadderAssigner-309"><a href="#PeakLadderAssigner-309"><span class="linenos">309</span></a>    <span class="k">def</span> <span class="nf">_max_spline_second_derivative_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="PeakLadderAssigner-310"><a href="#PeakLadderAssigner-310"><span class="linenos">310</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-311"><a href="#PeakLadderAssigner-311"><span class="linenos">311</span></a><span class="sd">        Calculates the maximum absolute value of the second derivative of a given combination of values using a UnivariateSpline.</span>
</span><span id="PeakLadderAssigner-312"><a href="#PeakLadderAssigner-312"><span class="linenos">312</span></a>
</span><span id="PeakLadderAssigner-313"><a href="#PeakLadderAssigner-313"><span class="linenos">313</span></a><span class="sd">        Args:</span>
</span><span id="PeakLadderAssigner-314"><a href="#PeakLadderAssigner-314"><span class="linenos">314</span></a><span class="sd">        - self (object): an instance of the class containing the function</span>
</span><span id="PeakLadderAssigner-315"><a href="#PeakLadderAssigner-315"><span class="linenos">315</span></a><span class="sd">        - combination (np.ndarray): an array of values representing a combination</span>
</span><span id="PeakLadderAssigner-316"><a href="#PeakLadderAssigner-316"><span class="linenos">316</span></a>
</span><span id="PeakLadderAssigner-317"><a href="#PeakLadderAssigner-317"><span class="linenos">317</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner-318"><a href="#PeakLadderAssigner-318"><span class="linenos">318</span></a><span class="sd">        - max_value (float): the maximum absolute value of the second derivative of the given combination</span>
</span><span id="PeakLadderAssigner-319"><a href="#PeakLadderAssigner-319"><span class="linenos">319</span></a>
</span><span id="PeakLadderAssigner-320"><a href="#PeakLadderAssigner-320"><span class="linenos">320</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner-321"><a href="#PeakLadderAssigner-321"><span class="linenos">321</span></a>        <span class="c1"># create a UnivariateSpline object using the reference sizes and the given combination</span>
</span><span id="PeakLadderAssigner-322"><a href="#PeakLadderAssigner-322"><span class="linenos">322</span></a>        <span class="n">spl</span> <span class="o">=</span> <span class="n">UnivariateSpline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span><span class="p">,</span> <span class="n">combination</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-323"><a href="#PeakLadderAssigner-323"><span class="linenos">323</span></a>
</span><span id="PeakLadderAssigner-324"><a href="#PeakLadderAssigner-324"><span class="linenos">324</span></a>        <span class="c1"># calculate the second derivative of the spline</span>
</span><span id="PeakLadderAssigner-325"><a href="#PeakLadderAssigner-325"><span class="linenos">325</span></a>        <span class="n">der2</span> <span class="o">=</span> <span class="n">spl</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="PeakLadderAssigner-326"><a href="#PeakLadderAssigner-326"><span class="linenos">326</span></a>
</span><span id="PeakLadderAssigner-327"><a href="#PeakLadderAssigner-327"><span class="linenos">327</span></a>        <span class="c1"># evaluate the second derivative at each reference size and return the maximum absolute value</span>
</span><span id="PeakLadderAssigner-328"><a href="#PeakLadderAssigner-328"><span class="linenos">328</span></a>        <span class="n">max_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">der2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span><span class="p">)))</span>
</span><span id="PeakLadderAssigner-329"><a href="#PeakLadderAssigner-329"><span class="linenos">329</span></a>
</span><span id="PeakLadderAssigner-330"><a href="#PeakLadderAssigner-330"><span class="linenos">330</span></a>        <span class="k">return</span> <span class="n">max_value</span>
</span></pre></div>


            <div class="docstring"><p>A class that assigns peak sizes to a ladder for use in DNA fragment size analysis.
The peak sizes are generated based on a given size standard and the input parameters.</p>

<p>Attributes:
fsa_file (FsaFile): an object of the FsaFile class that contains parameters for analysis</p>

<p>Methods:
assign_ladder_peak_sizes(): Assigns peak sizes to a ladder based on the given parameters and returns the best combination.
get_peaks(size_standard): Finds peaks in the size standard based on given parameters and returns the peaks.
generate_graph(peaks): Generates a graph based on the peaks and returns the graph.
generate_combinations(graph): Generates combinations of peaks based on the graph and returns the combinations.
get_best_fit(combinations, method): Finds the best fit for the given combinations and returns the best combination.
_polynomial_model_inv_r2_score(ladder, comb): Returns a score based on the polynomial model inverse r2 score.
_max_fractional_deviation_score(ladder, comb): Returns a score based on the maximum fractional deviation.
_max_first_derivative_score(combination): Returns a score based on the maximum first derivative.
_max_second_derivative_score(combination): Returns a score based on the maximum second derivative.
_max_spline_second_derivative_score(combination): Returns a score based on the maximum spline second derivative.</p>
</div>


                            <div id="PeakLadderAssigner.__init__" class="classattr">
                                        <input id="PeakLadderAssigner.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PeakLadderAssigner</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fsa_file</span><span class="p">:</span> <span class="n"><a href="#FsaFile">FsaFile</a></span></span>)</span>

                <label class="view-source-button" for="PeakLadderAssigner.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakLadderAssigner.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakLadderAssigner.__init__-34"><a href="#PeakLadderAssigner.__init__-34"><span class="linenos">34</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fsa_file</span><span class="p">:</span> <span class="n">FsaFile</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.__init__-35"><a href="#PeakLadderAssigner.__init__-35"><span class="linenos">35</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.__init__-36"><a href="#PeakLadderAssigner.__init__-36"><span class="linenos">36</span></a><span class="sd">        Initializes the class with an object of the FsaFile class.</span>
</span><span id="PeakLadderAssigner.__init__-37"><a href="#PeakLadderAssigner.__init__-37"><span class="linenos">37</span></a>
</span><span id="PeakLadderAssigner.__init__-38"><a href="#PeakLadderAssigner.__init__-38"><span class="linenos">38</span></a><span class="sd">        Args:</span>
</span><span id="PeakLadderAssigner.__init__-39"><a href="#PeakLadderAssigner.__init__-39"><span class="linenos">39</span></a><span class="sd">        fsa_file (FsaFile): an object of the FsaFile class that contains parameters for analysis</span>
</span><span id="PeakLadderAssigner.__init__-40"><a href="#PeakLadderAssigner.__init__-40"><span class="linenos">40</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.__init__-41"><a href="#PeakLadderAssigner.__init__-41"><span class="linenos">41</span></a>
</span><span id="PeakLadderAssigner.__init__-42"><a href="#PeakLadderAssigner.__init__-42"><span class="linenos">42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span> <span class="o">=</span> <span class="n">fsa_file</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the class with an object of the FsaFile class.</p>

<p>Args:
fsa_file (FsaFile): an object of the FsaFile class that contains parameters for analysis</p>
</div>


                            </div>
                            <div id="PeakLadderAssigner.fsa_file" class="classattr">
                                <div class="attr variable">
            <span class="name">fsa_file</span>

        
    </div>
    <a class="headerlink" href="#PeakLadderAssigner.fsa_file"></a>
    
    

                            </div>
                            <div id="PeakLadderAssigner.assign_ladder_peak_sizes" class="classattr">
                                        <input id="PeakLadderAssigner.assign_ladder_peak_sizes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">assign_ladder_peak_sizes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PeakLadderAssigner.assign_ladder_peak_sizes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakLadderAssigner.assign_ladder_peak_sizes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-44"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-44"><span class="linenos">44</span></a>    <span class="k">def</span> <span class="nf">assign_ladder_peak_sizes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-45"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-45"><span class="linenos">45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-46"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-46"><span class="linenos">46</span></a><span class="sd">        Assigns peak sizes to a ladder based on the given parameters and returns the best combination.</span>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-47"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-47"><span class="linenos">47</span></a>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-48"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-48"><span class="linenos">48</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-49"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-49"><span class="linenos">49</span></a><span class="sd">        np.array: the best combination of peak sizes</span>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-50"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-50"><span class="linenos">50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-51"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-51"><span class="linenos">51</span></a>        <span class="n">peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">size_standard</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-52"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-52"><span class="linenos">52</span></a>        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_graph</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-53"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-53"><span class="linenos">53</span></a>        <span class="n">combinations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_combinations</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-54"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-54"><span class="linenos">54</span></a>        <span class="n">best_combination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_best_fit</span><span class="p">(</span><span class="n">combinations</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-55"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-55"><span class="linenos">55</span></a>
</span><span id="PeakLadderAssigner.assign_ladder_peak_sizes-56"><a href="#PeakLadderAssigner.assign_ladder_peak_sizes-56"><span class="linenos">56</span></a>        <span class="k">return</span> <span class="n">best_combination</span>
</span></pre></div>


            <div class="docstring"><p>Assigns peak sizes to a ladder based on the given parameters and returns the best combination.</p>

<p>Returns:
np.array: the best combination of peak sizes</p>
</div>


                            </div>
                            <div id="PeakLadderAssigner.get_peaks" class="classattr">
                                        <input id="PeakLadderAssigner.get_peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_peaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">size_standard</span></span><span class="return-annotation">) -> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="n">array</span><span class="o">&gt;</span>:</span></span>

                <label class="view-source-button" for="PeakLadderAssigner.get_peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakLadderAssigner.get_peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakLadderAssigner.get_peaks-58"><a href="#PeakLadderAssigner.get_peaks-58"><span class="linenos">58</span></a>    <span class="k">def</span> <span class="nf">get_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size_standard</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.get_peaks-59"><a href="#PeakLadderAssigner.get_peaks-59"><span class="linenos">59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.get_peaks-60"><a href="#PeakLadderAssigner.get_peaks-60"><span class="linenos">60</span></a><span class="sd">        Finds peaks in the size standard based on given parameters and returns the peaks.</span>
</span><span id="PeakLadderAssigner.get_peaks-61"><a href="#PeakLadderAssigner.get_peaks-61"><span class="linenos">61</span></a>
</span><span id="PeakLadderAssigner.get_peaks-62"><a href="#PeakLadderAssigner.get_peaks-62"><span class="linenos">62</span></a><span class="sd">        Args:</span>
</span><span id="PeakLadderAssigner.get_peaks-63"><a href="#PeakLadderAssigner.get_peaks-63"><span class="linenos">63</span></a><span class="sd">        size_standard (np.array): the size standard array</span>
</span><span id="PeakLadderAssigner.get_peaks-64"><a href="#PeakLadderAssigner.get_peaks-64"><span class="linenos">64</span></a>
</span><span id="PeakLadderAssigner.get_peaks-65"><a href="#PeakLadderAssigner.get_peaks-65"><span class="linenos">65</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner.get_peaks-66"><a href="#PeakLadderAssigner.get_peaks-66"><span class="linenos">66</span></a><span class="sd">        np.array: the peaks array</span>
</span><span id="PeakLadderAssigner.get_peaks-67"><a href="#PeakLadderAssigner.get_peaks-67"><span class="linenos">67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.get_peaks-68"><a href="#PeakLadderAssigner.get_peaks-68"><span class="linenos">68</span></a>
</span><span id="PeakLadderAssigner.get_peaks-69"><a href="#PeakLadderAssigner.get_peaks-69"><span class="linenos">69</span></a>        <span class="n">peaks_obj</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">(</span>
</span><span id="PeakLadderAssigner.get_peaks-70"><a href="#PeakLadderAssigner.get_peaks-70"><span class="linenos">70</span></a>            <span class="n">size_standard</span><span class="p">,</span>
</span><span id="PeakLadderAssigner.get_peaks-71"><a href="#PeakLadderAssigner.get_peaks-71"><span class="linenos">71</span></a>            <span class="n">distance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">min_interpeak_distance</span><span class="p">,</span>
</span><span id="PeakLadderAssigner.get_peaks-72"><a href="#PeakLadderAssigner.get_peaks-72"><span class="linenos">72</span></a>            <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">min_height</span><span class="p">,</span>
</span><span id="PeakLadderAssigner.get_peaks-73"><a href="#PeakLadderAssigner.get_peaks-73"><span class="linenos">73</span></a>        <span class="p">)</span>
</span><span id="PeakLadderAssigner.get_peaks-74"><a href="#PeakLadderAssigner.get_peaks-74"><span class="linenos">74</span></a>
</span><span id="PeakLadderAssigner.get_peaks-75"><a href="#PeakLadderAssigner.get_peaks-75"><span class="linenos">75</span></a>        <span class="n">peaks</span> <span class="o">=</span> <span class="n">peaks_obj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PeakLadderAssigner.get_peaks-76"><a href="#PeakLadderAssigner.get_peaks-76"><span class="linenos">76</span></a>        <span class="n">heights</span> <span class="o">=</span> <span class="n">peaks_obj</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;peak_heights&quot;</span><span class="p">]</span>
</span><span id="PeakLadderAssigner.get_peaks-77"><a href="#PeakLadderAssigner.get_peaks-77"><span class="linenos">77</span></a>
</span><span id="PeakLadderAssigner.get_peaks-78"><a href="#PeakLadderAssigner.get_peaks-78"><span class="linenos">78</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;peaks&quot;</span><span class="p">:</span> <span class="n">peaks</span><span class="p">,</span> <span class="s2">&quot;heights&quot;</span><span class="p">:</span> <span class="n">heights</span><span class="p">})</span>
</span><span id="PeakLadderAssigner.get_peaks-79"><a href="#PeakLadderAssigner.get_peaks-79"><span class="linenos">79</span></a>
</span><span id="PeakLadderAssigner.get_peaks-80"><a href="#PeakLadderAssigner.get_peaks-80"><span class="linenos">80</span></a>        <span class="c1"># TODO</span>
</span><span id="PeakLadderAssigner.get_peaks-81"><a href="#PeakLadderAssigner.get_peaks-81"><span class="linenos">81</span></a>        <span class="c1"># Dropped the below, then it worked with the new test files</span>
</span><span id="PeakLadderAssigner.get_peaks-82"><a href="#PeakLadderAssigner.get_peaks-82"><span class="linenos">82</span></a>        <span class="c1"># idxmax = df[&quot;heights&quot;].idxmax()</span>
</span><span id="PeakLadderAssigner.get_peaks-83"><a href="#PeakLadderAssigner.get_peaks-83"><span class="linenos">83</span></a>        <span class="c1"># df = df.drop(idxmax)</span>
</span><span id="PeakLadderAssigner.get_peaks-84"><a href="#PeakLadderAssigner.get_peaks-84"><span class="linenos">84</span></a>
</span><span id="PeakLadderAssigner.get_peaks-85"><a href="#PeakLadderAssigner.get_peaks-85"><span class="linenos">85</span></a>        <span class="n">peaks_adj</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">max_peak_count</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;heights&quot;</span><span class="p">])</span>
</span><span id="PeakLadderAssigner.get_peaks-86"><a href="#PeakLadderAssigner.get_peaks-86"><span class="linenos">86</span></a>
</span><span id="PeakLadderAssigner.get_peaks-87"><a href="#PeakLadderAssigner.get_peaks-87"><span class="linenos">87</span></a>        <span class="k">return</span> <span class="n">peaks_adj</span><span class="p">[</span><span class="s2">&quot;peaks&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Finds peaks in the size standard based on given parameters and returns the peaks.</p>

<p>Args:
size_standard (np.array): the size standard array</p>

<p>Returns:
np.array: the peaks array</p>
</div>


                            </div>
                            <div id="PeakLadderAssigner.generate_graph" class="classattr">
                                        <input id="PeakLadderAssigner.generate_graph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_graph</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">peaks</span></span><span class="return-annotation">) -> <span class="n">networkx</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">digraph</span><span class="o">.</span><span class="n">DiGraph</span>:</span></span>

                <label class="view-source-button" for="PeakLadderAssigner.generate_graph-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakLadderAssigner.generate_graph"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakLadderAssigner.generate_graph-89"><a href="#PeakLadderAssigner.generate_graph-89"><span class="linenos"> 89</span></a>    <span class="k">def</span> <span class="nf">generate_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peaks</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.generate_graph-90"><a href="#PeakLadderAssigner.generate_graph-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.generate_graph-91"><a href="#PeakLadderAssigner.generate_graph-91"><span class="linenos"> 91</span></a><span class="sd">        Generates a graph based on the peaks and returns the graph.</span>
</span><span id="PeakLadderAssigner.generate_graph-92"><a href="#PeakLadderAssigner.generate_graph-92"><span class="linenos"> 92</span></a>
</span><span id="PeakLadderAssigner.generate_graph-93"><a href="#PeakLadderAssigner.generate_graph-93"><span class="linenos"> 93</span></a><span class="sd">        Args:</span>
</span><span id="PeakLadderAssigner.generate_graph-94"><a href="#PeakLadderAssigner.generate_graph-94"><span class="linenos"> 94</span></a><span class="sd">        peaks (np.array): the peaks array</span>
</span><span id="PeakLadderAssigner.generate_graph-95"><a href="#PeakLadderAssigner.generate_graph-95"><span class="linenos"> 95</span></a>
</span><span id="PeakLadderAssigner.generate_graph-96"><a href="#PeakLadderAssigner.generate_graph-96"><span class="linenos"> 96</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner.generate_graph-97"><a href="#PeakLadderAssigner.generate_graph-97"><span class="linenos"> 97</span></a><span class="sd">        nx.DiGraph: the graph object</span>
</span><span id="PeakLadderAssigner.generate_graph-98"><a href="#PeakLadderAssigner.generate_graph-98"><span class="linenos"> 98</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.generate_graph-99"><a href="#PeakLadderAssigner.generate_graph-99"><span class="linenos"> 99</span></a>        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
</span><span id="PeakLadderAssigner.generate_graph-100"><a href="#PeakLadderAssigner.generate_graph-100"><span class="linenos">100</span></a>
</span><span id="PeakLadderAssigner.generate_graph-101"><a href="#PeakLadderAssigner.generate_graph-101"><span class="linenos">101</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">peaks</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.generate_graph-102"><a href="#PeakLadderAssigner.generate_graph-102"><span class="linenos">102</span></a>            <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.generate_graph-103"><a href="#PeakLadderAssigner.generate_graph-103"><span class="linenos">103</span></a>
</span><span id="PeakLadderAssigner.generate_graph-104"><a href="#PeakLadderAssigner.generate_graph-104"><span class="linenos">104</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PeakLadderAssigner.generate_graph-105"><a href="#PeakLadderAssigner.generate_graph-105"><span class="linenos">105</span></a>        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">peaks</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.generate_graph-106"><a href="#PeakLadderAssigner.generate_graph-106"><span class="linenos">106</span></a>            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="PeakLadderAssigner.generate_graph-107"><a href="#PeakLadderAssigner.generate_graph-107"><span class="linenos">107</span></a>            <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">peaks</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.generate_graph-108"><a href="#PeakLadderAssigner.generate_graph-108"><span class="linenos">108</span></a>                <span class="n">diff</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">peaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PeakLadderAssigner.generate_graph-109"><a href="#PeakLadderAssigner.generate_graph-109"><span class="linenos">109</span></a>                <span class="k">if</span> <span class="n">diff</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">max_ladder_trace_distance</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.generate_graph-110"><a href="#PeakLadderAssigner.generate_graph-110"><span class="linenos">110</span></a>                    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">peaks</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">peaks</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">length</span><span class="o">=</span><span class="n">diff</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.generate_graph-111"><a href="#PeakLadderAssigner.generate_graph-111"><span class="linenos">111</span></a>                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PeakLadderAssigner.generate_graph-112"><a href="#PeakLadderAssigner.generate_graph-112"><span class="linenos">112</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="PeakLadderAssigner.generate_graph-113"><a href="#PeakLadderAssigner.generate_graph-113"><span class="linenos">113</span></a>
</span><span id="PeakLadderAssigner.generate_graph-114"><a href="#PeakLadderAssigner.generate_graph-114"><span class="linenos">114</span></a>        <span class="k">return</span> <span class="n">G</span>
</span></pre></div>


            <div class="docstring"><p>Generates a graph based on the peaks and returns the graph.</p>

<p>Args:
peaks (np.array): the peaks array</p>

<p>Returns:
nx.DiGraph: the graph object</p>
</div>


                            </div>
                            <div id="PeakLadderAssigner.generate_combinations" class="classattr">
                                        <input id="PeakLadderAssigner.generate_combinations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_combinations</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">graph</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PeakLadderAssigner.generate_combinations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakLadderAssigner.generate_combinations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakLadderAssigner.generate_combinations-116"><a href="#PeakLadderAssigner.generate_combinations-116"><span class="linenos">116</span></a>    <span class="k">def</span> <span class="nf">generate_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph</span><span class="p">):</span>
</span><span id="PeakLadderAssigner.generate_combinations-117"><a href="#PeakLadderAssigner.generate_combinations-117"><span class="linenos">117</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.generate_combinations-118"><a href="#PeakLadderAssigner.generate_combinations-118"><span class="linenos">118</span></a><span class="sd">        Generates combinations of nodes from a given directed acyclic graph (DAG)</span>
</span><span id="PeakLadderAssigner.generate_combinations-119"><a href="#PeakLadderAssigner.generate_combinations-119"><span class="linenos">119</span></a><span class="sd">        that satisfy certain conditions.</span>
</span><span id="PeakLadderAssigner.generate_combinations-120"><a href="#PeakLadderAssigner.generate_combinations-120"><span class="linenos">120</span></a>
</span><span id="PeakLadderAssigner.generate_combinations-121"><a href="#PeakLadderAssigner.generate_combinations-121"><span class="linenos">121</span></a><span class="sd">        Parameters:</span>
</span><span id="PeakLadderAssigner.generate_combinations-122"><a href="#PeakLadderAssigner.generate_combinations-122"><span class="linenos">122</span></a><span class="sd">        graph (networkx.DiGraph): a DAG representing a state machine</span>
</span><span id="PeakLadderAssigner.generate_combinations-123"><a href="#PeakLadderAssigner.generate_combinations-123"><span class="linenos">123</span></a>
</span><span id="PeakLadderAssigner.generate_combinations-124"><a href="#PeakLadderAssigner.generate_combinations-124"><span class="linenos">124</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner.generate_combinations-125"><a href="#PeakLadderAssigner.generate_combinations-125"><span class="linenos">125</span></a><span class="sd">        A numpy array representing a sequence of nodes that satisfies the</span>
</span><span id="PeakLadderAssigner.generate_combinations-126"><a href="#PeakLadderAssigner.generate_combinations-126"><span class="linenos">126</span></a><span class="sd">        conditions of the DAG.</span>
</span><span id="PeakLadderAssigner.generate_combinations-127"><a href="#PeakLadderAssigner.generate_combinations-127"><span class="linenos">127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.generate_combinations-128"><a href="#PeakLadderAssigner.generate_combinations-128"><span class="linenos">128</span></a>
</span><span id="PeakLadderAssigner.generate_combinations-129"><a href="#PeakLadderAssigner.generate_combinations-129"><span class="linenos">129</span></a>        <span class="c1"># Get start nodes that have zero in-degree</span>
</span><span id="PeakLadderAssigner.generate_combinations-130"><a href="#PeakLadderAssigner.generate_combinations-130"><span class="linenos">130</span></a>        <span class="n">start_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="PeakLadderAssigner.generate_combinations-131"><a href="#PeakLadderAssigner.generate_combinations-131"><span class="linenos">131</span></a>
</span><span id="PeakLadderAssigner.generate_combinations-132"><a href="#PeakLadderAssigner.generate_combinations-132"><span class="linenos">132</span></a>        <span class="c1"># Get end nodes that have zero out-degree</span>
</span><span id="PeakLadderAssigner.generate_combinations-133"><a href="#PeakLadderAssigner.generate_combinations-133"><span class="linenos">133</span></a>        <span class="n">end_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">graph</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="PeakLadderAssigner.generate_combinations-134"><a href="#PeakLadderAssigner.generate_combinations-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">start_nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">end_nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.generate_combinations-135"><a href="#PeakLadderAssigner.generate_combinations-135"><span class="linenos">135</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Graph does not have start or end nodes&quot;</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.generate_combinations-136"><a href="#PeakLadderAssigner.generate_combinations-136"><span class="linenos">136</span></a>
</span><span id="PeakLadderAssigner.generate_combinations-137"><a href="#PeakLadderAssigner.generate_combinations-137"><span class="linenos">137</span></a>        <span class="c1"># Get all simple paths from start node to end node</span>
</span><span id="PeakLadderAssigner.generate_combinations-138"><a href="#PeakLadderAssigner.generate_combinations-138"><span class="linenos">138</span></a>        <span class="n">all_paths</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakLadderAssigner.generate_combinations-139"><a href="#PeakLadderAssigner.generate_combinations-139"><span class="linenos">139</span></a>        <span class="k">for</span> <span class="n">start_node</span> <span class="ow">in</span> <span class="n">start_nodes</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.generate_combinations-140"><a href="#PeakLadderAssigner.generate_combinations-140"><span class="linenos">140</span></a>            <span class="k">for</span> <span class="n">end_node</span> <span class="ow">in</span> <span class="n">end_nodes</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.generate_combinations-141"><a href="#PeakLadderAssigner.generate_combinations-141"><span class="linenos">141</span></a>                <span class="n">paths</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">start_node</span><span class="p">,</span> <span class="n">end_node</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.generate_combinations-142"><a href="#PeakLadderAssigner.generate_combinations-142"><span class="linenos">142</span></a>                <span class="n">all_paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.generate_combinations-143"><a href="#PeakLadderAssigner.generate_combinations-143"><span class="linenos">143</span></a>
</span><span id="PeakLadderAssigner.generate_combinations-144"><a href="#PeakLadderAssigner.generate_combinations-144"><span class="linenos">144</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.generate_combinations-145"><a href="#PeakLadderAssigner.generate_combinations-145"><span class="linenos">145</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No paths found from start to end nodes&quot;</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.generate_combinations-146"><a href="#PeakLadderAssigner.generate_combinations-146"><span class="linenos">146</span></a>
</span><span id="PeakLadderAssigner.generate_combinations-147"><a href="#PeakLadderAssigner.generate_combinations-147"><span class="linenos">147</span></a>        <span class="c1"># Generate combinations of nodes that satisfy certain conditions</span>
</span><span id="PeakLadderAssigner.generate_combinations-148"><a href="#PeakLadderAssigner.generate_combinations-148"><span class="linenos">148</span></a>        <span class="k">for</span> <span class="n">p_arr</span> <span class="ow">in</span> <span class="n">all_paths</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.generate_combinations-149"><a href="#PeakLadderAssigner.generate_combinations-149"><span class="linenos">149</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_arr</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="PeakLadderAssigner.generate_combinations-150"><a href="#PeakLadderAssigner.generate_combinations-150"><span class="linenos">150</span></a>                <span class="k">yield</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p_arr</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_count</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Generates combinations of nodes from a given directed acyclic graph (DAG)
that satisfy certain conditions.</p>

<p>Parameters:
graph (networkx.DiGraph): a DAG representing a state machine</p>

<p>Returns:
A numpy array representing a sequence of nodes that satisfies the
conditions of the DAG.</p>
</div>


                            </div>
                            <div id="PeakLadderAssigner.get_best_fit" class="classattr">
                                        <input id="PeakLadderAssigner.get_best_fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_best_fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">combinations</span>, </span><span class="param"><span class="n">method</span><span class="o">=</span><span class="s1">&#39;2nd_derivative&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PeakLadderAssigner.get_best_fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakLadderAssigner.get_best_fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakLadderAssigner.get_best_fit-152"><a href="#PeakLadderAssigner.get_best_fit-152"><span class="linenos">152</span></a>    <span class="k">def</span> <span class="nf">get_best_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combinations</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;2nd_derivative&quot;</span><span class="p">):</span>
</span><span id="PeakLadderAssigner.get_best_fit-153"><a href="#PeakLadderAssigner.get_best_fit-153"><span class="linenos">153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.get_best_fit-154"><a href="#PeakLadderAssigner.get_best_fit-154"><span class="linenos">154</span></a><span class="sd">        Calculates the best fit for a given set of combinations using a specified method.</span>
</span><span id="PeakLadderAssigner.get_best_fit-155"><a href="#PeakLadderAssigner.get_best_fit-155"><span class="linenos">155</span></a>
</span><span id="PeakLadderAssigner.get_best_fit-156"><a href="#PeakLadderAssigner.get_best_fit-156"><span class="linenos">156</span></a><span class="sd">        Parameters:</span>
</span><span id="PeakLadderAssigner.get_best_fit-157"><a href="#PeakLadderAssigner.get_best_fit-157"><span class="linenos">157</span></a><span class="sd">        combinations (iterable): an iterable containing combinations of nodes</span>
</span><span id="PeakLadderAssigner.get_best_fit-158"><a href="#PeakLadderAssigner.get_best_fit-158"><span class="linenos">158</span></a><span class="sd">        method (str): a string indicating the method to use. The default method is</span>
</span><span id="PeakLadderAssigner.get_best_fit-159"><a href="#PeakLadderAssigner.get_best_fit-159"><span class="linenos">159</span></a><span class="sd">            &quot;2nd_derivative&quot;.</span>
</span><span id="PeakLadderAssigner.get_best_fit-160"><a href="#PeakLadderAssigner.get_best_fit-160"><span class="linenos">160</span></a>
</span><span id="PeakLadderAssigner.get_best_fit-161"><a href="#PeakLadderAssigner.get_best_fit-161"><span class="linenos">161</span></a><span class="sd">        Returns:</span>
</span><span id="PeakLadderAssigner.get_best_fit-162"><a href="#PeakLadderAssigner.get_best_fit-162"><span class="linenos">162</span></a><span class="sd">        A numpy array representing the combination of nodes with the best fit.</span>
</span><span id="PeakLadderAssigner.get_best_fit-163"><a href="#PeakLadderAssigner.get_best_fit-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakLadderAssigner.get_best_fit-164"><a href="#PeakLadderAssigner.get_best_fit-164"><span class="linenos">164</span></a>
</span><span id="PeakLadderAssigner.get_best_fit-165"><a href="#PeakLadderAssigner.get_best_fit-165"><span class="linenos">165</span></a>        <span class="c1"># Create an empty dataframe to store combinations and scores</span>
</span><span id="PeakLadderAssigner.get_best_fit-166"><a href="#PeakLadderAssigner.get_best_fit-166"><span class="linenos">166</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="PeakLadderAssigner.get_best_fit-167"><a href="#PeakLadderAssigner.get_best_fit-167"><span class="linenos">167</span></a>
</span><span id="PeakLadderAssigner.get_best_fit-168"><a href="#PeakLadderAssigner.get_best_fit-168"><span class="linenos">168</span></a>        <span class="c1"># Store the combinations in the dataframe</span>
</span><span id="PeakLadderAssigner.get_best_fit-169"><a href="#PeakLadderAssigner.get_best_fit-169"><span class="linenos">169</span></a>        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;combination&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">combinations</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.get_best_fit-170"><a href="#PeakLadderAssigner.get_best_fit-170"><span class="linenos">170</span></a>
</span><span id="PeakLadderAssigner.get_best_fit-171"><a href="#PeakLadderAssigner.get_best_fit-171"><span class="linenos">171</span></a>        <span class="c1"># Calculate the score for each combination using the specified method</span>
</span><span id="PeakLadderAssigner.get_best_fit-172"><a href="#PeakLadderAssigner.get_best_fit-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;2nd_derivative&quot;</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.get_best_fit-173"><a href="#PeakLadderAssigner.get_best_fit-173"><span class="linenos">173</span></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_max_spline_second_derivative_score</span><span class="p">)(</span>
</span><span id="PeakLadderAssigner.get_best_fit-174"><a href="#PeakLadderAssigner.get_best_fit-174"><span class="linenos">174</span></a>                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;combination&quot;</span><span class="p">]</span>
</span><span id="PeakLadderAssigner.get_best_fit-175"><a href="#PeakLadderAssigner.get_best_fit-175"><span class="linenos">175</span></a>            <span class="p">)</span>
</span><span id="PeakLadderAssigner.get_best_fit-176"><a href="#PeakLadderAssigner.get_best_fit-176"><span class="linenos">176</span></a>
</span><span id="PeakLadderAssigner.get_best_fit-177"><a href="#PeakLadderAssigner.get_best_fit-177"><span class="linenos">177</span></a>        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;first_derivative&quot;</span><span class="p">:</span>
</span><span id="PeakLadderAssigner.get_best_fit-178"><a href="#PeakLadderAssigner.get_best_fit-178"><span class="linenos">178</span></a>            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_max_first_derivative_score</span><span class="p">)(</span>
</span><span id="PeakLadderAssigner.get_best_fit-179"><a href="#PeakLadderAssigner.get_best_fit-179"><span class="linenos">179</span></a>                <span class="n">df</span><span class="p">[</span><span class="s2">&quot;combination&quot;</span><span class="p">]</span>
</span><span id="PeakLadderAssigner.get_best_fit-180"><a href="#PeakLadderAssigner.get_best_fit-180"><span class="linenos">180</span></a>            <span class="p">)</span>
</span><span id="PeakLadderAssigner.get_best_fit-181"><a href="#PeakLadderAssigner.get_best_fit-181"><span class="linenos">181</span></a>
</span><span id="PeakLadderAssigner.get_best_fit-182"><a href="#PeakLadderAssigner.get_best_fit-182"><span class="linenos">182</span></a>        <span class="c1"># Sort the dataframe by score in ascending order</span>
</span><span id="PeakLadderAssigner.get_best_fit-183"><a href="#PeakLadderAssigner.get_best_fit-183"><span class="linenos">183</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.get_best_fit-184"><a href="#PeakLadderAssigner.get_best_fit-184"><span class="linenos">184</span></a>
</span><span id="PeakLadderAssigner.get_best_fit-185"><a href="#PeakLadderAssigner.get_best_fit-185"><span class="linenos">185</span></a>        <span class="c1"># Get the best combination (i.e., the one with the lowest score)</span>
</span><span id="PeakLadderAssigner.get_best_fit-186"><a href="#PeakLadderAssigner.get_best_fit-186"><span class="linenos">186</span></a>        <span class="n">best</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PeakLadderAssigner.get_best_fit-187"><a href="#PeakLadderAssigner.get_best_fit-187"><span class="linenos">187</span></a>
</span><span id="PeakLadderAssigner.get_best_fit-188"><a href="#PeakLadderAssigner.get_best_fit-188"><span class="linenos">188</span></a>        <span class="c1"># Return the best combination as a numpy array</span>
</span><span id="PeakLadderAssigner.get_best_fit-189"><a href="#PeakLadderAssigner.get_best_fit-189"><span class="linenos">189</span></a>        <span class="k">return</span> <span class="n">best</span><span class="o">.</span><span class="n">combination</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the best fit for a given set of combinations using a specified method.</p>

<p>Parameters:
combinations (iterable): an iterable containing combinations of nodes
method (str): a string indicating the method to use. The default method is
    "2nd_derivative".</p>

<p>Returns:
A numpy array representing the combination of nodes with the best fit.</p>
</div>


                            </div>
                </section>
                <section id="LADDERS">
                    <div class="attr variable">
            <span class="name">LADDERS</span>        =
<input id="LADDERS-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="LADDERS-view-value"></label><span class="default_value">{&#39;LIZ&#39;: {&#39;sizes&#39;: array([ 20,  40,  60,  80, 100, 114, 120, 140, 160, 180, 200, 214, 220,
       240, 260, 280, 300, 314, 320, 340, 360, 380, 400, 414, 420, 440,
       460, 480, 500, 514, 520, 540, 560, 580, 600]), &#39;distance&#39;: 30, &#39;height&#39;: 100, &#39;max_ladder_trace_distance&#39;: 300, &#39;channel&#39;: &#39;DATA205&#39;}, &#39;ROX&#39;: {&#39;sizes&#39;: array([  79,   90,  105,  131,  151,  182,  201,  254,  306,  337,  362,
        425,  486,  509,  560,  598,  674,  739,  799,  902, 1007]), &#39;distance&#39;: 30, &#39;height&#39;: 100, &#39;max_ladder_trace_distance&#39;: 600, &#39;channel&#39;: &#39;DATA4&#39;}, &#39;ORANGE&#39;: {&#39;sizes&#39;: array([ 73,  88, 123, 148, 173, 198, 223, 248, 273, 298, 324, 349, 373,
       398, 423, 448, 470, 495, 520, 545, 555]), &#39;distance&#39;: 30, &#39;height&#39;: 100, &#39;max_ladder_trace_distance&#39;: 300, &#39;channel&#39;: &#39;DATA205&#39;}}</span>

        
    </div>
    <a class="headerlink" href="#LADDERS"></a>
    
    

                </section>
                <section id="baseline_arPLS">
                            <input id="baseline_arPLS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">baseline_arPLS</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">ratio</span><span class="o">=</span><span class="mf">0.99</span>, </span><span class="param"><span class="n">lam</span><span class="o">=</span><span class="mi">100</span>, </span><span class="param"><span class="n">niter</span><span class="o">=</span><span class="mi">1000</span>, </span><span class="param"><span class="n">full_output</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="baseline_arPLS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#baseline_arPLS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="baseline_arPLS-16"><a href="#baseline_arPLS-16"><span class="linenos">16</span></a><span class="k">def</span> <span class="nf">baseline_arPLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="baseline_arPLS-17"><a href="#baseline_arPLS-17"><span class="linenos">17</span></a>    <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="baseline_arPLS-18"><a href="#baseline_arPLS-18"><span class="linenos">18</span></a>
</span><span id="baseline_arPLS-19"><a href="#baseline_arPLS-19"><span class="linenos">19</span></a>    <span class="n">diag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="baseline_arPLS-20"><a href="#baseline_arPLS-20"><span class="linenos">20</span></a>    <span class="n">D</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">spdiags</span><span class="p">([</span><span class="n">diag</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">diag</span><span class="p">,</span> <span class="n">diag</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="baseline_arPLS-21"><a href="#baseline_arPLS-21"><span class="linenos">21</span></a>
</span><span id="baseline_arPLS-22"><a href="#baseline_arPLS-22"><span class="linenos">22</span></a>    <span class="n">H</span> <span class="o">=</span> <span class="n">lam</span> <span class="o">*</span> <span class="n">D</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>  <span class="c1"># The transposes are flipped w.r.t the Algorithm on pg. 252</span>
</span><span id="baseline_arPLS-23"><a href="#baseline_arPLS-23"><span class="linenos">23</span></a>
</span><span id="baseline_arPLS-24"><a href="#baseline_arPLS-24"><span class="linenos">24</span></a>    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</span><span id="baseline_arPLS-25"><a href="#baseline_arPLS-25"><span class="linenos">25</span></a>    <span class="n">W</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">spdiags</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
</span><span id="baseline_arPLS-26"><a href="#baseline_arPLS-26"><span class="linenos">26</span></a>
</span><span id="baseline_arPLS-27"><a href="#baseline_arPLS-27"><span class="linenos">27</span></a>    <span class="n">crit</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="baseline_arPLS-28"><a href="#baseline_arPLS-28"><span class="linenos">28</span></a>    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="baseline_arPLS-29"><a href="#baseline_arPLS-29"><span class="linenos">29</span></a>
</span><span id="baseline_arPLS-30"><a href="#baseline_arPLS-30"><span class="linenos">30</span></a>    <span class="k">while</span> <span class="n">crit</span> <span class="o">&gt;</span> <span class="n">ratio</span><span class="p">:</span>
</span><span id="baseline_arPLS-31"><a href="#baseline_arPLS-31"><span class="linenos">31</span></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">spsolve</span><span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="n">H</span><span class="p">,</span> <span class="n">W</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
</span><span id="baseline_arPLS-32"><a href="#baseline_arPLS-32"><span class="linenos">32</span></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">z</span>
</span><span id="baseline_arPLS-33"><a href="#baseline_arPLS-33"><span class="linenos">33</span></a>        <span class="n">dn</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="baseline_arPLS-34"><a href="#baseline_arPLS-34"><span class="linenos">34</span></a>
</span><span id="baseline_arPLS-35"><a href="#baseline_arPLS-35"><span class="linenos">35</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dn</span><span class="p">)</span>
</span><span id="baseline_arPLS-36"><a href="#baseline_arPLS-36"><span class="linenos">36</span></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dn</span><span class="p">)</span>
</span><span id="baseline_arPLS-37"><a href="#baseline_arPLS-37"><span class="linenos">37</span></a>
</span><span id="baseline_arPLS-38"><a href="#baseline_arPLS-38"><span class="linenos">38</span></a>        <span class="n">w_new</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">s</span> <span class="o">-</span> <span class="n">m</span><span class="p">))</span> <span class="o">/</span> <span class="n">s</span><span class="p">))</span>
</span><span id="baseline_arPLS-39"><a href="#baseline_arPLS-39"><span class="linenos">39</span></a>
</span><span id="baseline_arPLS-40"><a href="#baseline_arPLS-40"><span class="linenos">40</span></a>        <span class="n">crit</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">w_new</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
</span><span id="baseline_arPLS-41"><a href="#baseline_arPLS-41"><span class="linenos">41</span></a>
</span><span id="baseline_arPLS-42"><a href="#baseline_arPLS-42"><span class="linenos">42</span></a>        <span class="n">w</span> <span class="o">=</span> <span class="n">w_new</span>
</span><span id="baseline_arPLS-43"><a href="#baseline_arPLS-43"><span class="linenos">43</span></a>        <span class="n">W</span><span class="o">.</span><span class="n">setdiag</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>  <span class="c1"># Do not create a new matrix, just update diagonal values</span>
</span><span id="baseline_arPLS-44"><a href="#baseline_arPLS-44"><span class="linenos">44</span></a>
</span><span id="baseline_arPLS-45"><a href="#baseline_arPLS-45"><span class="linenos">45</span></a>        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="baseline_arPLS-46"><a href="#baseline_arPLS-46"><span class="linenos">46</span></a>
</span><span id="baseline_arPLS-47"><a href="#baseline_arPLS-47"><span class="linenos">47</span></a>        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="n">niter</span><span class="p">:</span>
</span><span id="baseline_arPLS-48"><a href="#baseline_arPLS-48"><span class="linenos">48</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum number of iterations exceeded&quot;</span><span class="p">)</span>
</span><span id="baseline_arPLS-49"><a href="#baseline_arPLS-49"><span class="linenos">49</span></a>            <span class="k">break</span>
</span><span id="baseline_arPLS-50"><a href="#baseline_arPLS-50"><span class="linenos">50</span></a>
</span><span id="baseline_arPLS-51"><a href="#baseline_arPLS-51"><span class="linenos">51</span></a>    <span class="k">if</span> <span class="n">full_output</span><span class="p">:</span>
</span><span id="baseline_arPLS-52"><a href="#baseline_arPLS-52"><span class="linenos">52</span></a>        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;num_iter&quot;</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span> <span class="s2">&quot;stop_criterion&quot;</span><span class="p">:</span> <span class="n">crit</span><span class="p">}</span>
</span><span id="baseline_arPLS-53"><a href="#baseline_arPLS-53"><span class="linenos">53</span></a>        <span class="k">return</span> <span class="n">z</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">info</span>
</span><span id="baseline_arPLS-54"><a href="#baseline_arPLS-54"><span class="linenos">54</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="baseline_arPLS-55"><a href="#baseline_arPLS-55"><span class="linenos">55</span></a>        <span class="k">return</span> <span class="n">z</span>
</span></pre></div>


    

                </section>
                <section id="FsaFile">
                            <input id="FsaFile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FsaFile</span>:

                <label class="view-source-button" for="FsaFile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FsaFile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FsaFile-10"><a href="#FsaFile-10"><span class="linenos">10</span></a><span class="k">class</span> <span class="nc">FsaFile</span><span class="p">:</span>
</span><span id="FsaFile-11"><a href="#FsaFile-11"><span class="linenos">11</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FsaFile-12"><a href="#FsaFile-12"><span class="linenos">12</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FsaFile-13"><a href="#FsaFile-13"><span class="linenos">13</span></a>        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FsaFile-14"><a href="#FsaFile-14"><span class="linenos">14</span></a>        <span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FsaFile-15"><a href="#FsaFile-15"><span class="linenos">15</span></a>        <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FsaFile-16"><a href="#FsaFile-16"><span class="linenos">16</span></a>        <span class="n">trace_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;DATA1&quot;</span><span class="p">,</span>
</span><span id="FsaFile-17"><a href="#FsaFile-17"><span class="linenos">17</span></a>        <span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FsaFile-18"><a href="#FsaFile-18"><span class="linenos">18</span></a>        <span class="n">min_interpeak_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FsaFile-19"><a href="#FsaFile-19"><span class="linenos">19</span></a>        <span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FsaFile-20"><a href="#FsaFile-20"><span class="linenos">20</span></a>        <span class="n">max_ladder_trace_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FsaFile-21"><a href="#FsaFile-21"><span class="linenos">21</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FsaFile-22"><a href="#FsaFile-22"><span class="linenos">22</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FsaFile-23"><a href="#FsaFile-23"><span class="linenos">23</span></a><span class="sd">        Constructs an FsaFile object with the given parameters.</span>
</span><span id="FsaFile-24"><a href="#FsaFile-24"><span class="linenos">24</span></a>
</span><span id="FsaFile-25"><a href="#FsaFile-25"><span class="linenos">25</span></a><span class="sd">        Args:</span>
</span><span id="FsaFile-26"><a href="#FsaFile-26"><span class="linenos">26</span></a><span class="sd">            file (str): The path to the sequencing file.</span>
</span><span id="FsaFile-27"><a href="#FsaFile-27"><span class="linenos">27</span></a><span class="sd">            ladder (str): The name of the ladder used for sequencing.</span>
</span><span id="FsaFile-28"><a href="#FsaFile-28"><span class="linenos">28</span></a><span class="sd">            normalize (bool): Whether to normalize the data using the arPLS algorithm.</span>
</span><span id="FsaFile-29"><a href="#FsaFile-29"><span class="linenos">29</span></a><span class="sd">            trace_channel (str): The channel to extract the trace data from.</span>
</span><span id="FsaFile-30"><a href="#FsaFile-30"><span class="linenos">30</span></a><span class="sd">            size_standard_channel (str): The channel to extract the size standard data from.</span>
</span><span id="FsaFile-31"><a href="#FsaFile-31"><span class="linenos">31</span></a><span class="sd">            min_interpeak_distance (int): The minimum distance between peaks in the ladder.</span>
</span><span id="FsaFile-32"><a href="#FsaFile-32"><span class="linenos">32</span></a><span class="sd">            min_height (int): The minimum height of peaks in the ladder.</span>
</span><span id="FsaFile-33"><a href="#FsaFile-33"><span class="linenos">33</span></a><span class="sd">            max_ladder_trace_distance (int): The maximum distance between the ladder and the trace.</span>
</span><span id="FsaFile-34"><a href="#FsaFile-34"><span class="linenos">34</span></a>
</span><span id="FsaFile-35"><a href="#FsaFile-35"><span class="linenos">35</span></a><span class="sd">        Returns:</span>
</span><span id="FsaFile-36"><a href="#FsaFile-36"><span class="linenos">36</span></a><span class="sd">            None</span>
</span><span id="FsaFile-37"><a href="#FsaFile-37"><span class="linenos">37</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FsaFile-38"><a href="#FsaFile-38"><span class="linenos">38</span></a>        <span class="n">peak_count_padding</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="FsaFile-39"><a href="#FsaFile-39"><span class="linenos">39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="FsaFile-40"><a href="#FsaFile-40"><span class="linenos">40</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FsaFile-41"><a href="#FsaFile-41"><span class="linenos">41</span></a>
</span><span id="FsaFile-42"><a href="#FsaFile-42"><span class="linenos">42</span></a>        <span class="c1"># Extract data from the sequencing file</span>
</span><span id="FsaFile-43"><a href="#FsaFile-43"><span class="linenos">43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fsa</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;abi&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;abif_raw&quot;</span><span class="p">]</span>
</span><span id="FsaFile-44"><a href="#FsaFile-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ladder</span> <span class="o">=</span> <span class="n">ladder</span>
</span><span id="FsaFile-45"><a href="#FsaFile-45"><span class="linenos">45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trace_channel</span> <span class="o">=</span> <span class="n">trace_channel</span>
</span><span id="FsaFile-46"><a href="#FsaFile-46"><span class="linenos">46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
</span><span id="FsaFile-47"><a href="#FsaFile-47"><span class="linenos">47</span></a>
</span><span id="FsaFile-48"><a href="#FsaFile-48"><span class="linenos">48</span></a>        <span class="c1"># Extract data from the ladder reference</span>
</span><span id="FsaFile-49"><a href="#FsaFile-49"><span class="linenos">49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ref_sizes</span> <span class="o">=</span> <span class="n">LADDERS</span><span class="p">[</span><span class="n">ladder</span><span class="p">][</span><span class="s2">&quot;sizes&quot;</span><span class="p">]</span>
</span><span id="FsaFile-50"><a href="#FsaFile-50"><span class="linenos">50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ref_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_sizes</span><span class="o">.</span><span class="n">size</span>
</span><span id="FsaFile-51"><a href="#FsaFile-51"><span class="linenos">51</span></a>
</span><span id="FsaFile-52"><a href="#FsaFile-52"><span class="linenos">52</span></a>        <span class="c1"># Use default values if necessary</span>
</span><span id="FsaFile-53"><a href="#FsaFile-53"><span class="linenos">53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size_standard_channel</span> <span class="o">=</span> <span class="n">size_standard_channel</span> <span class="ow">or</span> <span class="n">LADDERS</span><span class="p">[</span><span class="n">ladder</span><span class="p">][</span><span class="s2">&quot;channel&quot;</span><span class="p">]</span>
</span><span id="FsaFile-54"><a href="#FsaFile-54"><span class="linenos">54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_interpeak_distance</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FsaFile-55"><a href="#FsaFile-55"><span class="linenos">55</span></a>            <span class="n">min_interpeak_distance</span> <span class="ow">or</span> <span class="n">LADDERS</span><span class="p">[</span><span class="n">ladder</span><span class="p">][</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span>
</span><span id="FsaFile-56"><a href="#FsaFile-56"><span class="linenos">56</span></a>        <span class="p">)</span>
</span><span id="FsaFile-57"><a href="#FsaFile-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_height</span> <span class="o">=</span> <span class="n">min_height</span> <span class="ow">or</span> <span class="n">LADDERS</span><span class="p">[</span><span class="n">ladder</span><span class="p">][</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
</span><span id="FsaFile-58"><a href="#FsaFile-58"><span class="linenos">58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_ladder_trace_distance</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FsaFile-59"><a href="#FsaFile-59"><span class="linenos">59</span></a>            <span class="n">max_ladder_trace_distance</span> <span class="ow">or</span> <span class="n">LADDERS</span><span class="p">[</span><span class="n">ladder</span><span class="p">][</span><span class="s2">&quot;max_ladder_trace_distance&quot;</span><span class="p">]</span>
</span><span id="FsaFile-60"><a href="#FsaFile-60"><span class="linenos">60</span></a>        <span class="p">)</span>
</span><span id="FsaFile-61"><a href="#FsaFile-61"><span class="linenos">61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_peak_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_count</span> <span class="o">+</span> <span class="n">peak_count_padding</span>
</span><span id="FsaFile-62"><a href="#FsaFile-62"><span class="linenos">62</span></a>
</span><span id="FsaFile-63"><a href="#FsaFile-63"><span class="linenos">63</span></a>        <span class="c1"># Normalize data if requested</span>
</span><span id="FsaFile-64"><a href="#FsaFile-64"><span class="linenos">64</span></a>        <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
</span><span id="FsaFile-65"><a href="#FsaFile-65"><span class="linenos">65</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">size_standard</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="FsaFile-66"><a href="#FsaFile-66"><span class="linenos">66</span></a>                <span class="n">baseline_arPLS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">size_standard_channel</span><span class="p">])</span>
</span><span id="FsaFile-67"><a href="#FsaFile-67"><span class="linenos">67</span></a>            <span class="p">)</span>
</span><span id="FsaFile-68"><a href="#FsaFile-68"><span class="linenos">68</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baseline_arPLS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="n">trace_channel</span><span class="p">]))</span>
</span><span id="FsaFile-69"><a href="#FsaFile-69"><span class="linenos">69</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FsaFile-70"><a href="#FsaFile-70"><span class="linenos">70</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">size_standard</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">size_standard_channel</span><span class="p">])</span>
</span><span id="FsaFile-71"><a href="#FsaFile-71"><span class="linenos">71</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="n">trace_channel</span><span class="p">])</span>
</span><span id="FsaFile-72"><a href="#FsaFile-72"><span class="linenos">72</span></a>
</span><span id="FsaFile-73"><a href="#FsaFile-73"><span class="linenos">73</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FsaFile-74"><a href="#FsaFile-74"><span class="linenos">74</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FsaFile-75"><a href="#FsaFile-75"><span class="linenos">75</span></a><span class="sd">        Returns a string representation of the FsaFile object.</span>
</span><span id="FsaFile-76"><a href="#FsaFile-76"><span class="linenos">76</span></a>
</span><span id="FsaFile-77"><a href="#FsaFile-77"><span class="linenos">77</span></a><span class="sd">        Returns:</span>
</span><span id="FsaFile-78"><a href="#FsaFile-78"><span class="linenos">78</span></a><span class="sd">            str: A string representation of the object.</span>
</span><span id="FsaFile-79"><a href="#FsaFile-79"><span class="linenos">79</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FsaFile-80"><a href="#FsaFile-80"><span class="linenos">80</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="FsaFile-81"><a href="#FsaFile-81"><span class="linenos">81</span></a><span class="s2">            FsaFile-object with following parameters:</span>
</span><span id="FsaFile-82"><a href="#FsaFile-82"><span class="linenos">82</span></a><span class="s2">            </span>
</span><span id="FsaFile-83"><a href="#FsaFile-83"><span class="linenos">83</span></a><span class="s2">            File: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="si">}</span>
</span><span id="FsaFile-84"><a href="#FsaFile-84"><span class="linenos">84</span></a><span class="s2">            Filename: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="si">}</span>
</span><span id="FsaFile-85"><a href="#FsaFile-85"><span class="linenos">85</span></a><span class="s2">            Size standard channel: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size_standard_channel</span><span class="si">}</span>
</span><span id="FsaFile-86"><a href="#FsaFile-86"><span class="linenos">86</span></a><span class="s2">            Ladder name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ladder</span><span class="si">}</span>
</span><span id="FsaFile-87"><a href="#FsaFile-87"><span class="linenos">87</span></a><span class="s2">            Number of ladder steps: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_count</span><span class="si">}</span>
</span><span id="FsaFile-88"><a href="#FsaFile-88"><span class="linenos">88</span></a><span class="s2">            Minimum interpeak distance: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_interpeak_distance</span><span class="si">}</span>
</span><span id="FsaFile-89"><a href="#FsaFile-89"><span class="linenos">89</span></a><span class="s2">            Minimum height: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min_height</span><span class="si">}</span>
</span><span id="FsaFile-90"><a href="#FsaFile-90"><span class="linenos">90</span></a><span class="s2">            Minimum Ladder trace distance: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_ladder_trace_distance</span><span class="si">}</span>
</span><span id="FsaFile-91"><a href="#FsaFile-91"><span class="linenos">91</span></a><span class="s2">            Maximum peak count: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_peak_count</span><span class="si">}</span>
</span><span id="FsaFile-92"><a href="#FsaFile-92"><span class="linenos">92</span></a><span class="s2">            Normalized data: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="si">}</span>
</span><span id="FsaFile-93"><a href="#FsaFile-93"><span class="linenos">93</span></a><span class="s2">            Trace Channel: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">trace_channel</span><span class="si">}</span>
</span><span id="FsaFile-94"><a href="#FsaFile-94"><span class="linenos">94</span></a><span class="s2">            Ladder Sizes: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_sizes</span><span class="si">}</span>
</span><span id="FsaFile-95"><a href="#FsaFile-95"><span class="linenos">95</span></a><span class="s2">            &quot;&quot;&quot;</span>
</span></pre></div>


    

                            <div id="FsaFile.__init__" class="classattr">
                                        <input id="FsaFile.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">FsaFile</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">file</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">trace_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;DATA1&#39;</span>,</span><span class="param">	<span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">min_interpeak_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">max_ladder_trace_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="FsaFile.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FsaFile.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FsaFile.__init__-11"><a href="#FsaFile.__init__-11"><span class="linenos">11</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FsaFile.__init__-12"><a href="#FsaFile.__init__-12"><span class="linenos">12</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FsaFile.__init__-13"><a href="#FsaFile.__init__-13"><span class="linenos">13</span></a>        <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FsaFile.__init__-14"><a href="#FsaFile.__init__-14"><span class="linenos">14</span></a>        <span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="FsaFile.__init__-15"><a href="#FsaFile.__init__-15"><span class="linenos">15</span></a>        <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="FsaFile.__init__-16"><a href="#FsaFile.__init__-16"><span class="linenos">16</span></a>        <span class="n">trace_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;DATA1&quot;</span><span class="p">,</span>
</span><span id="FsaFile.__init__-17"><a href="#FsaFile.__init__-17"><span class="linenos">17</span></a>        <span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FsaFile.__init__-18"><a href="#FsaFile.__init__-18"><span class="linenos">18</span></a>        <span class="n">min_interpeak_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FsaFile.__init__-19"><a href="#FsaFile.__init__-19"><span class="linenos">19</span></a>        <span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FsaFile.__init__-20"><a href="#FsaFile.__init__-20"><span class="linenos">20</span></a>        <span class="n">max_ladder_trace_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FsaFile.__init__-21"><a href="#FsaFile.__init__-21"><span class="linenos">21</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FsaFile.__init__-22"><a href="#FsaFile.__init__-22"><span class="linenos">22</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FsaFile.__init__-23"><a href="#FsaFile.__init__-23"><span class="linenos">23</span></a><span class="sd">        Constructs an FsaFile object with the given parameters.</span>
</span><span id="FsaFile.__init__-24"><a href="#FsaFile.__init__-24"><span class="linenos">24</span></a>
</span><span id="FsaFile.__init__-25"><a href="#FsaFile.__init__-25"><span class="linenos">25</span></a><span class="sd">        Args:</span>
</span><span id="FsaFile.__init__-26"><a href="#FsaFile.__init__-26"><span class="linenos">26</span></a><span class="sd">            file (str): The path to the sequencing file.</span>
</span><span id="FsaFile.__init__-27"><a href="#FsaFile.__init__-27"><span class="linenos">27</span></a><span class="sd">            ladder (str): The name of the ladder used for sequencing.</span>
</span><span id="FsaFile.__init__-28"><a href="#FsaFile.__init__-28"><span class="linenos">28</span></a><span class="sd">            normalize (bool): Whether to normalize the data using the arPLS algorithm.</span>
</span><span id="FsaFile.__init__-29"><a href="#FsaFile.__init__-29"><span class="linenos">29</span></a><span class="sd">            trace_channel (str): The channel to extract the trace data from.</span>
</span><span id="FsaFile.__init__-30"><a href="#FsaFile.__init__-30"><span class="linenos">30</span></a><span class="sd">            size_standard_channel (str): The channel to extract the size standard data from.</span>
</span><span id="FsaFile.__init__-31"><a href="#FsaFile.__init__-31"><span class="linenos">31</span></a><span class="sd">            min_interpeak_distance (int): The minimum distance between peaks in the ladder.</span>
</span><span id="FsaFile.__init__-32"><a href="#FsaFile.__init__-32"><span class="linenos">32</span></a><span class="sd">            min_height (int): The minimum height of peaks in the ladder.</span>
</span><span id="FsaFile.__init__-33"><a href="#FsaFile.__init__-33"><span class="linenos">33</span></a><span class="sd">            max_ladder_trace_distance (int): The maximum distance between the ladder and the trace.</span>
</span><span id="FsaFile.__init__-34"><a href="#FsaFile.__init__-34"><span class="linenos">34</span></a>
</span><span id="FsaFile.__init__-35"><a href="#FsaFile.__init__-35"><span class="linenos">35</span></a><span class="sd">        Returns:</span>
</span><span id="FsaFile.__init__-36"><a href="#FsaFile.__init__-36"><span class="linenos">36</span></a><span class="sd">            None</span>
</span><span id="FsaFile.__init__-37"><a href="#FsaFile.__init__-37"><span class="linenos">37</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FsaFile.__init__-38"><a href="#FsaFile.__init__-38"><span class="linenos">38</span></a>        <span class="n">peak_count_padding</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="FsaFile.__init__-39"><a href="#FsaFile.__init__-39"><span class="linenos">39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="FsaFile.__init__-40"><a href="#FsaFile.__init__-40"><span class="linenos">40</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FsaFile.__init__-41"><a href="#FsaFile.__init__-41"><span class="linenos">41</span></a>
</span><span id="FsaFile.__init__-42"><a href="#FsaFile.__init__-42"><span class="linenos">42</span></a>        <span class="c1"># Extract data from the sequencing file</span>
</span><span id="FsaFile.__init__-43"><a href="#FsaFile.__init__-43"><span class="linenos">43</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fsa</span> <span class="o">=</span> <span class="n">SeqIO</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;abi&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;abif_raw&quot;</span><span class="p">]</span>
</span><span id="FsaFile.__init__-44"><a href="#FsaFile.__init__-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ladder</span> <span class="o">=</span> <span class="n">ladder</span>
</span><span id="FsaFile.__init__-45"><a href="#FsaFile.__init__-45"><span class="linenos">45</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trace_channel</span> <span class="o">=</span> <span class="n">trace_channel</span>
</span><span id="FsaFile.__init__-46"><a href="#FsaFile.__init__-46"><span class="linenos">46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
</span><span id="FsaFile.__init__-47"><a href="#FsaFile.__init__-47"><span class="linenos">47</span></a>
</span><span id="FsaFile.__init__-48"><a href="#FsaFile.__init__-48"><span class="linenos">48</span></a>        <span class="c1"># Extract data from the ladder reference</span>
</span><span id="FsaFile.__init__-49"><a href="#FsaFile.__init__-49"><span class="linenos">49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ref_sizes</span> <span class="o">=</span> <span class="n">LADDERS</span><span class="p">[</span><span class="n">ladder</span><span class="p">][</span><span class="s2">&quot;sizes&quot;</span><span class="p">]</span>
</span><span id="FsaFile.__init__-50"><a href="#FsaFile.__init__-50"><span class="linenos">50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ref_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_sizes</span><span class="o">.</span><span class="n">size</span>
</span><span id="FsaFile.__init__-51"><a href="#FsaFile.__init__-51"><span class="linenos">51</span></a>
</span><span id="FsaFile.__init__-52"><a href="#FsaFile.__init__-52"><span class="linenos">52</span></a>        <span class="c1"># Use default values if necessary</span>
</span><span id="FsaFile.__init__-53"><a href="#FsaFile.__init__-53"><span class="linenos">53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">size_standard_channel</span> <span class="o">=</span> <span class="n">size_standard_channel</span> <span class="ow">or</span> <span class="n">LADDERS</span><span class="p">[</span><span class="n">ladder</span><span class="p">][</span><span class="s2">&quot;channel&quot;</span><span class="p">]</span>
</span><span id="FsaFile.__init__-54"><a href="#FsaFile.__init__-54"><span class="linenos">54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_interpeak_distance</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FsaFile.__init__-55"><a href="#FsaFile.__init__-55"><span class="linenos">55</span></a>            <span class="n">min_interpeak_distance</span> <span class="ow">or</span> <span class="n">LADDERS</span><span class="p">[</span><span class="n">ladder</span><span class="p">][</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span>
</span><span id="FsaFile.__init__-56"><a href="#FsaFile.__init__-56"><span class="linenos">56</span></a>        <span class="p">)</span>
</span><span id="FsaFile.__init__-57"><a href="#FsaFile.__init__-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_height</span> <span class="o">=</span> <span class="n">min_height</span> <span class="ow">or</span> <span class="n">LADDERS</span><span class="p">[</span><span class="n">ladder</span><span class="p">][</span><span class="s2">&quot;height&quot;</span><span class="p">]</span>
</span><span id="FsaFile.__init__-58"><a href="#FsaFile.__init__-58"><span class="linenos">58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_ladder_trace_distance</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="FsaFile.__init__-59"><a href="#FsaFile.__init__-59"><span class="linenos">59</span></a>            <span class="n">max_ladder_trace_distance</span> <span class="ow">or</span> <span class="n">LADDERS</span><span class="p">[</span><span class="n">ladder</span><span class="p">][</span><span class="s2">&quot;max_ladder_trace_distance&quot;</span><span class="p">]</span>
</span><span id="FsaFile.__init__-60"><a href="#FsaFile.__init__-60"><span class="linenos">60</span></a>        <span class="p">)</span>
</span><span id="FsaFile.__init__-61"><a href="#FsaFile.__init__-61"><span class="linenos">61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_peak_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref_count</span> <span class="o">+</span> <span class="n">peak_count_padding</span>
</span><span id="FsaFile.__init__-62"><a href="#FsaFile.__init__-62"><span class="linenos">62</span></a>
</span><span id="FsaFile.__init__-63"><a href="#FsaFile.__init__-63"><span class="linenos">63</span></a>        <span class="c1"># Normalize data if requested</span>
</span><span id="FsaFile.__init__-64"><a href="#FsaFile.__init__-64"><span class="linenos">64</span></a>        <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
</span><span id="FsaFile.__init__-65"><a href="#FsaFile.__init__-65"><span class="linenos">65</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">size_standard</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="FsaFile.__init__-66"><a href="#FsaFile.__init__-66"><span class="linenos">66</span></a>                <span class="n">baseline_arPLS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">size_standard_channel</span><span class="p">])</span>
</span><span id="FsaFile.__init__-67"><a href="#FsaFile.__init__-67"><span class="linenos">67</span></a>            <span class="p">)</span>
</span><span id="FsaFile.__init__-68"><a href="#FsaFile.__init__-68"><span class="linenos">68</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baseline_arPLS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="n">trace_channel</span><span class="p">]))</span>
</span><span id="FsaFile.__init__-69"><a href="#FsaFile.__init__-69"><span class="linenos">69</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FsaFile.__init__-70"><a href="#FsaFile.__init__-70"><span class="linenos">70</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">size_standard</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">size_standard_channel</span><span class="p">])</span>
</span><span id="FsaFile.__init__-71"><a href="#FsaFile.__init__-71"><span class="linenos">71</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">trace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="n">trace_channel</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Constructs an FsaFile object with the given parameters.</p>

<p>Args:
    file (str): The path to the sequencing file.
    ladder (str): The name of the ladder used for sequencing.
    normalize (bool): Whether to normalize the data using the arPLS algorithm.
    trace_channel (str): The channel to extract the trace data from.
    size_standard_channel (str): The channel to extract the size standard data from.
    min_interpeak_distance (int): The minimum distance between peaks in the ladder.
    min_height (int): The minimum height of peaks in the ladder.
    max_ladder_trace_distance (int): The maximum distance between the ladder and the trace.</p>

<p>Returns:
    None</p>
</div>


                            </div>
                            <div id="FsaFile.file" class="classattr">
                                <div class="attr variable">
            <span class="name">file</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.file"></a>
    
    

                            </div>
                            <div id="FsaFile.file_name" class="classattr">
                                <div class="attr variable">
            <span class="name">file_name</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.file_name"></a>
    
    

                            </div>
                            <div id="FsaFile.fsa" class="classattr">
                                <div class="attr variable">
            <span class="name">fsa</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.fsa"></a>
    
    

                            </div>
                            <div id="FsaFile.ladder" class="classattr">
                                <div class="attr variable">
            <span class="name">ladder</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.ladder"></a>
    
    

                            </div>
                            <div id="FsaFile.trace_channel" class="classattr">
                                <div class="attr variable">
            <span class="name">trace_channel</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.trace_channel"></a>
    
    

                            </div>
                            <div id="FsaFile.normalize" class="classattr">
                                <div class="attr variable">
            <span class="name">normalize</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.normalize"></a>
    
    

                            </div>
                            <div id="FsaFile.ref_sizes" class="classattr">
                                <div class="attr variable">
            <span class="name">ref_sizes</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.ref_sizes"></a>
    
    

                            </div>
                            <div id="FsaFile.ref_count" class="classattr">
                                <div class="attr variable">
            <span class="name">ref_count</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.ref_count"></a>
    
    

                            </div>
                            <div id="FsaFile.size_standard_channel" class="classattr">
                                <div class="attr variable">
            <span class="name">size_standard_channel</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.size_standard_channel"></a>
    
    

                            </div>
                            <div id="FsaFile.min_interpeak_distance" class="classattr">
                                <div class="attr variable">
            <span class="name">min_interpeak_distance</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.min_interpeak_distance"></a>
    
    

                            </div>
                            <div id="FsaFile.min_height" class="classattr">
                                <div class="attr variable">
            <span class="name">min_height</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.min_height"></a>
    
    

                            </div>
                            <div id="FsaFile.max_ladder_trace_distance" class="classattr">
                                <div class="attr variable">
            <span class="name">max_ladder_trace_distance</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.max_ladder_trace_distance"></a>
    
    

                            </div>
                            <div id="FsaFile.max_peak_count" class="classattr">
                                <div class="attr variable">
            <span class="name">max_peak_count</span>

        
    </div>
    <a class="headerlink" href="#FsaFile.max_peak_count"></a>
    
    

                            </div>
                </section>
                <section id="PeakArea">
                    <div class="attr variable">
            <span class="name">PeakArea</span>

        
    </div>
    <a class="headerlink" href="#PeakArea"></a>
    
    

                </section>
                <section id="PeakAreaDeMultiplex">
                            <input id="PeakAreaDeMultiplex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PeakAreaDeMultiplex</span>:

                <label class="view-source-button" for="PeakAreaDeMultiplex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex-25"><a href="#PeakAreaDeMultiplex-25"><span class="linenos"> 25</span></a><span class="k">class</span> <span class="nc">PeakAreaDeMultiplex</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-26"><a href="#PeakAreaDeMultiplex-26"><span class="linenos"> 26</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-27"><a href="#PeakAreaDeMultiplex-27"><span class="linenos"> 27</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-28"><a href="#PeakAreaDeMultiplex-28"><span class="linenos"> 28</span></a>        <span class="n">peaks</span><span class="p">:</span> <span class="n">PeakFinder</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-29"><a href="#PeakAreaDeMultiplex-29"><span class="linenos"> 29</span></a>        <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-30"><a href="#PeakAreaDeMultiplex-30"><span class="linenos"> 30</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-31"><a href="#PeakAreaDeMultiplex-31"><span class="linenos"> 31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span> <span class="o">=</span> <span class="n">peaks</span>
</span><span id="PeakAreaDeMultiplex-32"><a href="#PeakAreaDeMultiplex-32"><span class="linenos"> 32</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span> <span class="ow">or</span> <span class="kc">None</span>
</span><span id="PeakAreaDeMultiplex-33"><a href="#PeakAreaDeMultiplex-33"><span class="linenos"> 33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peaks_dataframe</span>
</span><span id="PeakAreaDeMultiplex-34"><a href="#PeakAreaDeMultiplex-34"><span class="linenos"> 34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span>
</span><span id="PeakAreaDeMultiplex-35"><a href="#PeakAreaDeMultiplex-35"><span class="linenos"> 35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">file_name</span>
</span><span id="PeakAreaDeMultiplex-36"><a href="#PeakAreaDeMultiplex-36"><span class="linenos"> 36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peaks_index</span>
</span><span id="PeakAreaDeMultiplex-37"><a href="#PeakAreaDeMultiplex-37"><span class="linenos"> 37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">found_peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">found_peaks</span>
</span><span id="PeakAreaDeMultiplex-38"><a href="#PeakAreaDeMultiplex-38"><span class="linenos"> 38</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area_plots</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex-39"><a href="#PeakAreaDeMultiplex-39"><span class="linenos"> 39</span></a>
</span><span id="PeakAreaDeMultiplex-40"><a href="#PeakAreaDeMultiplex-40"><span class="linenos"> 40</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_peak_widths</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-41"><a href="#PeakAreaDeMultiplex-41"><span class="linenos"> 41</span></a>        <span class="c1"># divade peaks based on their assay they belonging</span>
</span><span id="PeakAreaDeMultiplex-42"><a href="#PeakAreaDeMultiplex-42"><span class="linenos"> 42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">divided_assays</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divide_peak_assays</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-43"><a href="#PeakAreaDeMultiplex-43"><span class="linenos"> 43</span></a>        <span class="c1"># how many assays does this sample contain?</span>
</span><span id="PeakAreaDeMultiplex-44"><a href="#PeakAreaDeMultiplex-44"><span class="linenos"> 44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_assays</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">divided_assays</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-45"><a href="#PeakAreaDeMultiplex-45"><span class="linenos"> 45</span></a>        <span class="c1"># divide all peaks in each assay into separate dataframes</span>
</span><span id="PeakAreaDeMultiplex-46"><a href="#PeakAreaDeMultiplex-46"><span class="linenos"> 46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">divided_peaks</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">divide_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divided_assays</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex-47"><a href="#PeakAreaDeMultiplex-47"><span class="linenos"> 47</span></a>        <span class="c1"># logging</span>
</span><span id="PeakAreaDeMultiplex-48"><a href="#PeakAreaDeMultiplex-48"><span class="linenos"> 48</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-49"><a href="#PeakAreaDeMultiplex-49"><span class="linenos"> 49</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-50"><a href="#PeakAreaDeMultiplex-50"><span class="linenos"> 50</span></a><span class="s2">        Number of assays found: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_assays</span><span class="si">}</span>
</span><span id="PeakAreaDeMultiplex-51"><a href="#PeakAreaDeMultiplex-51"><span class="linenos"> 51</span></a><span class="s2">        Number of peaks found: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span>
</span><span id="PeakAreaDeMultiplex-52"><a href="#PeakAreaDeMultiplex-52"><span class="linenos"> 52</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-53"><a href="#PeakAreaDeMultiplex-53"><span class="linenos"> 53</span></a>        <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-54"><a href="#PeakAreaDeMultiplex-54"><span class="linenos"> 54</span></a>
</span><span id="PeakAreaDeMultiplex-55"><a href="#PeakAreaDeMultiplex-55"><span class="linenos"> 55</span></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex-56"><a href="#PeakAreaDeMultiplex-56"><span class="linenos"> 56</span></a>        <span class="k">return</span> <span class="n">PeakAreaDeMultiplexIterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_assays</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-57"><a href="#PeakAreaDeMultiplex-57"><span class="linenos"> 57</span></a>
</span><span id="PeakAreaDeMultiplex-58"><a href="#PeakAreaDeMultiplex-58"><span class="linenos"> 58</span></a>    <span class="k">def</span> <span class="nf">find_peak_widths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex-59"><a href="#PeakAreaDeMultiplex-59"><span class="linenos"> 59</span></a>        <span class="n">widths</span> <span class="o">=</span> <span class="n">peak_widths</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-60"><a href="#PeakAreaDeMultiplex-60"><span class="linenos"> 60</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-61"><a href="#PeakAreaDeMultiplex-61"><span class="linenos"> 61</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks_index</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-62"><a href="#PeakAreaDeMultiplex-62"><span class="linenos"> 62</span></a>            <span class="n">rel_height</span><span class="o">=</span><span class="n">rel_height</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-63"><a href="#PeakAreaDeMultiplex-63"><span class="linenos"> 63</span></a>        <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-64"><a href="#PeakAreaDeMultiplex-64"><span class="linenos"> 64</span></a>
</span><span id="PeakAreaDeMultiplex-65"><a href="#PeakAreaDeMultiplex-65"><span class="linenos"> 65</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">widths</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PeakAreaDeMultiplex-66"><a href="#PeakAreaDeMultiplex-66"><span class="linenos"> 66</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;peak_height&quot;</span><span class="p">,</span> <span class="s2">&quot;peak_start&quot;</span><span class="p">,</span> <span class="s2">&quot;peak_end&quot;</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex-67"><a href="#PeakAreaDeMultiplex-67"><span class="linenos"> 67</span></a>
</span><span id="PeakAreaDeMultiplex-68"><a href="#PeakAreaDeMultiplex-68"><span class="linenos"> 68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_widths</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-69"><a href="#PeakAreaDeMultiplex-69"><span class="linenos"> 69</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_start</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">peak_start</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
</span><span id="PeakAreaDeMultiplex-70"><a href="#PeakAreaDeMultiplex-70"><span class="linenos"> 70</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_end</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">peak_end</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
</span><span id="PeakAreaDeMultiplex-71"><a href="#PeakAreaDeMultiplex-71"><span class="linenos"> 71</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="PeakAreaDeMultiplex-72"><a href="#PeakAreaDeMultiplex-72"><span class="linenos"> 72</span></a>            <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;peak_name&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-73"><a href="#PeakAreaDeMultiplex-73"><span class="linenos"> 73</span></a>        <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-74"><a href="#PeakAreaDeMultiplex-74"><span class="linenos"> 74</span></a>
</span><span id="PeakAreaDeMultiplex-75"><a href="#PeakAreaDeMultiplex-75"><span class="linenos"> 75</span></a>    <span class="k">def</span> <span class="nf">divide_peak_assays</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="PeakAreaDeMultiplex-76"><a href="#PeakAreaDeMultiplex-76"><span class="linenos"> 76</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-77"><a href="#PeakAreaDeMultiplex-77"><span class="linenos"> 77</span></a><span class="sd">        Divide the peaks belonging to different assays based on their assay number</span>
</span><span id="PeakAreaDeMultiplex-78"><a href="#PeakAreaDeMultiplex-78"><span class="linenos"> 78</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-79"><a href="#PeakAreaDeMultiplex-79"><span class="linenos"> 79</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_widths</span>
</span><span id="PeakAreaDeMultiplex-80"><a href="#PeakAreaDeMultiplex-80"><span class="linenos"> 80</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">assay</span> <span class="o">==</span> <span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">assay</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>
</span><span id="PeakAreaDeMultiplex-81"><a href="#PeakAreaDeMultiplex-81"><span class="linenos"> 81</span></a>
</span><span id="PeakAreaDeMultiplex-82"><a href="#PeakAreaDeMultiplex-82"><span class="linenos"> 82</span></a>    <span class="k">def</span> <span class="nf">divide_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assay</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">padding</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="PeakAreaDeMultiplex-83"><a href="#PeakAreaDeMultiplex-83"><span class="linenos"> 83</span></a>        <span class="c1"># add some padding to the left and right to be sure to include everything in the peak</span>
</span><span id="PeakAreaDeMultiplex-84"><a href="#PeakAreaDeMultiplex-84"><span class="linenos"> 84</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="PeakAreaDeMultiplex-85"><a href="#PeakAreaDeMultiplex-85"><span class="linenos"> 85</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">peak_start</span> <span class="o">-</span> <span class="n">padding</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peak_end</span> <span class="o">+</span> <span class="n">padding</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex-86"><a href="#PeakAreaDeMultiplex-86"><span class="linenos"> 86</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">assay</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-87"><a href="#PeakAreaDeMultiplex-87"><span class="linenos"> 87</span></a>        <span class="p">]</span>
</span><span id="PeakAreaDeMultiplex-88"><a href="#PeakAreaDeMultiplex-88"><span class="linenos"> 88</span></a>
</span><span id="PeakAreaDeMultiplex-89"><a href="#PeakAreaDeMultiplex-89"><span class="linenos"> 89</span></a>    <span class="k">def</span> <span class="nf">fit_lmfit_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex-90"><a href="#PeakAreaDeMultiplex-90"><span class="linenos"> 90</span></a>        <span class="k">if</span> <span class="n">assay_number</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_assays</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-91"><a href="#PeakAreaDeMultiplex-91"><span class="linenos"> 91</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-92"><a href="#PeakAreaDeMultiplex-92"><span class="linenos"> 92</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-93"><a href="#PeakAreaDeMultiplex-93"><span class="linenos"> 93</span></a><span class="s2">                The sample only contains </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_assays</span><span class="si">}</span><span class="s2"> assays. </span>
</span><span id="PeakAreaDeMultiplex-94"><a href="#PeakAreaDeMultiplex-94"><span class="linenos"> 94</span></a><span class="s2">                Use a number inside of the range.</span>
</span><span id="PeakAreaDeMultiplex-95"><a href="#PeakAreaDeMultiplex-95"><span class="linenos"> 95</span></a><span class="s2">                Indexing starts at 0.</span>
</span><span id="PeakAreaDeMultiplex-96"><a href="#PeakAreaDeMultiplex-96"><span class="linenos"> 96</span></a><span class="s2">                &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-97"><a href="#PeakAreaDeMultiplex-97"><span class="linenos"> 97</span></a>            <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-98"><a href="#PeakAreaDeMultiplex-98"><span class="linenos"> 98</span></a>
</span><span id="PeakAreaDeMultiplex-99"><a href="#PeakAreaDeMultiplex-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="n">peak_finding_model</span> <span class="o">==</span> <span class="s2">&quot;gauss&quot;</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-100"><a href="#PeakAreaDeMultiplex-100"><span class="linenos">100</span></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-101"><a href="#PeakAreaDeMultiplex-101"><span class="linenos">101</span></a>        <span class="k">elif</span> <span class="n">peak_finding_model</span> <span class="o">==</span> <span class="s2">&quot;voigt&quot;</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-102"><a href="#PeakAreaDeMultiplex-102"><span class="linenos">102</span></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">VoigtModel</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-103"><a href="#PeakAreaDeMultiplex-103"><span class="linenos">103</span></a>        <span class="k">elif</span> <span class="n">peak_finding_model</span> <span class="o">==</span> <span class="s2">&quot;lorentzian&quot;</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-104"><a href="#PeakAreaDeMultiplex-104"><span class="linenos">104</span></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">LorentzianModel</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-105"><a href="#PeakAreaDeMultiplex-105"><span class="linenos">105</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-106"><a href="#PeakAreaDeMultiplex-106"><span class="linenos">106</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-107"><a href="#PeakAreaDeMultiplex-107"><span class="linenos">107</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-108"><a href="#PeakAreaDeMultiplex-108"><span class="linenos">108</span></a><span class="s2">                </span><span class="si">{</span><span class="n">peak_finding_model</span><span class="si">}</span><span class="s2"> is not implemented! </span>
</span><span id="PeakAreaDeMultiplex-109"><a href="#PeakAreaDeMultiplex-109"><span class="linenos">109</span></a><span class="s2">                Options: [gauss, voigt, lorentzian]</span>
</span><span id="PeakAreaDeMultiplex-110"><a href="#PeakAreaDeMultiplex-110"><span class="linenos">110</span></a><span class="s2">                &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-111"><a href="#PeakAreaDeMultiplex-111"><span class="linenos">111</span></a>            <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-112"><a href="#PeakAreaDeMultiplex-112"><span class="linenos">112</span></a>
</span><span id="PeakAreaDeMultiplex-113"><a href="#PeakAreaDeMultiplex-113"><span class="linenos">113</span></a>        <span class="n">fit_df</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex-114"><a href="#PeakAreaDeMultiplex-114"><span class="linenos">114</span></a>        <span class="n">fit_params</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex-115"><a href="#PeakAreaDeMultiplex-115"><span class="linenos">115</span></a>        <span class="n">fit_report</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex-116"><a href="#PeakAreaDeMultiplex-116"><span class="linenos">116</span></a>        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divided_peaks</span><span class="p">[</span><span class="n">assay_number</span><span class="p">]:</span>
</span><span id="PeakAreaDeMultiplex-117"><a href="#PeakAreaDeMultiplex-117"><span class="linenos">117</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-118"><a href="#PeakAreaDeMultiplex-118"><span class="linenos">118</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-119"><a href="#PeakAreaDeMultiplex-119"><span class="linenos">119</span></a>            <span class="c1"># CHANGED to time instead of basepair</span>
</span><span id="PeakAreaDeMultiplex-120"><a href="#PeakAreaDeMultiplex-120"><span class="linenos">120</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-121"><a href="#PeakAreaDeMultiplex-121"><span class="linenos">121</span></a>
</span><span id="PeakAreaDeMultiplex-122"><a href="#PeakAreaDeMultiplex-122"><span class="linenos">122</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-123"><a href="#PeakAreaDeMultiplex-123"><span class="linenos">123</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-124"><a href="#PeakAreaDeMultiplex-124"><span class="linenos">124</span></a>
</span><span id="PeakAreaDeMultiplex-125"><a href="#PeakAreaDeMultiplex-125"><span class="linenos">125</span></a>            <span class="n">fit_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">fitted</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">peak_finding_model</span><span class="p">))</span>
</span><span id="PeakAreaDeMultiplex-126"><a href="#PeakAreaDeMultiplex-126"><span class="linenos">126</span></a>            <span class="n">fit_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-127"><a href="#PeakAreaDeMultiplex-127"><span class="linenos">127</span></a>            <span class="n">fit_report</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">fit_report</span><span class="p">())</span>
</span><span id="PeakAreaDeMultiplex-128"><a href="#PeakAreaDeMultiplex-128"><span class="linenos">128</span></a>
</span><span id="PeakAreaDeMultiplex-129"><a href="#PeakAreaDeMultiplex-129"><span class="linenos">129</span></a>        <span class="c1"># Update the instances of the model fit</span>
</span><span id="PeakAreaDeMultiplex-130"><a href="#PeakAreaDeMultiplex-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span> <span class="o">=</span> <span class="n">fit_df</span>
</span><span id="PeakAreaDeMultiplex-131"><a href="#PeakAreaDeMultiplex-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span> <span class="o">=</span> <span class="n">fit_params</span>
</span><span id="PeakAreaDeMultiplex-132"><a href="#PeakAreaDeMultiplex-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_report</span> <span class="o">=</span> <span class="n">fit_report</span>
</span><span id="PeakAreaDeMultiplex-133"><a href="#PeakAreaDeMultiplex-133"><span class="linenos">133</span></a>
</span><span id="PeakAreaDeMultiplex-134"><a href="#PeakAreaDeMultiplex-134"><span class="linenos">134</span></a>    <span class="c1"># TODO</span>
</span><span id="PeakAreaDeMultiplex-135"><a href="#PeakAreaDeMultiplex-135"><span class="linenos">135</span></a>    <span class="c1"># Fix so that the cutoff is a range or something else.</span>
</span><span id="PeakAreaDeMultiplex-136"><a href="#PeakAreaDeMultiplex-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">calculate_quotient</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-137"><a href="#PeakAreaDeMultiplex-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-138"><a href="#PeakAreaDeMultiplex-138"><span class="linenos">138</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-139"><a href="#PeakAreaDeMultiplex-139"><span class="linenos">139</span></a>
</span><span id="PeakAreaDeMultiplex-140"><a href="#PeakAreaDeMultiplex-140"><span class="linenos">140</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-141"><a href="#PeakAreaDeMultiplex-141"><span class="linenos">141</span></a><span class="sd">        :Params:</span>
</span><span id="PeakAreaDeMultiplex-142"><a href="#PeakAreaDeMultiplex-142"><span class="linenos">142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-143"><a href="#PeakAreaDeMultiplex-143"><span class="linenos">143</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;amplitude&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">])</span>
</span><span id="PeakAreaDeMultiplex-144"><a href="#PeakAreaDeMultiplex-144"><span class="linenos">144</span></a>
</span><span id="PeakAreaDeMultiplex-145"><a href="#PeakAreaDeMultiplex-145"><span class="linenos">145</span></a>        <span class="n">right_by_left</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-146"><a href="#PeakAreaDeMultiplex-146"><span class="linenos">146</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="PeakAreaDeMultiplex-147"><a href="#PeakAreaDeMultiplex-147"><span class="linenos">147</span></a>            <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">)</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span>
</span><span id="PeakAreaDeMultiplex-148"><a href="#PeakAreaDeMultiplex-148"><span class="linenos">148</span></a>        <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-149"><a href="#PeakAreaDeMultiplex-149"><span class="linenos">149</span></a>        <span class="c1"># if there only is 1 peak, return 0</span>
</span><span id="PeakAreaDeMultiplex-150"><a href="#PeakAreaDeMultiplex-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-151"><a href="#PeakAreaDeMultiplex-151"><span class="linenos">151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">quotient</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PeakAreaDeMultiplex-152"><a href="#PeakAreaDeMultiplex-152"><span class="linenos">152</span></a>            <span class="k">return</span>
</span><span id="PeakAreaDeMultiplex-153"><a href="#PeakAreaDeMultiplex-153"><span class="linenos">153</span></a>
</span><span id="PeakAreaDeMultiplex-154"><a href="#PeakAreaDeMultiplex-154"><span class="linenos">154</span></a>        <span class="c1"># if there only are 2 peaks, return the quotient</span>
</span><span id="PeakAreaDeMultiplex-155"><a href="#PeakAreaDeMultiplex-155"><span class="linenos">155</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-156"><a href="#PeakAreaDeMultiplex-156"><span class="linenos">156</span></a>            <span class="c1"># left peak divided by right peak</span>
</span><span id="PeakAreaDeMultiplex-157"><a href="#PeakAreaDeMultiplex-157"><span class="linenos">157</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">right_by_left</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-158"><a href="#PeakAreaDeMultiplex-158"><span class="linenos">158</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">quotient</span> <span class="o">=</span> <span class="n">areas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">areas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex-159"><a href="#PeakAreaDeMultiplex-159"><span class="linenos">159</span></a>                <span class="k">return</span>
</span><span id="PeakAreaDeMultiplex-160"><a href="#PeakAreaDeMultiplex-160"><span class="linenos">160</span></a>            <span class="c1"># right peak divided by left peak</span>
</span><span id="PeakAreaDeMultiplex-161"><a href="#PeakAreaDeMultiplex-161"><span class="linenos">161</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">quotient</span> <span class="o">=</span> <span class="n">areas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">areas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex-162"><a href="#PeakAreaDeMultiplex-162"><span class="linenos">162</span></a>            <span class="k">return</span>
</span><span id="PeakAreaDeMultiplex-163"><a href="#PeakAreaDeMultiplex-163"><span class="linenos">163</span></a>
</span><span id="PeakAreaDeMultiplex-164"><a href="#PeakAreaDeMultiplex-164"><span class="linenos">164</span></a>        <span class="c1"># return the last peak divided by the mean of the peaks to the left of it</span>
</span><span id="PeakAreaDeMultiplex-165"><a href="#PeakAreaDeMultiplex-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quotient</span> <span class="o">=</span> <span class="n">areas</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">areas</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-166"><a href="#PeakAreaDeMultiplex-166"><span class="linenos">166</span></a>
</span><span id="PeakAreaDeMultiplex-167"><a href="#PeakAreaDeMultiplex-167"><span class="linenos">167</span></a>    <span class="k">def</span> <span class="nf">peak_position_area_dataframe</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-168"><a href="#PeakAreaDeMultiplex-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="PeakAreaDeMultiplex-169"><a href="#PeakAreaDeMultiplex-169"><span class="linenos">169</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-170"><a href="#PeakAreaDeMultiplex-170"><span class="linenos">170</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-171"><a href="#PeakAreaDeMultiplex-171"><span class="linenos">171</span></a><span class="sd">        Returns a DataFrame of each peak and its properties</span>
</span><span id="PeakAreaDeMultiplex-172"><a href="#PeakAreaDeMultiplex-172"><span class="linenos">172</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-173"><a href="#PeakAreaDeMultiplex-173"><span class="linenos">173</span></a>        <span class="n">dataframes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex-174"><a href="#PeakAreaDeMultiplex-174"><span class="linenos">174</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex-175"><a href="#PeakAreaDeMultiplex-175"><span class="linenos">175</span></a>            <span class="n">report</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_report</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex-176"><a href="#PeakAreaDeMultiplex-176"><span class="linenos">176</span></a>            <span class="n">r_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R-squared *= (0\.\d</span><span class="si">{3}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">report</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="PeakAreaDeMultiplex-177"><a href="#PeakAreaDeMultiplex-177"><span class="linenos">177</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-178"><a href="#PeakAreaDeMultiplex-178"><span class="linenos">178</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex-179"><a href="#PeakAreaDeMultiplex-179"><span class="linenos">179</span></a>                <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
</span><span id="PeakAreaDeMultiplex-180"><a href="#PeakAreaDeMultiplex-180"><span class="linenos">180</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">area</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;amplitude&quot;</span><span class="p">])</span>
</span><span id="PeakAreaDeMultiplex-181"><a href="#PeakAreaDeMultiplex-181"><span class="linenos">181</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">r_value</span><span class="o">=</span><span class="n">r_value</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-182"><a href="#PeakAreaDeMultiplex-182"><span class="linenos">182</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Peak </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-183"><a href="#PeakAreaDeMultiplex-183"><span class="linenos">183</span></a>                <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-184"><a href="#PeakAreaDeMultiplex-184"><span class="linenos">184</span></a>                <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-185"><a href="#PeakAreaDeMultiplex-185"><span class="linenos">185</span></a>                <span class="o">.</span><span class="n">rename</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-186"><a href="#PeakAreaDeMultiplex-186"><span class="linenos">186</span></a>                    <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
</span><span id="PeakAreaDeMultiplex-187"><a href="#PeakAreaDeMultiplex-187"><span class="linenos">187</span></a>                        <span class="s2">&quot;peaks&quot;</span><span class="p">:</span> <span class="s2">&quot;peak_height&quot;</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-188"><a href="#PeakAreaDeMultiplex-188"><span class="linenos">188</span></a>                        <span class="s2">&quot;fitted&quot;</span><span class="p">:</span> <span class="s2">&quot;fitted_peak_height&quot;</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-189"><a href="#PeakAreaDeMultiplex-189"><span class="linenos">189</span></a>                    <span class="p">}</span>
</span><span id="PeakAreaDeMultiplex-190"><a href="#PeakAreaDeMultiplex-190"><span class="linenos">190</span></a>                <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-191"><a href="#PeakAreaDeMultiplex-191"><span class="linenos">191</span></a>                <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s2">&quot;peak_name&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-192"><a href="#PeakAreaDeMultiplex-192"><span class="linenos">192</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-193"><a href="#PeakAreaDeMultiplex-193"><span class="linenos">193</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">assay_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-194"><a href="#PeakAreaDeMultiplex-194"><span class="linenos">194</span></a>            <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-195"><a href="#PeakAreaDeMultiplex-195"><span class="linenos">195</span></a>            <span class="n">dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-196"><a href="#PeakAreaDeMultiplex-196"><span class="linenos">196</span></a>
</span><span id="PeakAreaDeMultiplex-197"><a href="#PeakAreaDeMultiplex-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assay_peak_area_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-198"><a href="#PeakAreaDeMultiplex-198"><span class="linenos">198</span></a>            <span class="n">quotient</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotient</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-199"><a href="#PeakAreaDeMultiplex-199"><span class="linenos">199</span></a>            <span class="n">peak_number</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="PeakAreaDeMultiplex-200"><a href="#PeakAreaDeMultiplex-200"><span class="linenos">200</span></a>            <span class="n">assay_number</span><span class="o">=</span><span class="n">assay_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-201"><a href="#PeakAreaDeMultiplex-201"><span class="linenos">201</span></a>        <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-202"><a href="#PeakAreaDeMultiplex-202"><span class="linenos">202</span></a>
</span><span id="PeakAreaDeMultiplex-203"><a href="#PeakAreaDeMultiplex-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">plot_areas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex-204"><a href="#PeakAreaDeMultiplex-204"><span class="linenos">204</span></a>        <span class="n">fig_areas</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-205"><a href="#PeakAreaDeMultiplex-205"><span class="linenos">205</span></a>            <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-206"><a href="#PeakAreaDeMultiplex-206"><span class="linenos">206</span></a>        <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-207"><a href="#PeakAreaDeMultiplex-207"><span class="linenos">207</span></a>        <span class="c1"># if there is only one peak</span>
</span><span id="PeakAreaDeMultiplex-208"><a href="#PeakAreaDeMultiplex-208"><span class="linenos">208</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-209"><a href="#PeakAreaDeMultiplex-209"><span class="linenos">209</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-210"><a href="#PeakAreaDeMultiplex-210"><span class="linenos">210</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fitted</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-211"><a href="#PeakAreaDeMultiplex-211"><span class="linenos">211</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak 1 area: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> .1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-212"><a href="#PeakAreaDeMultiplex-212"><span class="linenos">212</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-213"><a href="#PeakAreaDeMultiplex-213"><span class="linenos">213</span></a>        <span class="c1"># if more than one peak</span>
</span><span id="PeakAreaDeMultiplex-214"><a href="#PeakAreaDeMultiplex-214"><span class="linenos">214</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-215"><a href="#PeakAreaDeMultiplex-215"><span class="linenos">215</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex-216"><a href="#PeakAreaDeMultiplex-216"><span class="linenos">216</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-217"><a href="#PeakAreaDeMultiplex-217"><span class="linenos">217</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-218"><a href="#PeakAreaDeMultiplex-218"><span class="linenos">218</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-219"><a href="#PeakAreaDeMultiplex-219"><span class="linenos">219</span></a>                    <span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-220"><a href="#PeakAreaDeMultiplex-220"><span class="linenos">220</span></a>                <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-221"><a href="#PeakAreaDeMultiplex-221"><span class="linenos">221</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fitted</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-222"><a href="#PeakAreaDeMultiplex-222"><span class="linenos">222</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-223"><a href="#PeakAreaDeMultiplex-223"><span class="linenos">223</span></a>                    <span class="sa">f</span><span class="s2">&quot;Peak </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> area: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> .1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PeakAreaDeMultiplex-224"><a href="#PeakAreaDeMultiplex-224"><span class="linenos">224</span></a>                <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-225"><a href="#PeakAreaDeMultiplex-225"><span class="linenos">225</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-226"><a href="#PeakAreaDeMultiplex-226"><span class="linenos">226</span></a>
</span><span id="PeakAreaDeMultiplex-227"><a href="#PeakAreaDeMultiplex-227"><span class="linenos">227</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quotient: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">quotient</span><span class="si">:</span><span class="s2"> .2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-228"><a href="#PeakAreaDeMultiplex-228"><span class="linenos">228</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Raw data&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">])</span>
</span><span id="PeakAreaDeMultiplex-229"><a href="#PeakAreaDeMultiplex-229"><span class="linenos">229</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">supxlabel</span><span class="p">(</span><span class="s2">&quot;basepairs&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-230"><a href="#PeakAreaDeMultiplex-230"><span class="linenos">230</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">supylabel</span><span class="p">(</span><span class="s2">&quot;intensity&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-231"><a href="#PeakAreaDeMultiplex-231"><span class="linenos">231</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-232"><a href="#PeakAreaDeMultiplex-232"><span class="linenos">232</span></a>
</span><span id="PeakAreaDeMultiplex-233"><a href="#PeakAreaDeMultiplex-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="n">fig_areas</span>
</span><span id="PeakAreaDeMultiplex-234"><a href="#PeakAreaDeMultiplex-234"><span class="linenos">234</span></a>
</span><span id="PeakAreaDeMultiplex-235"><a href="#PeakAreaDeMultiplex-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">fit_assay_peaks</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex-236"><a href="#PeakAreaDeMultiplex-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-237"><a href="#PeakAreaDeMultiplex-237"><span class="linenos">237</span></a>        <span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-238"><a href="#PeakAreaDeMultiplex-238"><span class="linenos">238</span></a>        <span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-239"><a href="#PeakAreaDeMultiplex-239"><span class="linenos">239</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex-240"><a href="#PeakAreaDeMultiplex-240"><span class="linenos">240</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-241"><a href="#PeakAreaDeMultiplex-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-242"><a href="#PeakAreaDeMultiplex-242"><span class="linenos">242</span></a><span class="sd">        Runs fit_lmfit_model, calculate_quotient and peak_position_area_dataframe</span>
</span><span id="PeakAreaDeMultiplex-243"><a href="#PeakAreaDeMultiplex-243"><span class="linenos">243</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-244"><a href="#PeakAreaDeMultiplex-244"><span class="linenos">244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_lmfit_model</span><span class="p">(</span><span class="n">peak_finding_model</span><span class="p">,</span> <span class="n">assay_number</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-245"><a href="#PeakAreaDeMultiplex-245"><span class="linenos">245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_quotient</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex-246"><a href="#PeakAreaDeMultiplex-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_position_area_dataframe</span><span class="p">(</span><span class="n">assay_number</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-247"><a href="#PeakAreaDeMultiplex-247"><span class="linenos">247</span></a>        <span class="c1"># area plots</span>
</span><span id="PeakAreaDeMultiplex-248"><a href="#PeakAreaDeMultiplex-248"><span class="linenos">248</span></a>        <span class="n">area_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_areas</span><span class="p">(</span><span class="n">peak_finding_model</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-249"><a href="#PeakAreaDeMultiplex-249"><span class="linenos">249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area_plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">area_plot</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-250"><a href="#PeakAreaDeMultiplex-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assay_peak_area_df</span>
</span><span id="PeakAreaDeMultiplex-251"><a href="#PeakAreaDeMultiplex-251"><span class="linenos">251</span></a>
</span><span id="PeakAreaDeMultiplex-252"><a href="#PeakAreaDeMultiplex-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">assays_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gauss&quot;</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex-253"><a href="#PeakAreaDeMultiplex-253"><span class="linenos">253</span></a>        <span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex-254"><a href="#PeakAreaDeMultiplex-254"><span class="linenos">254</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-255"><a href="#PeakAreaDeMultiplex-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">custom_peaks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-256"><a href="#PeakAreaDeMultiplex-256"><span class="linenos">256</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">custom_peaks</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex-257"><a href="#PeakAreaDeMultiplex-257"><span class="linenos">257</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex-258"><a href="#PeakAreaDeMultiplex-258"><span class="linenos">258</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex-259"><a href="#PeakAreaDeMultiplex-259"><span class="linenos">259</span></a>            <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_assay_peaks</span><span class="p">(</span><span class="n">peak_finding_model</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
</span><span id="PeakAreaDeMultiplex-260"><a href="#PeakAreaDeMultiplex-260"><span class="linenos">260</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex-261"><a href="#PeakAreaDeMultiplex-261"><span class="linenos">261</span></a>        <span class="c1"># initialize attribute self.final_df</span>
</span><span id="PeakAreaDeMultiplex-262"><a href="#PeakAreaDeMultiplex-262"><span class="linenos">262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">final_df</span> <span class="o">=</span> <span class="n">df</span>
</span><span id="PeakAreaDeMultiplex-263"><a href="#PeakAreaDeMultiplex-263"><span class="linenos">263</span></a>        <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


    

                            <div id="PeakAreaDeMultiplex.__init__" class="classattr">
                                        <input id="PeakAreaDeMultiplex.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PeakAreaDeMultiplex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">peaks</span><span class="p">:</span> <span class="n"><a href="#PeakFinder">PeakFinder</a></span>, </span><span class="param"><span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="PeakAreaDeMultiplex.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex.__init__-26"><a href="#PeakAreaDeMultiplex.__init__-26"><span class="linenos">26</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.__init__-27"><a href="#PeakAreaDeMultiplex.__init__-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.__init__-28"><a href="#PeakAreaDeMultiplex.__init__-28"><span class="linenos">28</span></a>        <span class="n">peaks</span><span class="p">:</span> <span class="n">PeakFinder</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.__init__-29"><a href="#PeakAreaDeMultiplex.__init__-29"><span class="linenos">29</span></a>        <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.__init__-30"><a href="#PeakAreaDeMultiplex.__init__-30"><span class="linenos">30</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.__init__-31"><a href="#PeakAreaDeMultiplex.__init__-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span> <span class="o">=</span> <span class="n">peaks</span>
</span><span id="PeakAreaDeMultiplex.__init__-32"><a href="#PeakAreaDeMultiplex.__init__-32"><span class="linenos">32</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="o">=</span> <span class="n">cutoff</span> <span class="ow">or</span> <span class="kc">None</span>
</span><span id="PeakAreaDeMultiplex.__init__-33"><a href="#PeakAreaDeMultiplex.__init__-33"><span class="linenos">33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peaks_dataframe</span>
</span><span id="PeakAreaDeMultiplex.__init__-34"><a href="#PeakAreaDeMultiplex.__init__-34"><span class="linenos">34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span>
</span><span id="PeakAreaDeMultiplex.__init__-35"><a href="#PeakAreaDeMultiplex.__init__-35"><span class="linenos">35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">file_name</span>
</span><span id="PeakAreaDeMultiplex.__init__-36"><a href="#PeakAreaDeMultiplex.__init__-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peaks_index</span>
</span><span id="PeakAreaDeMultiplex.__init__-37"><a href="#PeakAreaDeMultiplex.__init__-37"><span class="linenos">37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">found_peaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">found_peaks</span>
</span><span id="PeakAreaDeMultiplex.__init__-38"><a href="#PeakAreaDeMultiplex.__init__-38"><span class="linenos">38</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area_plots</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex.__init__-39"><a href="#PeakAreaDeMultiplex.__init__-39"><span class="linenos">39</span></a>
</span><span id="PeakAreaDeMultiplex.__init__-40"><a href="#PeakAreaDeMultiplex.__init__-40"><span class="linenos">40</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_peak_widths</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.__init__-41"><a href="#PeakAreaDeMultiplex.__init__-41"><span class="linenos">41</span></a>        <span class="c1"># divade peaks based on their assay they belonging</span>
</span><span id="PeakAreaDeMultiplex.__init__-42"><a href="#PeakAreaDeMultiplex.__init__-42"><span class="linenos">42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">divided_assays</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divide_peak_assays</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.__init__-43"><a href="#PeakAreaDeMultiplex.__init__-43"><span class="linenos">43</span></a>        <span class="c1"># how many assays does this sample contain?</span>
</span><span id="PeakAreaDeMultiplex.__init__-44"><a href="#PeakAreaDeMultiplex.__init__-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_assays</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">divided_assays</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.__init__-45"><a href="#PeakAreaDeMultiplex.__init__-45"><span class="linenos">45</span></a>        <span class="c1"># divide all peaks in each assay into separate dataframes</span>
</span><span id="PeakAreaDeMultiplex.__init__-46"><a href="#PeakAreaDeMultiplex.__init__-46"><span class="linenos">46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">divided_peaks</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">divide_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divided_assays</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex.__init__-47"><a href="#PeakAreaDeMultiplex.__init__-47"><span class="linenos">47</span></a>        <span class="c1"># logging</span>
</span><span id="PeakAreaDeMultiplex.__init__-48"><a href="#PeakAreaDeMultiplex.__init__-48"><span class="linenos">48</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.__init__-49"><a href="#PeakAreaDeMultiplex.__init__-49"><span class="linenos">49</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.__init__-50"><a href="#PeakAreaDeMultiplex.__init__-50"><span class="linenos">50</span></a><span class="s2">        Number of assays found: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_assays</span><span class="si">}</span>
</span><span id="PeakAreaDeMultiplex.__init__-51"><a href="#PeakAreaDeMultiplex.__init__-51"><span class="linenos">51</span></a><span class="s2">        Number of peaks found: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span>
</span><span id="PeakAreaDeMultiplex.__init__-52"><a href="#PeakAreaDeMultiplex.__init__-52"><span class="linenos">52</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.__init__-53"><a href="#PeakAreaDeMultiplex.__init__-53"><span class="linenos">53</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="PeakAreaDeMultiplex.peaks" class="classattr">
                                <div class="attr variable">
            <span class="name">peaks</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.peaks"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.cutoff" class="classattr">
                                <div class="attr variable">
            <span class="name">cutoff</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.cutoff"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.peaks_dataframe" class="classattr">
                                <div class="attr variable">
            <span class="name">peaks_dataframe</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.peaks_dataframe"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.peak_information" class="classattr">
                                <div class="attr variable">
            <span class="name">peak_information</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.peak_information"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.file_name" class="classattr">
                                <div class="attr variable">
            <span class="name">file_name</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.file_name"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.peaks_index" class="classattr">
                                <div class="attr variable">
            <span class="name">peaks_index</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.peaks_index"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.found_peaks" class="classattr">
                                <div class="attr variable">
            <span class="name">found_peaks</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.found_peaks"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.area_plots" class="classattr">
                                <div class="attr variable">
            <span class="name">area_plots</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.area_plots"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.divided_assays" class="classattr">
                                <div class="attr variable">
            <span class="name">divided_assays</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.divided_assays"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.number_of_assays" class="classattr">
                                <div class="attr variable">
            <span class="name">number_of_assays</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.number_of_assays"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.divided_peaks" class="classattr">
                                <div class="attr variable">
            <span class="name">divided_peaks</span>

        
    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.divided_peaks"></a>
    
    

                            </div>
                            <div id="PeakAreaDeMultiplex.find_peak_widths" class="classattr">
                                        <input id="PeakAreaDeMultiplex.find_peak_widths-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_peak_widths</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">rel_height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PeakAreaDeMultiplex.find_peak_widths-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.find_peak_widths"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex.find_peak_widths-58"><a href="#PeakAreaDeMultiplex.find_peak_widths-58"><span class="linenos">58</span></a>    <span class="k">def</span> <span class="nf">find_peak_widths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel_height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-59"><a href="#PeakAreaDeMultiplex.find_peak_widths-59"><span class="linenos">59</span></a>        <span class="n">widths</span> <span class="o">=</span> <span class="n">peak_widths</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-60"><a href="#PeakAreaDeMultiplex.find_peak_widths-60"><span class="linenos">60</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-61"><a href="#PeakAreaDeMultiplex.find_peak_widths-61"><span class="linenos">61</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks_index</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-62"><a href="#PeakAreaDeMultiplex.find_peak_widths-62"><span class="linenos">62</span></a>            <span class="n">rel_height</span><span class="o">=</span><span class="n">rel_height</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-63"><a href="#PeakAreaDeMultiplex.find_peak_widths-63"><span class="linenos">63</span></a>        <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-64"><a href="#PeakAreaDeMultiplex.find_peak_widths-64"><span class="linenos">64</span></a>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-65"><a href="#PeakAreaDeMultiplex.find_peak_widths-65"><span class="linenos">65</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">widths</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-66"><a href="#PeakAreaDeMultiplex.find_peak_widths-66"><span class="linenos">66</span></a>        <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;peak_height&quot;</span><span class="p">,</span> <span class="s2">&quot;peak_start&quot;</span><span class="p">,</span> <span class="s2">&quot;peak_end&quot;</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-67"><a href="#PeakAreaDeMultiplex.find_peak_widths-67"><span class="linenos">67</span></a>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-68"><a href="#PeakAreaDeMultiplex.find_peak_widths-68"><span class="linenos">68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_widths</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-69"><a href="#PeakAreaDeMultiplex.find_peak_widths-69"><span class="linenos">69</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_start</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">peak_start</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-70"><a href="#PeakAreaDeMultiplex.find_peak_widths-70"><span class="linenos">70</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_end</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">peak_end</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-71"><a href="#PeakAreaDeMultiplex.find_peak_widths-71"><span class="linenos">71</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-72"><a href="#PeakAreaDeMultiplex.find_peak_widths-72"><span class="linenos">72</span></a>            <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;peak_name&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.find_peak_widths-73"><a href="#PeakAreaDeMultiplex.find_peak_widths-73"><span class="linenos">73</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="PeakAreaDeMultiplex.divide_peak_assays" class="classattr">
                                        <input id="PeakAreaDeMultiplex.divide_peak_assays-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">divide_peak_assays</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PeakAreaDeMultiplex.divide_peak_assays-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.divide_peak_assays"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex.divide_peak_assays-75"><a href="#PeakAreaDeMultiplex.divide_peak_assays-75"><span class="linenos">75</span></a>    <span class="k">def</span> <span class="nf">divide_peak_assays</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="PeakAreaDeMultiplex.divide_peak_assays-76"><a href="#PeakAreaDeMultiplex.divide_peak_assays-76"><span class="linenos">76</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.divide_peak_assays-77"><a href="#PeakAreaDeMultiplex.divide_peak_assays-77"><span class="linenos">77</span></a><span class="sd">        Divide the peaks belonging to different assays based on their assay number</span>
</span><span id="PeakAreaDeMultiplex.divide_peak_assays-78"><a href="#PeakAreaDeMultiplex.divide_peak_assays-78"><span class="linenos">78</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.divide_peak_assays-79"><a href="#PeakAreaDeMultiplex.divide_peak_assays-79"><span class="linenos">79</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_widths</span>
</span><span id="PeakAreaDeMultiplex.divide_peak_assays-80"><a href="#PeakAreaDeMultiplex.divide_peak_assays-80"><span class="linenos">80</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">assay</span> <span class="o">==</span> <span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">assay</span><span class="o">.</span><span class="n">unique</span><span class="p">()]</span>
</span></pre></div>


            <div class="docstring"><p>Divide the peaks belonging to different assays based on their assay number</p>
</div>


                            </div>
                            <div id="PeakAreaDeMultiplex.divide_peaks" class="classattr">
                                        <input id="PeakAreaDeMultiplex.divide_peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">divide_peaks</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">assay</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">padding</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PeakAreaDeMultiplex.divide_peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.divide_peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex.divide_peaks-82"><a href="#PeakAreaDeMultiplex.divide_peaks-82"><span class="linenos">82</span></a>    <span class="k">def</span> <span class="nf">divide_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assay</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">padding</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="PeakAreaDeMultiplex.divide_peaks-83"><a href="#PeakAreaDeMultiplex.divide_peaks-83"><span class="linenos">83</span></a>        <span class="c1"># add some padding to the left and right to be sure to include everything in the peak</span>
</span><span id="PeakAreaDeMultiplex.divide_peaks-84"><a href="#PeakAreaDeMultiplex.divide_peaks-84"><span class="linenos">84</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="PeakAreaDeMultiplex.divide_peaks-85"><a href="#PeakAreaDeMultiplex.divide_peaks-85"><span class="linenos">85</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">peak_start</span> <span class="o">-</span> <span class="n">padding</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peak_end</span> <span class="o">+</span> <span class="n">padding</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex.divide_peaks-86"><a href="#PeakAreaDeMultiplex.divide_peaks-86"><span class="linenos">86</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">assay</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.divide_peaks-87"><a href="#PeakAreaDeMultiplex.divide_peaks-87"><span class="linenos">87</span></a>        <span class="p">]</span>
</span></pre></div>


    

                            </div>
                            <div id="PeakAreaDeMultiplex.fit_lmfit_model" class="classattr">
                                        <input id="PeakAreaDeMultiplex.fit_lmfit_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit_lmfit_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PeakAreaDeMultiplex.fit_lmfit_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.fit_lmfit_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex.fit_lmfit_model-89"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-89"><span class="linenos"> 89</span></a>    <span class="k">def</span> <span class="nf">fit_lmfit_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-90"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-90"><span class="linenos"> 90</span></a>        <span class="k">if</span> <span class="n">assay_number</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_assays</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-91"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-91"><span class="linenos"> 91</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-92"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-92"><span class="linenos"> 92</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-93"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-93"><span class="linenos"> 93</span></a><span class="s2">                The sample only contains </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_assays</span><span class="si">}</span><span class="s2"> assays. </span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-94"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-94"><span class="linenos"> 94</span></a><span class="s2">                Use a number inside of the range.</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-95"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-95"><span class="linenos"> 95</span></a><span class="s2">                Indexing starts at 0.</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-96"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-96"><span class="linenos"> 96</span></a><span class="s2">                &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-97"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-97"><span class="linenos"> 97</span></a>            <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-98"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-98"><span class="linenos"> 98</span></a>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-99"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="n">peak_finding_model</span> <span class="o">==</span> <span class="s2">&quot;gauss&quot;</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-100"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-100"><span class="linenos">100</span></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-101"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-101"><span class="linenos">101</span></a>        <span class="k">elif</span> <span class="n">peak_finding_model</span> <span class="o">==</span> <span class="s2">&quot;voigt&quot;</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-102"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-102"><span class="linenos">102</span></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">VoigtModel</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-103"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-103"><span class="linenos">103</span></a>        <span class="k">elif</span> <span class="n">peak_finding_model</span> <span class="o">==</span> <span class="s2">&quot;lorentzian&quot;</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-104"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-104"><span class="linenos">104</span></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">LorentzianModel</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-105"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-105"><span class="linenos">105</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-106"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-106"><span class="linenos">106</span></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-107"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-107"><span class="linenos">107</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-108"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-108"><span class="linenos">108</span></a><span class="s2">                </span><span class="si">{</span><span class="n">peak_finding_model</span><span class="si">}</span><span class="s2"> is not implemented! </span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-109"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-109"><span class="linenos">109</span></a><span class="s2">                Options: [gauss, voigt, lorentzian]</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-110"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-110"><span class="linenos">110</span></a><span class="s2">                &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-111"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-111"><span class="linenos">111</span></a>            <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-112"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-112"><span class="linenos">112</span></a>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-113"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-113"><span class="linenos">113</span></a>        <span class="n">fit_df</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-114"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-114"><span class="linenos">114</span></a>        <span class="n">fit_params</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-115"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-115"><span class="linenos">115</span></a>        <span class="n">fit_report</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-116"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-116"><span class="linenos">116</span></a>        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">divided_peaks</span><span class="p">[</span><span class="n">assay_number</span><span class="p">]:</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-117"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-117"><span class="linenos">117</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-118"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-118"><span class="linenos">118</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-119"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-119"><span class="linenos">119</span></a>            <span class="c1"># CHANGED to time instead of basepair</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-120"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-120"><span class="linenos">120</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-121"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-121"><span class="linenos">121</span></a>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-122"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-122"><span class="linenos">122</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-123"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-123"><span class="linenos">123</span></a>            <span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-124"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-124"><span class="linenos">124</span></a>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-125"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-125"><span class="linenos">125</span></a>            <span class="n">fit_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">fitted</span><span class="o">=</span><span class="n">out</span><span class="o">.</span><span class="n">best_fit</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">peak_finding_model</span><span class="p">))</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-126"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-126"><span class="linenos">126</span></a>            <span class="n">fit_params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-127"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-127"><span class="linenos">127</span></a>            <span class="n">fit_report</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">fit_report</span><span class="p">())</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-128"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-128"><span class="linenos">128</span></a>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-129"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-129"><span class="linenos">129</span></a>        <span class="c1"># Update the instances of the model fit</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-130"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span> <span class="o">=</span> <span class="n">fit_df</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-131"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span> <span class="o">=</span> <span class="n">fit_params</span>
</span><span id="PeakAreaDeMultiplex.fit_lmfit_model-132"><a href="#PeakAreaDeMultiplex.fit_lmfit_model-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_report</span> <span class="o">=</span> <span class="n">fit_report</span>
</span></pre></div>


    

                            </div>
                            <div id="PeakAreaDeMultiplex.calculate_quotient" class="classattr">
                                        <input id="PeakAreaDeMultiplex.calculate_quotient-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calculate_quotient</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PeakAreaDeMultiplex.calculate_quotient-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.calculate_quotient"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex.calculate_quotient-136"><a href="#PeakAreaDeMultiplex.calculate_quotient-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">calculate_quotient</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-137"><a href="#PeakAreaDeMultiplex.calculate_quotient-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-138"><a href="#PeakAreaDeMultiplex.calculate_quotient-138"><span class="linenos">138</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-139"><a href="#PeakAreaDeMultiplex.calculate_quotient-139"><span class="linenos">139</span></a>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-140"><a href="#PeakAreaDeMultiplex.calculate_quotient-140"><span class="linenos">140</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-141"><a href="#PeakAreaDeMultiplex.calculate_quotient-141"><span class="linenos">141</span></a><span class="sd">        :Params:</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-142"><a href="#PeakAreaDeMultiplex.calculate_quotient-142"><span class="linenos">142</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-143"><a href="#PeakAreaDeMultiplex.calculate_quotient-143"><span class="linenos">143</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;amplitude&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">])</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-144"><a href="#PeakAreaDeMultiplex.calculate_quotient-144"><span class="linenos">144</span></a>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-145"><a href="#PeakAreaDeMultiplex.calculate_quotient-145"><span class="linenos">145</span></a>        <span class="n">right_by_left</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-146"><a href="#PeakAreaDeMultiplex.calculate_quotient-146"><span class="linenos">146</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-147"><a href="#PeakAreaDeMultiplex.calculate_quotient-147"><span class="linenos">147</span></a>            <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">)</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutoff</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-148"><a href="#PeakAreaDeMultiplex.calculate_quotient-148"><span class="linenos">148</span></a>        <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-149"><a href="#PeakAreaDeMultiplex.calculate_quotient-149"><span class="linenos">149</span></a>        <span class="c1"># if there only is 1 peak, return 0</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-150"><a href="#PeakAreaDeMultiplex.calculate_quotient-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-151"><a href="#PeakAreaDeMultiplex.calculate_quotient-151"><span class="linenos">151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">quotient</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-152"><a href="#PeakAreaDeMultiplex.calculate_quotient-152"><span class="linenos">152</span></a>            <span class="k">return</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-153"><a href="#PeakAreaDeMultiplex.calculate_quotient-153"><span class="linenos">153</span></a>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-154"><a href="#PeakAreaDeMultiplex.calculate_quotient-154"><span class="linenos">154</span></a>        <span class="c1"># if there only are 2 peaks, return the quotient</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-155"><a href="#PeakAreaDeMultiplex.calculate_quotient-155"><span class="linenos">155</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-156"><a href="#PeakAreaDeMultiplex.calculate_quotient-156"><span class="linenos">156</span></a>            <span class="c1"># left peak divided by right peak</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-157"><a href="#PeakAreaDeMultiplex.calculate_quotient-157"><span class="linenos">157</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">right_by_left</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-158"><a href="#PeakAreaDeMultiplex.calculate_quotient-158"><span class="linenos">158</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">quotient</span> <span class="o">=</span> <span class="n">areas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">areas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-159"><a href="#PeakAreaDeMultiplex.calculate_quotient-159"><span class="linenos">159</span></a>                <span class="k">return</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-160"><a href="#PeakAreaDeMultiplex.calculate_quotient-160"><span class="linenos">160</span></a>            <span class="c1"># right peak divided by left peak</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-161"><a href="#PeakAreaDeMultiplex.calculate_quotient-161"><span class="linenos">161</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">quotient</span> <span class="o">=</span> <span class="n">areas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">areas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-162"><a href="#PeakAreaDeMultiplex.calculate_quotient-162"><span class="linenos">162</span></a>            <span class="k">return</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-163"><a href="#PeakAreaDeMultiplex.calculate_quotient-163"><span class="linenos">163</span></a>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-164"><a href="#PeakAreaDeMultiplex.calculate_quotient-164"><span class="linenos">164</span></a>        <span class="c1"># return the last peak divided by the mean of the peaks to the left of it</span>
</span><span id="PeakAreaDeMultiplex.calculate_quotient-165"><a href="#PeakAreaDeMultiplex.calculate_quotient-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quotient</span> <span class="o">=</span> <span class="n">areas</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">areas</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>:Params:</p>
</div>


                            </div>
                            <div id="PeakAreaDeMultiplex.peak_position_area_dataframe" class="classattr">
                                        <input id="PeakAreaDeMultiplex.peak_position_area_dataframe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">peak_position_area_dataframe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="PeakAreaDeMultiplex.peak_position_area_dataframe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.peak_position_area_dataframe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-167"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-167"><span class="linenos">167</span></a>    <span class="k">def</span> <span class="nf">peak_position_area_dataframe</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-168"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-169"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-169"><span class="linenos">169</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-170"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-170"><span class="linenos">170</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-171"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-171"><span class="linenos">171</span></a><span class="sd">        Returns a DataFrame of each peak and its properties</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-172"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-172"><span class="linenos">172</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-173"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-173"><span class="linenos">173</span></a>        <span class="n">dataframes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-174"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-174"><span class="linenos">174</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-175"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-175"><span class="linenos">175</span></a>            <span class="n">report</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_report</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-176"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-176"><span class="linenos">176</span></a>            <span class="n">r_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;R-squared *= (0\.\d</span><span class="si">{3}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">report</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-177"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-177"><span class="linenos">177</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-178"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-178"><span class="linenos">178</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-179"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-179"><span class="linenos">179</span></a>                <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-180"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-180"><span class="linenos">180</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">area</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;amplitude&quot;</span><span class="p">])</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-181"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-181"><span class="linenos">181</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">r_value</span><span class="o">=</span><span class="n">r_value</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-182"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-182"><span class="linenos">182</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Peak </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-183"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-183"><span class="linenos">183</span></a>                <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-184"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-184"><span class="linenos">184</span></a>                <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-185"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-185"><span class="linenos">185</span></a>                <span class="o">.</span><span class="n">rename</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-186"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-186"><span class="linenos">186</span></a>                    <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-187"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-187"><span class="linenos">187</span></a>                        <span class="s2">&quot;peaks&quot;</span><span class="p">:</span> <span class="s2">&quot;peak_height&quot;</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-188"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-188"><span class="linenos">188</span></a>                        <span class="s2">&quot;fitted&quot;</span><span class="p">:</span> <span class="s2">&quot;fitted_peak_height&quot;</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-189"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-189"><span class="linenos">189</span></a>                    <span class="p">}</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-190"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-190"><span class="linenos">190</span></a>                <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-191"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-191"><span class="linenos">191</span></a>                <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s2">&quot;peak_name&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-192"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-192"><span class="linenos">192</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-193"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-193"><span class="linenos">193</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">assay_name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-194"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-194"><span class="linenos">194</span></a>            <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-195"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-195"><span class="linenos">195</span></a>            <span class="n">dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-196"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-196"><span class="linenos">196</span></a>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-197"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assay_peak_area_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dataframes</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-198"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-198"><span class="linenos">198</span></a>            <span class="n">quotient</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quotient</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-199"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-199"><span class="linenos">199</span></a>            <span class="n">peak_number</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-200"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-200"><span class="linenos">200</span></a>            <span class="n">assay_number</span><span class="o">=</span><span class="n">assay_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.peak_position_area_dataframe-201"><a href="#PeakAreaDeMultiplex.peak_position_area_dataframe-201"><span class="linenos">201</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns a DataFrame of each peak and its properties</p>
</div>


                            </div>
                            <div id="PeakAreaDeMultiplex.plot_areas" class="classattr">
                                        <input id="PeakAreaDeMultiplex.plot_areas-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_areas</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PeakAreaDeMultiplex.plot_areas-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.plot_areas"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex.plot_areas-203"><a href="#PeakAreaDeMultiplex.plot_areas-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">plot_areas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-204"><a href="#PeakAreaDeMultiplex.plot_areas-204"><span class="linenos">204</span></a>        <span class="n">fig_areas</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-205"><a href="#PeakAreaDeMultiplex.plot_areas-205"><span class="linenos">205</span></a>            <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-206"><a href="#PeakAreaDeMultiplex.plot_areas-206"><span class="linenos">206</span></a>        <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-207"><a href="#PeakAreaDeMultiplex.plot_areas-207"><span class="linenos">207</span></a>        <span class="c1"># if there is only one peak</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-208"><a href="#PeakAreaDeMultiplex.plot_areas-208"><span class="linenos">208</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-209"><a href="#PeakAreaDeMultiplex.plot_areas-209"><span class="linenos">209</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-210"><a href="#PeakAreaDeMultiplex.plot_areas-210"><span class="linenos">210</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fitted</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-211"><a href="#PeakAreaDeMultiplex.plot_areas-211"><span class="linenos">211</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak 1 area: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> .1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-212"><a href="#PeakAreaDeMultiplex.plot_areas-212"><span class="linenos">212</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-213"><a href="#PeakAreaDeMultiplex.plot_areas-213"><span class="linenos">213</span></a>        <span class="c1"># if more than one peak</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-214"><a href="#PeakAreaDeMultiplex.plot_areas-214"><span class="linenos">214</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-215"><a href="#PeakAreaDeMultiplex.plot_areas-215"><span class="linenos">215</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-216"><a href="#PeakAreaDeMultiplex.plot_areas-216"><span class="linenos">216</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-217"><a href="#PeakAreaDeMultiplex.plot_areas-217"><span class="linenos">217</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-218"><a href="#PeakAreaDeMultiplex.plot_areas-218"><span class="linenos">218</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-219"><a href="#PeakAreaDeMultiplex.plot_areas-219"><span class="linenos">219</span></a>                    <span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-220"><a href="#PeakAreaDeMultiplex.plot_areas-220"><span class="linenos">220</span></a>                <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-221"><a href="#PeakAreaDeMultiplex.plot_areas-221"><span class="linenos">221</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fitted</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-222"><a href="#PeakAreaDeMultiplex.plot_areas-222"><span class="linenos">222</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-223"><a href="#PeakAreaDeMultiplex.plot_areas-223"><span class="linenos">223</span></a>                    <span class="sa">f</span><span class="s2">&quot;Peak </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> area: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> .1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-224"><a href="#PeakAreaDeMultiplex.plot_areas-224"><span class="linenos">224</span></a>                <span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-225"><a href="#PeakAreaDeMultiplex.plot_areas-225"><span class="linenos">225</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-226"><a href="#PeakAreaDeMultiplex.plot_areas-226"><span class="linenos">226</span></a>
</span><span id="PeakAreaDeMultiplex.plot_areas-227"><a href="#PeakAreaDeMultiplex.plot_areas-227"><span class="linenos">227</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quotient: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">quotient</span><span class="si">:</span><span class="s2"> .2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-228"><a href="#PeakAreaDeMultiplex.plot_areas-228"><span class="linenos">228</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Raw data&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">])</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-229"><a href="#PeakAreaDeMultiplex.plot_areas-229"><span class="linenos">229</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">supxlabel</span><span class="p">(</span><span class="s2">&quot;basepairs&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-230"><a href="#PeakAreaDeMultiplex.plot_areas-230"><span class="linenos">230</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">supylabel</span><span class="p">(</span><span class="s2">&quot;intensity&quot;</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-231"><a href="#PeakAreaDeMultiplex.plot_areas-231"><span class="linenos">231</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.plot_areas-232"><a href="#PeakAreaDeMultiplex.plot_areas-232"><span class="linenos">232</span></a>
</span><span id="PeakAreaDeMultiplex.plot_areas-233"><a href="#PeakAreaDeMultiplex.plot_areas-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="n">fig_areas</span>
</span></pre></div>


    

                            </div>
                            <div id="PeakAreaDeMultiplex.fit_assay_peaks" class="classattr">
                                        <input id="PeakAreaDeMultiplex.fit_assay_peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit_assay_peaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PeakAreaDeMultiplex.fit_assay_peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.fit_assay_peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex.fit_assay_peaks-235"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">fit_assay_peaks</span><span class="p">(</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-236"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-237"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-237"><span class="linenos">237</span></a>        <span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-238"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-238"><span class="linenos">238</span></a>        <span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-239"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-239"><span class="linenos">239</span></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-240"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-240"><span class="linenos">240</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-241"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-242"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-242"><span class="linenos">242</span></a><span class="sd">        Runs fit_lmfit_model, calculate_quotient and peak_position_area_dataframe</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-243"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-243"><span class="linenos">243</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-244"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-244"><span class="linenos">244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_lmfit_model</span><span class="p">(</span><span class="n">peak_finding_model</span><span class="p">,</span> <span class="n">assay_number</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-245"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-245"><span class="linenos">245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_quotient</span><span class="p">()</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-246"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_position_area_dataframe</span><span class="p">(</span><span class="n">assay_number</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-247"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-247"><span class="linenos">247</span></a>        <span class="c1"># area plots</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-248"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-248"><span class="linenos">248</span></a>        <span class="n">area_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_areas</span><span class="p">(</span><span class="n">peak_finding_model</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-249"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-249"><span class="linenos">249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">area_plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">area_plot</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.fit_assay_peaks-250"><a href="#PeakAreaDeMultiplex.fit_assay_peaks-250"><span class="linenos">250</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assay_peak_area_df</span>
</span></pre></div>


            <div class="docstring"><p>Runs fit_lmfit_model, calculate_quotient and peak_position_area_dataframe</p>
</div>


                            </div>
                            <div id="PeakAreaDeMultiplex.assays_dataframe" class="classattr">
                                        <input id="PeakAreaDeMultiplex.assays_dataframe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">assays_dataframe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;gauss&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PeakAreaDeMultiplex.assays_dataframe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakAreaDeMultiplex.assays_dataframe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakAreaDeMultiplex.assays_dataframe-252"><a href="#PeakAreaDeMultiplex.assays_dataframe-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">assays_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gauss&quot;</span><span class="p">):</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-253"><a href="#PeakAreaDeMultiplex.assays_dataframe-253"><span class="linenos">253</span></a>        <span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-254"><a href="#PeakAreaDeMultiplex.assays_dataframe-254"><span class="linenos">254</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-255"><a href="#PeakAreaDeMultiplex.assays_dataframe-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">custom_peaks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-256"><a href="#PeakAreaDeMultiplex.assays_dataframe-256"><span class="linenos">256</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">custom_peaks</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-257"><a href="#PeakAreaDeMultiplex.assays_dataframe-257"><span class="linenos">257</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-258"><a href="#PeakAreaDeMultiplex.assays_dataframe-258"><span class="linenos">258</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-259"><a href="#PeakAreaDeMultiplex.assays_dataframe-259"><span class="linenos">259</span></a>            <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_assay_peaks</span><span class="p">(</span><span class="n">peak_finding_model</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-260"><a href="#PeakAreaDeMultiplex.assays_dataframe-260"><span class="linenos">260</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-261"><a href="#PeakAreaDeMultiplex.assays_dataframe-261"><span class="linenos">261</span></a>        <span class="c1"># initialize attribute self.final_df</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-262"><a href="#PeakAreaDeMultiplex.assays_dataframe-262"><span class="linenos">262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">final_df</span> <span class="o">=</span> <span class="n">df</span>
</span><span id="PeakAreaDeMultiplex.assays_dataframe-263"><a href="#PeakAreaDeMultiplex.assays_dataframe-263"><span class="linenos">263</span></a>        <span class="k">return</span> <span class="n">df</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="PlotPeakArea">
                            <input id="PlotPeakArea-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PlotPeakArea</span>:

                <label class="view-source-button" for="PlotPeakArea-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotPeakArea"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotPeakArea-8"><a href="#PlotPeakArea-8"><span class="linenos"> 8</span></a><span class="k">class</span> <span class="nc">PlotPeakArea</span><span class="p">:</span>
</span><span id="PlotPeakArea-9"><a href="#PlotPeakArea-9"><span class="linenos"> 9</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peak_area</span><span class="p">:</span> <span class="n">PeakAreaDeMultiplex</span><span class="p">):</span>
</span><span id="PlotPeakArea-10"><a href="#PlotPeakArea-10"><span class="linenos">10</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span> <span class="o">=</span> <span class="n">peak_area</span>
</span><span id="PlotPeakArea-11"><a href="#PlotPeakArea-11"><span class="linenos">11</span></a>
</span><span id="PlotPeakArea-12"><a href="#PlotPeakArea-12"><span class="linenos">12</span></a>    <span class="k">def</span> <span class="nf">plot_areas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="PlotPeakArea-13"><a href="#PlotPeakArea-13"><span class="linenos">13</span></a>
</span><span id="PlotPeakArea-14"><a href="#PlotPeakArea-14"><span class="linenos">14</span></a>        <span class="c1"># TODO: this functions get called again here...</span>
</span><span id="PlotPeakArea-15"><a href="#PlotPeakArea-15"><span class="linenos">15</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_assay_peaks</span><span class="p">(</span><span class="n">peak_finding_model</span><span class="p">,</span> <span class="n">assay_number</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="PlotPeakArea-16"><a href="#PlotPeakArea-16"><span class="linenos">16</span></a>
</span><span id="PlotPeakArea-17"><a href="#PlotPeakArea-17"><span class="linenos">17</span></a>        <span class="n">fig_areas</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
</span><span id="PlotPeakArea-18"><a href="#PlotPeakArea-18"><span class="linenos">18</span></a>            <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="PlotPeakArea-19"><a href="#PlotPeakArea-19"><span class="linenos">19</span></a>        <span class="p">)</span>
</span><span id="PlotPeakArea-20"><a href="#PlotPeakArea-20"><span class="linenos">20</span></a>
</span><span id="PlotPeakArea-21"><a href="#PlotPeakArea-21"><span class="linenos">21</span></a>        <span class="c1"># if there is only one peak</span>
</span><span id="PlotPeakArea-22"><a href="#PlotPeakArea-22"><span class="linenos">22</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="PlotPeakArea-23"><a href="#PlotPeakArea-23"><span class="linenos">23</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PlotPeakArea-24"><a href="#PlotPeakArea-24"><span class="linenos">24</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span>
</span><span id="PlotPeakArea-25"><a href="#PlotPeakArea-25"><span class="linenos">25</span></a>            <span class="p">)</span>
</span><span id="PlotPeakArea-26"><a href="#PlotPeakArea-26"><span class="linenos">26</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PlotPeakArea-27"><a href="#PlotPeakArea-27"><span class="linenos">27</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fitted</span>
</span><span id="PlotPeakArea-28"><a href="#PlotPeakArea-28"><span class="linenos">28</span></a>            <span class="p">)</span>
</span><span id="PlotPeakArea-29"><a href="#PlotPeakArea-29"><span class="linenos">29</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
</span><span id="PlotPeakArea-30"><a href="#PlotPeakArea-30"><span class="linenos">30</span></a>                <span class="sa">f</span><span class="s2">&quot;Peak 1 area: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> .1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PlotPeakArea-31"><a href="#PlotPeakArea-31"><span class="linenos">31</span></a>            <span class="p">)</span>
</span><span id="PlotPeakArea-32"><a href="#PlotPeakArea-32"><span class="linenos">32</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PlotPeakArea-33"><a href="#PlotPeakArea-33"><span class="linenos">33</span></a>        <span class="c1"># if more than one peak</span>
</span><span id="PlotPeakArea-34"><a href="#PlotPeakArea-34"><span class="linenos">34</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PlotPeakArea-35"><a href="#PlotPeakArea-35"><span class="linenos">35</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
</span><span id="PlotPeakArea-36"><a href="#PlotPeakArea-36"><span class="linenos">36</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PlotPeakArea-37"><a href="#PlotPeakArea-37"><span class="linenos">37</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span>
</span><span id="PlotPeakArea-38"><a href="#PlotPeakArea-38"><span class="linenos">38</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="PlotPeakArea-39"><a href="#PlotPeakArea-39"><span class="linenos">39</span></a>                    <span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span id="PlotPeakArea-40"><a href="#PlotPeakArea-40"><span class="linenos">40</span></a>                <span class="p">)</span>
</span><span id="PlotPeakArea-41"><a href="#PlotPeakArea-41"><span class="linenos">41</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PlotPeakArea-42"><a href="#PlotPeakArea-42"><span class="linenos">42</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fitted</span>
</span><span id="PlotPeakArea-43"><a href="#PlotPeakArea-43"><span class="linenos">43</span></a>                <span class="p">)</span>
</span><span id="PlotPeakArea-44"><a href="#PlotPeakArea-44"><span class="linenos">44</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
</span><span id="PlotPeakArea-45"><a href="#PlotPeakArea-45"><span class="linenos">45</span></a>                    <span class="sa">f</span><span class="s2">&quot;Peak </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> area: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> .1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PlotPeakArea-46"><a href="#PlotPeakArea-46"><span class="linenos">46</span></a>                <span class="p">)</span>
</span><span id="PlotPeakArea-47"><a href="#PlotPeakArea-47"><span class="linenos">47</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PlotPeakArea-48"><a href="#PlotPeakArea-48"><span class="linenos">48</span></a>
</span><span id="PlotPeakArea-49"><a href="#PlotPeakArea-49"><span class="linenos">49</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quotient: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">quotient</span><span class="si">:</span><span class="s2"> .2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PlotPeakArea-50"><a href="#PlotPeakArea-50"><span class="linenos">50</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Raw data&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">])</span>
</span><span id="PlotPeakArea-51"><a href="#PlotPeakArea-51"><span class="linenos">51</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">supxlabel</span><span class="p">(</span><span class="s2">&quot;basepairs&quot;</span><span class="p">)</span>
</span><span id="PlotPeakArea-52"><a href="#PlotPeakArea-52"><span class="linenos">52</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">supylabel</span><span class="p">(</span><span class="s2">&quot;intensity&quot;</span><span class="p">)</span>
</span><span id="PlotPeakArea-53"><a href="#PlotPeakArea-53"><span class="linenos">53</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PlotPeakArea-54"><a href="#PlotPeakArea-54"><span class="linenos">54</span></a>
</span><span id="PlotPeakArea-55"><a href="#PlotPeakArea-55"><span class="linenos">55</span></a>        <span class="k">return</span> <span class="n">fig_areas</span>
</span></pre></div>


    

                            <div id="PlotPeakArea.__init__" class="classattr">
                                        <input id="PlotPeakArea.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PlotPeakArea</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">peak_area</span><span class="p">:</span> <span class="n"><a href="#PeakAreaDeMultiplex">PeakAreaDeMultiplex</a></span></span>)</span>

                <label class="view-source-button" for="PlotPeakArea.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotPeakArea.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotPeakArea.__init__-9"><a href="#PlotPeakArea.__init__-9"><span class="linenos"> 9</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peak_area</span><span class="p">:</span> <span class="n">PeakAreaDeMultiplex</span><span class="p">):</span>
</span><span id="PlotPeakArea.__init__-10"><a href="#PlotPeakArea.__init__-10"><span class="linenos">10</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span> <span class="o">=</span> <span class="n">peak_area</span>
</span></pre></div>


    

                            </div>
                            <div id="PlotPeakArea.peak_area" class="classattr">
                                <div class="attr variable">
            <span class="name">peak_area</span>

        
    </div>
    <a class="headerlink" href="#PlotPeakArea.peak_area"></a>
    
    

                            </div>
                            <div id="PlotPeakArea.plot_areas" class="classattr">
                                        <input id="PlotPeakArea.plot_areas-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_areas</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PlotPeakArea.plot_areas-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotPeakArea.plot_areas"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotPeakArea.plot_areas-12"><a href="#PlotPeakArea.plot_areas-12"><span class="linenos">12</span></a>    <span class="k">def</span> <span class="nf">plot_areas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peak_finding_model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">assay_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="PlotPeakArea.plot_areas-13"><a href="#PlotPeakArea.plot_areas-13"><span class="linenos">13</span></a>
</span><span id="PlotPeakArea.plot_areas-14"><a href="#PlotPeakArea.plot_areas-14"><span class="linenos">14</span></a>        <span class="c1"># TODO: this functions get called again here...</span>
</span><span id="PlotPeakArea.plot_areas-15"><a href="#PlotPeakArea.plot_areas-15"><span class="linenos">15</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_assay_peaks</span><span class="p">(</span><span class="n">peak_finding_model</span><span class="p">,</span> <span class="n">assay_number</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-16"><a href="#PlotPeakArea.plot_areas-16"><span class="linenos">16</span></a>
</span><span id="PlotPeakArea.plot_areas-17"><a href="#PlotPeakArea.plot_areas-17"><span class="linenos">17</span></a>        <span class="n">fig_areas</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
</span><span id="PlotPeakArea.plot_areas-18"><a href="#PlotPeakArea.plot_areas-18"><span class="linenos">18</span></a>            <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-19"><a href="#PlotPeakArea.plot_areas-19"><span class="linenos">19</span></a>        <span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-20"><a href="#PlotPeakArea.plot_areas-20"><span class="linenos">20</span></a>
</span><span id="PlotPeakArea.plot_areas-21"><a href="#PlotPeakArea.plot_areas-21"><span class="linenos">21</span></a>        <span class="c1"># if there is only one peak</span>
</span><span id="PlotPeakArea.plot_areas-22"><a href="#PlotPeakArea.plot_areas-22"><span class="linenos">22</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="PlotPeakArea.plot_areas-23"><a href="#PlotPeakArea.plot_areas-23"><span class="linenos">23</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PlotPeakArea.plot_areas-24"><a href="#PlotPeakArea.plot_areas-24"><span class="linenos">24</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span>
</span><span id="PlotPeakArea.plot_areas-25"><a href="#PlotPeakArea.plot_areas-25"><span class="linenos">25</span></a>            <span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-26"><a href="#PlotPeakArea.plot_areas-26"><span class="linenos">26</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PlotPeakArea.plot_areas-27"><a href="#PlotPeakArea.plot_areas-27"><span class="linenos">27</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fitted</span>
</span><span id="PlotPeakArea.plot_areas-28"><a href="#PlotPeakArea.plot_areas-28"><span class="linenos">28</span></a>            <span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-29"><a href="#PlotPeakArea.plot_areas-29"><span class="linenos">29</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
</span><span id="PlotPeakArea.plot_areas-30"><a href="#PlotPeakArea.plot_areas-30"><span class="linenos">30</span></a>                <span class="sa">f</span><span class="s2">&quot;Peak 1 area: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> .1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PlotPeakArea.plot_areas-31"><a href="#PlotPeakArea.plot_areas-31"><span class="linenos">31</span></a>            <span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-32"><a href="#PlotPeakArea.plot_areas-32"><span class="linenos">32</span></a>            <span class="n">axs</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PlotPeakArea.plot_areas-33"><a href="#PlotPeakArea.plot_areas-33"><span class="linenos">33</span></a>        <span class="c1"># if more than one peak</span>
</span><span id="PlotPeakArea.plot_areas-34"><a href="#PlotPeakArea.plot_areas-34"><span class="linenos">34</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PlotPeakArea.plot_areas-35"><a href="#PlotPeakArea.plot_areas-35"><span class="linenos">35</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
</span><span id="PlotPeakArea.plot_areas-36"><a href="#PlotPeakArea.plot_areas-36"><span class="linenos">36</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PlotPeakArea.plot_areas-37"><a href="#PlotPeakArea.plot_areas-37"><span class="linenos">37</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span>
</span><span id="PlotPeakArea.plot_areas-38"><a href="#PlotPeakArea.plot_areas-38"><span class="linenos">38</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="PlotPeakArea.plot_areas-39"><a href="#PlotPeakArea.plot_areas-39"><span class="linenos">39</span></a>                    <span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span id="PlotPeakArea.plot_areas-40"><a href="#PlotPeakArea.plot_areas-40"><span class="linenos">40</span></a>                <span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-41"><a href="#PlotPeakArea.plot_areas-41"><span class="linenos">41</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PlotPeakArea.plot_areas-42"><a href="#PlotPeakArea.plot_areas-42"><span class="linenos">42</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fitted</span>
</span><span id="PlotPeakArea.plot_areas-43"><a href="#PlotPeakArea.plot_areas-43"><span class="linenos">43</span></a>                <span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-44"><a href="#PlotPeakArea.plot_areas-44"><span class="linenos">44</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
</span><span id="PlotPeakArea.plot_areas-45"><a href="#PlotPeakArea.plot_areas-45"><span class="linenos">45</span></a>                    <span class="sa">f</span><span class="s2">&quot;Peak </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> area: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;amplitude&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> .1f</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="PlotPeakArea.plot_areas-46"><a href="#PlotPeakArea.plot_areas-46"><span class="linenos">46</span></a>                <span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-47"><a href="#PlotPeakArea.plot_areas-47"><span class="linenos">47</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PlotPeakArea.plot_areas-48"><a href="#PlotPeakArea.plot_areas-48"><span class="linenos">48</span></a>
</span><span id="PlotPeakArea.plot_areas-49"><a href="#PlotPeakArea.plot_areas-49"><span class="linenos">49</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Quotient: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_area</span><span class="o">.</span><span class="n">quotient</span><span class="si">:</span><span class="s2"> .2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-50"><a href="#PlotPeakArea.plot_areas-50"><span class="linenos">50</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Raw data&quot;</span><span class="p">,</span> <span class="s2">&quot;Model&quot;</span><span class="p">])</span>
</span><span id="PlotPeakArea.plot_areas-51"><a href="#PlotPeakArea.plot_areas-51"><span class="linenos">51</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">supxlabel</span><span class="p">(</span><span class="s2">&quot;basepairs&quot;</span><span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-52"><a href="#PlotPeakArea.plot_areas-52"><span class="linenos">52</span></a>        <span class="n">fig_areas</span><span class="o">.</span><span class="n">supylabel</span><span class="p">(</span><span class="s2">&quot;intensity&quot;</span><span class="p">)</span>
</span><span id="PlotPeakArea.plot_areas-53"><a href="#PlotPeakArea.plot_areas-53"><span class="linenos">53</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PlotPeakArea.plot_areas-54"><a href="#PlotPeakArea.plot_areas-54"><span class="linenos">54</span></a>
</span><span id="PlotPeakArea.plot_areas-55"><a href="#PlotPeakArea.plot_areas-55"><span class="linenos">55</span></a>        <span class="k">return</span> <span class="n">fig_areas</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="PlotLadder">
                            <input id="PlotLadder-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PlotLadder</span>:

                <label class="view-source-button" for="PlotLadder-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotLadder"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotLadder-9"><a href="#PlotLadder-9"><span class="linenos"> 9</span></a><span class="k">class</span> <span class="nc">PlotLadder</span><span class="p">:</span>
</span><span id="PlotLadder-10"><a href="#PlotLadder-10"><span class="linenos">10</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">FitLadderModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PlotLadder-11"><a href="#PlotLadder-11"><span class="linenos">11</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
</span><span id="PlotLadder-12"><a href="#PlotLadder-12"><span class="linenos">12</span></a>
</span><span id="PlotLadder-13"><a href="#PlotLadder-13"><span class="linenos">13</span></a>    <span class="nd">@property</span>
</span><span id="PlotLadder-14"><a href="#PlotLadder-14"><span class="linenos">14</span></a>    <span class="k">def</span> <span class="nf">plot_ladder_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
</span><span id="PlotLadder-15"><a href="#PlotLadder-15"><span class="linenos">15</span></a>        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">size_standard</span>
</span><span id="PlotLadder-16"><a href="#PlotLadder-16"><span class="linenos">16</span></a>        <span class="n">best_combination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">best_combination</span>
</span><span id="PlotLadder-17"><a href="#PlotLadder-17"><span class="linenos">17</span></a>        <span class="n">ladder_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ladder</span>
</span><span id="PlotLadder-18"><a href="#PlotLadder-18"><span class="linenos">18</span></a>        <span class="n">ladder_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span>
</span><span id="PlotLadder-19"><a href="#PlotLadder-19"><span class="linenos">19</span></a>
</span><span id="PlotLadder-20"><a href="#PlotLadder-20"><span class="linenos">20</span></a>        <span class="n">fig_ladder_peaks</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="PlotLadder-21"><a href="#PlotLadder-21"><span class="linenos">21</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</span><span id="PlotLadder-22"><a href="#PlotLadder-22"><span class="linenos">22</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">best_combination</span><span class="p">,</span> <span class="n">trace</span><span class="p">[</span><span class="n">best_combination</span><span class="p">],</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
</span><span id="PlotLadder-23"><a href="#PlotLadder-23"><span class="linenos">23</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
</span><span id="PlotLadder-24"><a href="#PlotLadder-24"><span class="linenos">24</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Intensity&quot;</span><span class="p">)</span>
</span><span id="PlotLadder-25"><a href="#PlotLadder-25"><span class="linenos">25</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Trace&quot;</span><span class="p">,</span> <span class="s2">&quot;Peak (bp)&quot;</span><span class="p">])</span>
</span><span id="PlotLadder-26"><a href="#PlotLadder-26"><span class="linenos">26</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">ladder_name</span><span class="p">)</span>
</span><span id="PlotLadder-27"><a href="#PlotLadder-27"><span class="linenos">27</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PlotLadder-28"><a href="#PlotLadder-28"><span class="linenos">28</span></a>
</span><span id="PlotLadder-29"><a href="#PlotLadder-29"><span class="linenos">29</span></a>        <span class="k">for</span> <span class="n">peak</span><span class="p">,</span> <span class="n">ladder</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">best_combination</span><span class="p">,</span> <span class="n">ladder_size</span><span class="p">):</span>
</span><span id="PlotLadder-30"><a href="#PlotLadder-30"><span class="linenos">30</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">peak</span><span class="p">,</span> <span class="n">trace</span><span class="p">[</span><span class="n">peak</span><span class="p">],</span> <span class="n">ladder</span><span class="p">)</span>
</span><span id="PlotLadder-31"><a href="#PlotLadder-31"><span class="linenos">31</span></a>
</span><span id="PlotLadder-32"><a href="#PlotLadder-32"><span class="linenos">32</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PlotLadder-33"><a href="#PlotLadder-33"><span class="linenos">33</span></a>        <span class="k">return</span> <span class="n">fig_ladder_peaks</span>
</span><span id="PlotLadder-34"><a href="#PlotLadder-34"><span class="linenos">34</span></a>
</span><span id="PlotLadder-35"><a href="#PlotLadder-35"><span class="linenos">35</span></a>    <span class="nd">@property</span>
</span><span id="PlotLadder-36"><a href="#PlotLadder-36"><span class="linenos">36</span></a>    <span class="k">def</span> <span class="nf">plot_model_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PlotLadder-37"><a href="#PlotLadder-37"><span class="linenos">37</span></a>
</span><span id="PlotLadder-38"><a href="#PlotLadder-38"><span class="linenos">38</span></a>        <span class="n">ladder_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span>
</span><span id="PlotLadder-39"><a href="#PlotLadder-39"><span class="linenos">39</span></a>        <span class="n">best_combination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">best_combination</span>
</span><span id="PlotLadder-40"><a href="#PlotLadder-40"><span class="linenos">40</span></a>
</span><span id="PlotLadder-41"><a href="#PlotLadder-41"><span class="linenos">41</span></a>        <span class="n">predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">best_combination</span><span class="p">)</span>
</span><span id="PlotLadder-42"><a href="#PlotLadder-42"><span class="linenos">42</span></a>        <span class="n">ladder_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ladder</span>
</span><span id="PlotLadder-43"><a href="#PlotLadder-43"><span class="linenos">43</span></a>
</span><span id="PlotLadder-44"><a href="#PlotLadder-44"><span class="linenos">44</span></a>        <span class="n">mse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mse</span>
</span><span id="PlotLadder-45"><a href="#PlotLadder-45"><span class="linenos">45</span></a>        <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">r2</span>
</span><span id="PlotLadder-46"><a href="#PlotLadder-46"><span class="linenos">46</span></a>
</span><span id="PlotLadder-47"><a href="#PlotLadder-47"><span class="linenos">47</span></a>        <span class="n">fig_model_fit</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="PlotLadder-48"><a href="#PlotLadder-48"><span class="linenos">48</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ladder_size</span><span class="p">,</span> <span class="n">best_combination</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
</span><span id="PlotLadder-49"><a href="#PlotLadder-49"><span class="linenos">49</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">best_combination</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="PlotLadder-50"><a href="#PlotLadder-50"><span class="linenos">50</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ladder_size</span><span class="p">),</span> <span class="mi">50</span><span class="p">))</span>
</span><span id="PlotLadder-51"><a href="#PlotLadder-51"><span class="linenos">51</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;bp&quot;</span><span class="p">)</span>
</span><span id="PlotLadder-52"><a href="#PlotLadder-52"><span class="linenos">52</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">best_combination</span><span class="p">),</span> <span class="mi">500</span><span class="p">))</span>
</span><span id="PlotLadder-53"><a href="#PlotLadder-53"><span class="linenos">53</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">ladder_name</span><span class="p">)</span>
</span><span id="PlotLadder-54"><a href="#PlotLadder-54"><span class="linenos">54</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mse</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">r2</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PlotLadder-55"><a href="#PlotLadder-55"><span class="linenos">55</span></a>        <span class="c1"># plt.title(f&quot;{self.model.model[0]=}&quot;)</span>
</span><span id="PlotLadder-56"><a href="#PlotLadder-56"><span class="linenos">56</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;True value&quot;</span><span class="p">,</span> <span class="s2">&quot;Predicted value&quot;</span><span class="p">])</span>
</span><span id="PlotLadder-57"><a href="#PlotLadder-57"><span class="linenos">57</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PlotLadder-58"><a href="#PlotLadder-58"><span class="linenos">58</span></a>
</span><span id="PlotLadder-59"><a href="#PlotLadder-59"><span class="linenos">59</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PlotLadder-60"><a href="#PlotLadder-60"><span class="linenos">60</span></a>        <span class="k">return</span> <span class="n">fig_model_fit</span>
</span></pre></div>


    

                            <div id="PlotLadder.__init__" class="classattr">
                                        <input id="PlotLadder.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PlotLadder</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">model</span><span class="p">:</span> <span class="n"><a href="#FitLadderModel">FitLadderModel</a></span></span>)</span>

                <label class="view-source-button" for="PlotLadder.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotLadder.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotLadder.__init__-10"><a href="#PlotLadder.__init__-10"><span class="linenos">10</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">FitLadderModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PlotLadder.__init__-11"><a href="#PlotLadder.__init__-11"><span class="linenos">11</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
</span></pre></div>


    

                            </div>
                            <div id="PlotLadder.model" class="classattr">
                                <div class="attr variable">
            <span class="name">model</span>

        
    </div>
    <a class="headerlink" href="#PlotLadder.model"></a>
    
    

                            </div>
                            <div id="PlotLadder.plot_ladder_peaks" class="classattr">
                                        <input id="PlotLadder.plot_ladder_peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">plot_ladder_peaks</span><span class="annotation">: matplotlib.figure.Figure</span>

                <label class="view-source-button" for="PlotLadder.plot_ladder_peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotLadder.plot_ladder_peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotLadder.plot_ladder_peaks-13"><a href="#PlotLadder.plot_ladder_peaks-13"><span class="linenos">13</span></a>    <span class="nd">@property</span>
</span><span id="PlotLadder.plot_ladder_peaks-14"><a href="#PlotLadder.plot_ladder_peaks-14"><span class="linenos">14</span></a>    <span class="k">def</span> <span class="nf">plot_ladder_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
</span><span id="PlotLadder.plot_ladder_peaks-15"><a href="#PlotLadder.plot_ladder_peaks-15"><span class="linenos">15</span></a>        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">size_standard</span>
</span><span id="PlotLadder.plot_ladder_peaks-16"><a href="#PlotLadder.plot_ladder_peaks-16"><span class="linenos">16</span></a>        <span class="n">best_combination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">best_combination</span>
</span><span id="PlotLadder.plot_ladder_peaks-17"><a href="#PlotLadder.plot_ladder_peaks-17"><span class="linenos">17</span></a>        <span class="n">ladder_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ladder</span>
</span><span id="PlotLadder.plot_ladder_peaks-18"><a href="#PlotLadder.plot_ladder_peaks-18"><span class="linenos">18</span></a>        <span class="n">ladder_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span>
</span><span id="PlotLadder.plot_ladder_peaks-19"><a href="#PlotLadder.plot_ladder_peaks-19"><span class="linenos">19</span></a>
</span><span id="PlotLadder.plot_ladder_peaks-20"><a href="#PlotLadder.plot_ladder_peaks-20"><span class="linenos">20</span></a>        <span class="n">fig_ladder_peaks</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="PlotLadder.plot_ladder_peaks-21"><a href="#PlotLadder.plot_ladder_peaks-21"><span class="linenos">21</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</span><span id="PlotLadder.plot_ladder_peaks-22"><a href="#PlotLadder.plot_ladder_peaks-22"><span class="linenos">22</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">best_combination</span><span class="p">,</span> <span class="n">trace</span><span class="p">[</span><span class="n">best_combination</span><span class="p">],</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
</span><span id="PlotLadder.plot_ladder_peaks-23"><a href="#PlotLadder.plot_ladder_peaks-23"><span class="linenos">23</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
</span><span id="PlotLadder.plot_ladder_peaks-24"><a href="#PlotLadder.plot_ladder_peaks-24"><span class="linenos">24</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Intensity&quot;</span><span class="p">)</span>
</span><span id="PlotLadder.plot_ladder_peaks-25"><a href="#PlotLadder.plot_ladder_peaks-25"><span class="linenos">25</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Trace&quot;</span><span class="p">,</span> <span class="s2">&quot;Peak (bp)&quot;</span><span class="p">])</span>
</span><span id="PlotLadder.plot_ladder_peaks-26"><a href="#PlotLadder.plot_ladder_peaks-26"><span class="linenos">26</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">ladder_name</span><span class="p">)</span>
</span><span id="PlotLadder.plot_ladder_peaks-27"><a href="#PlotLadder.plot_ladder_peaks-27"><span class="linenos">27</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PlotLadder.plot_ladder_peaks-28"><a href="#PlotLadder.plot_ladder_peaks-28"><span class="linenos">28</span></a>
</span><span id="PlotLadder.plot_ladder_peaks-29"><a href="#PlotLadder.plot_ladder_peaks-29"><span class="linenos">29</span></a>        <span class="k">for</span> <span class="n">peak</span><span class="p">,</span> <span class="n">ladder</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">best_combination</span><span class="p">,</span> <span class="n">ladder_size</span><span class="p">):</span>
</span><span id="PlotLadder.plot_ladder_peaks-30"><a href="#PlotLadder.plot_ladder_peaks-30"><span class="linenos">30</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">peak</span><span class="p">,</span> <span class="n">trace</span><span class="p">[</span><span class="n">peak</span><span class="p">],</span> <span class="n">ladder</span><span class="p">)</span>
</span><span id="PlotLadder.plot_ladder_peaks-31"><a href="#PlotLadder.plot_ladder_peaks-31"><span class="linenos">31</span></a>
</span><span id="PlotLadder.plot_ladder_peaks-32"><a href="#PlotLadder.plot_ladder_peaks-32"><span class="linenos">32</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PlotLadder.plot_ladder_peaks-33"><a href="#PlotLadder.plot_ladder_peaks-33"><span class="linenos">33</span></a>        <span class="k">return</span> <span class="n">fig_ladder_peaks</span>
</span></pre></div>


    

                            </div>
                            <div id="PlotLadder.plot_model_fit" class="classattr">
                                        <input id="PlotLadder.plot_model_fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">plot_model_fit</span>

                <label class="view-source-button" for="PlotLadder.plot_model_fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotLadder.plot_model_fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotLadder.plot_model_fit-35"><a href="#PlotLadder.plot_model_fit-35"><span class="linenos">35</span></a>    <span class="nd">@property</span>
</span><span id="PlotLadder.plot_model_fit-36"><a href="#PlotLadder.plot_model_fit-36"><span class="linenos">36</span></a>    <span class="k">def</span> <span class="nf">plot_model_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PlotLadder.plot_model_fit-37"><a href="#PlotLadder.plot_model_fit-37"><span class="linenos">37</span></a>
</span><span id="PlotLadder.plot_model_fit-38"><a href="#PlotLadder.plot_model_fit-38"><span class="linenos">38</span></a>        <span class="n">ladder_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ref_sizes</span>
</span><span id="PlotLadder.plot_model_fit-39"><a href="#PlotLadder.plot_model_fit-39"><span class="linenos">39</span></a>        <span class="n">best_combination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">best_combination</span>
</span><span id="PlotLadder.plot_model_fit-40"><a href="#PlotLadder.plot_model_fit-40"><span class="linenos">40</span></a>
</span><span id="PlotLadder.plot_model_fit-41"><a href="#PlotLadder.plot_model_fit-41"><span class="linenos">41</span></a>        <span class="n">predicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">best_combination</span><span class="p">)</span>
</span><span id="PlotLadder.plot_model_fit-42"><a href="#PlotLadder.plot_model_fit-42"><span class="linenos">42</span></a>        <span class="n">ladder_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">ladder</span>
</span><span id="PlotLadder.plot_model_fit-43"><a href="#PlotLadder.plot_model_fit-43"><span class="linenos">43</span></a>
</span><span id="PlotLadder.plot_model_fit-44"><a href="#PlotLadder.plot_model_fit-44"><span class="linenos">44</span></a>        <span class="n">mse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">mse</span>
</span><span id="PlotLadder.plot_model_fit-45"><a href="#PlotLadder.plot_model_fit-45"><span class="linenos">45</span></a>        <span class="n">r2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">r2</span>
</span><span id="PlotLadder.plot_model_fit-46"><a href="#PlotLadder.plot_model_fit-46"><span class="linenos">46</span></a>
</span><span id="PlotLadder.plot_model_fit-47"><a href="#PlotLadder.plot_model_fit-47"><span class="linenos">47</span></a>        <span class="n">fig_model_fit</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="PlotLadder.plot_model_fit-48"><a href="#PlotLadder.plot_model_fit-48"><span class="linenos">48</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ladder_size</span><span class="p">,</span> <span class="n">best_combination</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span>
</span><span id="PlotLadder.plot_model_fit-49"><a href="#PlotLadder.plot_model_fit-49"><span class="linenos">49</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">best_combination</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="PlotLadder.plot_model_fit-50"><a href="#PlotLadder.plot_model_fit-50"><span class="linenos">50</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ladder_size</span><span class="p">),</span> <span class="mi">50</span><span class="p">))</span>
</span><span id="PlotLadder.plot_model_fit-51"><a href="#PlotLadder.plot_model_fit-51"><span class="linenos">51</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;bp&quot;</span><span class="p">)</span>
</span><span id="PlotLadder.plot_model_fit-52"><a href="#PlotLadder.plot_model_fit-52"><span class="linenos">52</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">best_combination</span><span class="p">),</span> <span class="mi">500</span><span class="p">))</span>
</span><span id="PlotLadder.plot_model_fit-53"><a href="#PlotLadder.plot_model_fit-53"><span class="linenos">53</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">ladder_name</span><span class="p">)</span>
</span><span id="PlotLadder.plot_model_fit-54"><a href="#PlotLadder.plot_model_fit-54"><span class="linenos">54</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mse</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">r2</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PlotLadder.plot_model_fit-55"><a href="#PlotLadder.plot_model_fit-55"><span class="linenos">55</span></a>        <span class="c1"># plt.title(f&quot;{self.model.model[0]=}&quot;)</span>
</span><span id="PlotLadder.plot_model_fit-56"><a href="#PlotLadder.plot_model_fit-56"><span class="linenos">56</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;True value&quot;</span><span class="p">,</span> <span class="s2">&quot;Predicted value&quot;</span><span class="p">])</span>
</span><span id="PlotLadder.plot_model_fit-57"><a href="#PlotLadder.plot_model_fit-57"><span class="linenos">57</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PlotLadder.plot_model_fit-58"><a href="#PlotLadder.plot_model_fit-58"><span class="linenos">58</span></a>
</span><span id="PlotLadder.plot_model_fit-59"><a href="#PlotLadder.plot_model_fit-59"><span class="linenos">59</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PlotLadder.plot_model_fit-60"><a href="#PlotLadder.plot_model_fit-60"><span class="linenos">60</span></a>        <span class="k">return</span> <span class="n">fig_model_fit</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="PlotRawData">
                            <input id="PlotRawData-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PlotRawData</span>:

                <label class="view-source-button" for="PlotRawData-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotRawData"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotRawData-6"><a href="#PlotRawData-6"><span class="linenos"> 6</span></a><span class="k">class</span> <span class="nc">PlotRawData</span><span class="p">:</span>
</span><span id="PlotRawData-7"><a href="#PlotRawData-7"><span class="linenos"> 7</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fsa</span><span class="p">:</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">FsaFile</span><span class="p">):</span>
</span><span id="PlotRawData-8"><a href="#PlotRawData-8"><span class="linenos"> 8</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fsa</span> <span class="o">=</span> <span class="n">fsa</span>
</span><span id="PlotRawData-9"><a href="#PlotRawData-9"><span class="linenos"> 9</span></a>
</span><span id="PlotRawData-10"><a href="#PlotRawData-10"><span class="linenos">10</span></a>    <span class="nd">@property</span>
</span><span id="PlotRawData-11"><a href="#PlotRawData-11"><span class="linenos">11</span></a>    <span class="k">def</span> <span class="nf">plot_raw_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PlotRawData-12"><a href="#PlotRawData-12"><span class="linenos">12</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="PlotRawData-13"><a href="#PlotRawData-13"><span class="linenos">13</span></a>
</span><span id="PlotRawData-14"><a href="#PlotRawData-14"><span class="linenos">14</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
</span><span id="PlotRawData-15"><a href="#PlotRawData-15"><span class="linenos">15</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
</span><span id="PlotRawData-16"><a href="#PlotRawData-16"><span class="linenos">16</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Intensity&quot;</span><span class="p">)</span>
</span><span id="PlotRawData-17"><a href="#PlotRawData-17"><span class="linenos">17</span></a>
</span><span id="PlotRawData-18"><a href="#PlotRawData-18"><span class="linenos">18</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PlotRawData-19"><a href="#PlotRawData-19"><span class="linenos">19</span></a>        <span class="k">return</span> <span class="n">fig</span>
</span></pre></div>


    

                            <div id="PlotRawData.__init__" class="classattr">
                                        <input id="PlotRawData.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PlotRawData</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fsa</span><span class="p">:</span> <span class="n"><a href="#FsaFile">FsaFile</a></span></span>)</span>

                <label class="view-source-button" for="PlotRawData.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotRawData.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotRawData.__init__-7"><a href="#PlotRawData.__init__-7"><span class="linenos">7</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fsa</span><span class="p">:</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">FsaFile</span><span class="p">):</span>
</span><span id="PlotRawData.__init__-8"><a href="#PlotRawData.__init__-8"><span class="linenos">8</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fsa</span> <span class="o">=</span> <span class="n">fsa</span>
</span></pre></div>


    

                            </div>
                            <div id="PlotRawData.fsa" class="classattr">
                                <div class="attr variable">
            <span class="name">fsa</span>

        
    </div>
    <a class="headerlink" href="#PlotRawData.fsa"></a>
    
    

                            </div>
                            <div id="PlotRawData.plot_raw_data" class="classattr">
                                        <input id="PlotRawData.plot_raw_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">plot_raw_data</span>

                <label class="view-source-button" for="PlotRawData.plot_raw_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotRawData.plot_raw_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotRawData.plot_raw_data-10"><a href="#PlotRawData.plot_raw_data-10"><span class="linenos">10</span></a>    <span class="nd">@property</span>
</span><span id="PlotRawData.plot_raw_data-11"><a href="#PlotRawData.plot_raw_data-11"><span class="linenos">11</span></a>    <span class="k">def</span> <span class="nf">plot_raw_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PlotRawData.plot_raw_data-12"><a href="#PlotRawData.plot_raw_data-12"><span class="linenos">12</span></a>        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="PlotRawData.plot_raw_data-13"><a href="#PlotRawData.plot_raw_data-13"><span class="linenos">13</span></a>
</span><span id="PlotRawData.plot_raw_data-14"><a href="#PlotRawData.plot_raw_data-14"><span class="linenos">14</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsa</span><span class="o">.</span><span class="n">trace</span><span class="p">)</span>
</span><span id="PlotRawData.plot_raw_data-15"><a href="#PlotRawData.plot_raw_data-15"><span class="linenos">15</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
</span><span id="PlotRawData.plot_raw_data-16"><a href="#PlotRawData.plot_raw_data-16"><span class="linenos">16</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Intensity&quot;</span><span class="p">)</span>
</span><span id="PlotRawData.plot_raw_data-17"><a href="#PlotRawData.plot_raw_data-17"><span class="linenos">17</span></a>
</span><span id="PlotRawData.plot_raw_data-18"><a href="#PlotRawData.plot_raw_data-18"><span class="linenos">18</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PlotRawData.plot_raw_data-19"><a href="#PlotRawData.plot_raw_data-19"><span class="linenos">19</span></a>        <span class="k">return</span> <span class="n">fig</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="PlotPeaks">
                            <input id="PlotPeaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PlotPeaks</span>:

                <label class="view-source-button" for="PlotPeaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotPeaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotPeaks-7"><a href="#PlotPeaks-7"><span class="linenos"> 7</span></a><span class="k">class</span> <span class="nc">PlotPeaks</span><span class="p">:</span>
</span><span id="PlotPeaks-8"><a href="#PlotPeaks-8"><span class="linenos"> 8</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peaks</span><span class="p">:</span> <span class="n">PeakFinder</span><span class="p">):</span>
</span><span id="PlotPeaks-9"><a href="#PlotPeaks-9"><span class="linenos"> 9</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span> <span class="o">=</span> <span class="n">peaks</span>
</span><span id="PlotPeaks-10"><a href="#PlotPeaks-10"><span class="linenos">10</span></a>
</span><span id="PlotPeaks-11"><a href="#PlotPeaks-11"><span class="linenos">11</span></a>    <span class="nd">@property</span>
</span><span id="PlotPeaks-12"><a href="#PlotPeaks-12"><span class="linenos">12</span></a>    <span class="k">def</span> <span class="nf">plot_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PlotPeaks-13"><a href="#PlotPeaks-13"><span class="linenos">13</span></a>        <span class="n">fig_peaks</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="PlotPeaks-14"><a href="#PlotPeaks-14"><span class="linenos">14</span></a>
</span><span id="PlotPeaks-15"><a href="#PlotPeaks-15"><span class="linenos">15</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="PlotPeaks-16"><a href="#PlotPeaks-16"><span class="linenos">16</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">10</span>
</span><span id="PlotPeaks-17"><a href="#PlotPeaks-17"><span class="linenos">17</span></a>        <span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span>
</span><span id="PlotPeaks-18"><a href="#PlotPeaks-18"><span class="linenos">18</span></a>
</span><span id="PlotPeaks-19"><a href="#PlotPeaks-19"><span class="linenos">19</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">peaks</span><span class="p">)</span>
</span><span id="PlotPeaks-20"><a href="#PlotPeaks-20"><span class="linenos">20</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PlotPeaks-21"><a href="#PlotPeaks-21"><span class="linenos">21</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span>
</span><span id="PlotPeaks-22"><a href="#PlotPeaks-22"><span class="linenos">22</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="PlotPeaks-23"><a href="#PlotPeaks-23"><span class="linenos">23</span></a>            <span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span id="PlotPeaks-24"><a href="#PlotPeaks-24"><span class="linenos">24</span></a>        <span class="p">)</span>
</span><span id="PlotPeaks-25"><a href="#PlotPeaks-25"><span class="linenos">25</span></a>        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="PlotPeaks-26"><a href="#PlotPeaks-26"><span class="linenos">26</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span>
</span><span id="PlotPeaks-27"><a href="#PlotPeaks-27"><span class="linenos">27</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="PlotPeaks-28"><a href="#PlotPeaks-28"><span class="linenos">28</span></a>        <span class="p">):</span>
</span><span id="PlotPeaks-29"><a href="#PlotPeaks-29"><span class="linenos">29</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> bp&quot;</span><span class="p">)</span>
</span><span id="PlotPeaks-30"><a href="#PlotPeaks-30"><span class="linenos">30</span></a>
</span><span id="PlotPeaks-31"><a href="#PlotPeaks-31"><span class="linenos">31</span></a>        <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">trace_channel</span>
</span><span id="PlotPeaks-32"><a href="#PlotPeaks-32"><span class="linenos">32</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Channel: </span><span class="si">{</span><span class="n">channel</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PlotPeaks-33"><a href="#PlotPeaks-33"><span class="linenos">33</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">10</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="PlotPeaks-34"><a href="#PlotPeaks-34"><span class="linenos">34</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;intensity&quot;</span><span class="p">)</span>
</span><span id="PlotPeaks-35"><a href="#PlotPeaks-35"><span class="linenos">35</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;basepairs&quot;</span><span class="p">)</span>
</span><span id="PlotPeaks-36"><a href="#PlotPeaks-36"><span class="linenos">36</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PlotPeaks-37"><a href="#PlotPeaks-37"><span class="linenos">37</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PlotPeaks-38"><a href="#PlotPeaks-38"><span class="linenos">38</span></a>
</span><span id="PlotPeaks-39"><a href="#PlotPeaks-39"><span class="linenos">39</span></a>        <span class="k">return</span> <span class="n">fig_peaks</span>
</span></pre></div>


    

                            <div id="PlotPeaks.__init__" class="classattr">
                                        <input id="PlotPeaks.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PlotPeaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">peaks</span><span class="p">:</span> <span class="n"><a href="#PeakFinder">PeakFinder</a></span></span>)</span>

                <label class="view-source-button" for="PlotPeaks.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotPeaks.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotPeaks.__init__-8"><a href="#PlotPeaks.__init__-8"><span class="linenos">8</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peaks</span><span class="p">:</span> <span class="n">PeakFinder</span><span class="p">):</span>
</span><span id="PlotPeaks.__init__-9"><a href="#PlotPeaks.__init__-9"><span class="linenos">9</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span> <span class="o">=</span> <span class="n">peaks</span>
</span></pre></div>


    

                            </div>
                            <div id="PlotPeaks.peaks" class="classattr">
                                <div class="attr variable">
            <span class="name">peaks</span>

        
    </div>
    <a class="headerlink" href="#PlotPeaks.peaks"></a>
    
    

                            </div>
                            <div id="PlotPeaks.plot_peaks" class="classattr">
                                        <input id="PlotPeaks.plot_peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">plot_peaks</span>

                <label class="view-source-button" for="PlotPeaks.plot_peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PlotPeaks.plot_peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PlotPeaks.plot_peaks-11"><a href="#PlotPeaks.plot_peaks-11"><span class="linenos">11</span></a>    <span class="nd">@property</span>
</span><span id="PlotPeaks.plot_peaks-12"><a href="#PlotPeaks.plot_peaks-12"><span class="linenos">12</span></a>    <span class="k">def</span> <span class="nf">plot_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PlotPeaks.plot_peaks-13"><a href="#PlotPeaks.plot_peaks-13"><span class="linenos">13</span></a>        <span class="n">fig_peaks</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="PlotPeaks.plot_peaks-14"><a href="#PlotPeaks.plot_peaks-14"><span class="linenos">14</span></a>
</span><span id="PlotPeaks.plot_peaks-15"><a href="#PlotPeaks.plot_peaks-15"><span class="linenos">15</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="PlotPeaks.plot_peaks-16"><a href="#PlotPeaks.plot_peaks-16"><span class="linenos">16</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">10</span>
</span><span id="PlotPeaks.plot_peaks-17"><a href="#PlotPeaks.plot_peaks-17"><span class="linenos">17</span></a>        <span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">10</span><span class="p">]</span>
</span><span id="PlotPeaks.plot_peaks-18"><a href="#PlotPeaks.plot_peaks-18"><span class="linenos">18</span></a>
</span><span id="PlotPeaks.plot_peaks-19"><a href="#PlotPeaks.plot_peaks-19"><span class="linenos">19</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">peaks</span><span class="p">)</span>
</span><span id="PlotPeaks.plot_peaks-20"><a href="#PlotPeaks.plot_peaks-20"><span class="linenos">20</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="PlotPeaks.plot_peaks-21"><a href="#PlotPeaks.plot_peaks-21"><span class="linenos">21</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span>
</span><span id="PlotPeaks.plot_peaks-22"><a href="#PlotPeaks.plot_peaks-22"><span class="linenos">22</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="PlotPeaks.plot_peaks-23"><a href="#PlotPeaks.plot_peaks-23"><span class="linenos">23</span></a>            <span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span id="PlotPeaks.plot_peaks-24"><a href="#PlotPeaks.plot_peaks-24"><span class="linenos">24</span></a>        <span class="p">)</span>
</span><span id="PlotPeaks.plot_peaks-25"><a href="#PlotPeaks.plot_peaks-25"><span class="linenos">25</span></a>        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="PlotPeaks.plot_peaks-26"><a href="#PlotPeaks.plot_peaks-26"><span class="linenos">26</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">basepairs</span><span class="p">,</span>
</span><span id="PlotPeaks.plot_peaks-27"><a href="#PlotPeaks.plot_peaks-27"><span class="linenos">27</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="PlotPeaks.plot_peaks-28"><a href="#PlotPeaks.plot_peaks-28"><span class="linenos">28</span></a>        <span class="p">):</span>
</span><span id="PlotPeaks.plot_peaks-29"><a href="#PlotPeaks.plot_peaks-29"><span class="linenos">29</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> bp&quot;</span><span class="p">)</span>
</span><span id="PlotPeaks.plot_peaks-30"><a href="#PlotPeaks.plot_peaks-30"><span class="linenos">30</span></a>
</span><span id="PlotPeaks.plot_peaks-31"><a href="#PlotPeaks.plot_peaks-31"><span class="linenos">31</span></a>        <span class="n">channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">trace_channel</span>
</span><span id="PlotPeaks.plot_peaks-32"><a href="#PlotPeaks.plot_peaks-32"><span class="linenos">32</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Channel: </span><span class="si">{</span><span class="n">channel</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PlotPeaks.plot_peaks-33"><a href="#PlotPeaks.plot_peaks-33"><span class="linenos">33</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">10</span><span class="p">),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</span><span id="PlotPeaks.plot_peaks-34"><a href="#PlotPeaks.plot_peaks-34"><span class="linenos">34</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;intensity&quot;</span><span class="p">)</span>
</span><span id="PlotPeaks.plot_peaks-35"><a href="#PlotPeaks.plot_peaks-35"><span class="linenos">35</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;basepairs&quot;</span><span class="p">)</span>
</span><span id="PlotPeaks.plot_peaks-36"><a href="#PlotPeaks.plot_peaks-36"><span class="linenos">36</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</span><span id="PlotPeaks.plot_peaks-37"><a href="#PlotPeaks.plot_peaks-37"><span class="linenos">37</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="PlotPeaks.plot_peaks-38"><a href="#PlotPeaks.plot_peaks-38"><span class="linenos">38</span></a>
</span><span id="PlotPeaks.plot_peaks-39"><a href="#PlotPeaks.plot_peaks-39"><span class="linenos">39</span></a>        <span class="k">return</span> <span class="n">fig_peaks</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="generate_peak_table">
                            <input id="generate_peak_table-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_peak_table</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">in_files</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="generate_peak_table-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_peak_table"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_peak_table-8"><a href="#generate_peak_table-8"><span class="linenos"> 8</span></a><span class="k">def</span> <span class="nf">generate_peak_table</span><span class="p">(</span>
</span><span id="generate_peak_table-9"><a href="#generate_peak_table-9"><span class="linenos"> 9</span></a>    <span class="n">in_files</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="generate_peak_table-10"><a href="#generate_peak_table-10"><span class="linenos">10</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="generate_peak_table-11"><a href="#generate_peak_table-11"><span class="linenos">11</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">in_files</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="generate_peak_table-12"><a href="#generate_peak_table-12"><span class="linenos">12</span></a>        <span class="n">in_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">in_files</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.fsa&quot;</span><span class="p">]</span>
</span><span id="generate_peak_table-13"><a href="#generate_peak_table-13"><span class="linenos">13</span></a>
</span><span id="generate_peak_table-14"><a href="#generate_peak_table-14"><span class="linenos">14</span></a>    <span class="n">peak_dfs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="generate_peak_table-15"><a href="#generate_peak_table-15"><span class="linenos">15</span></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">in_files</span><span class="p">:</span>
</span><span id="generate_peak_table-16"><a href="#generate_peak_table-16"><span class="linenos">16</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="generate_peak_table-17"><a href="#generate_peak_table-17"><span class="linenos">17</span></a>            <span class="n">fsa</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">FsaFile</span><span class="p">(</span>
</span><span id="generate_peak_table-18"><a href="#generate_peak_table-18"><span class="linenos">18</span></a>                <span class="n">x</span><span class="p">,</span> <span class="n">ladder</span><span class="p">,</span> <span class="n">min_height</span><span class="o">=</span><span class="n">min_height</span><span class="p">,</span> <span class="n">trace_channel</span><span class="o">=</span><span class="n">trace_channel</span>
</span><span id="generate_peak_table-19"><a href="#generate_peak_table-19"><span class="linenos">19</span></a>            <span class="p">)</span>
</span><span id="generate_peak_table-20"><a href="#generate_peak_table-20"><span class="linenos">20</span></a>            <span class="n">pla</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">PeakLadderAssigner</span><span class="p">(</span><span class="n">fsa</span><span class="p">)</span>
</span><span id="generate_peak_table-21"><a href="#generate_peak_table-21"><span class="linenos">21</span></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">FitLadderModel</span><span class="p">(</span><span class="n">pla</span><span class="p">)</span>
</span><span id="generate_peak_table-22"><a href="#generate_peak_table-22"><span class="linenos">22</span></a>            <span class="n">pam</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">PeakAreaDeMultiplex</span><span class="p">(</span>
</span><span id="generate_peak_table-23"><a href="#generate_peak_table-23"><span class="linenos">23</span></a>                <span class="n">model</span><span class="p">,</span>
</span><span id="generate_peak_table-24"><a href="#generate_peak_table-24"><span class="linenos">24</span></a>                <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="generate_peak_table-25"><a href="#generate_peak_table-25"><span class="linenos">25</span></a>                <span class="n">min_ratio</span><span class="o">=</span><span class="n">min_ratio</span><span class="p">,</span>
</span><span id="generate_peak_table-26"><a href="#generate_peak_table-26"><span class="linenos">26</span></a>                <span class="n">custom_peaks</span><span class="o">=</span><span class="n">custom_peaks</span><span class="p">,</span>
</span><span id="generate_peak_table-27"><a href="#generate_peak_table-27"><span class="linenos">27</span></a>            <span class="p">)</span>
</span><span id="generate_peak_table-28"><a href="#generate_peak_table-28"><span class="linenos">28</span></a>            <span class="n">peak_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pam</span><span class="o">.</span><span class="n">assays_dataframe</span><span class="p">(</span><span class="n">peak_model</span><span class="p">))</span>
</span><span id="generate_peak_table-29"><a href="#generate_peak_table-29"><span class="linenos">29</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="generate_peak_table-30"><a href="#generate_peak_table-30"><span class="linenos">30</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FAILED: </span><span class="si">{</span><span class="n">fsa</span><span class="o">.</span><span class="n">file_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="generate_peak_table-31"><a href="#generate_peak_table-31"><span class="linenos">31</span></a>
</span><span id="generate_peak_table-32"><a href="#generate_peak_table-32"><span class="linenos">32</span></a>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">peak_dfs</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="get_files">
                            <input id="get_files-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_files</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">in_path</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="get_files-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_files"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_files-7"><a href="#get_files-7"><span class="linenos"> 7</span></a><span class="k">def</span> <span class="nf">get_files</span><span class="p">(</span><span class="n">in_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
</span><span id="get_files-8"><a href="#get_files-8"><span class="linenos"> 8</span></a>    <span class="c1"># If in_path is a directory, get a list of all .fsa files in it</span>
</span><span id="get_files-9"><a href="#get_files-9"><span class="linenos"> 9</span></a>    <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">in_path</span><span class="p">)</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
</span><span id="get_files-10"><a href="#get_files-10"><span class="linenos">10</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">in_path</span><span class="p">)</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.fsa&quot;</span><span class="p">]</span>
</span><span id="get_files-11"><a href="#get_files-11"><span class="linenos">11</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="get_files-12"><a href="#get_files-12"><span class="linenos">12</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">in_path</span><span class="p">)]</span>
</span><span id="get_files-13"><a href="#get_files-13"><span class="linenos">13</span></a>    <span class="k">return</span> <span class="n">files</span>
</span></pre></div>


    

                </section>
                <section id="setup_logging">
                            <input id="setup_logging-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">setup_logging</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">outdir</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="setup_logging-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#setup_logging"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="setup_logging-16"><a href="#setup_logging-16"><span class="linenos">16</span></a><span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span><span class="n">outdir</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="setup_logging-17"><a href="#setup_logging-17"><span class="linenos">17</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="setup_logging-18"><a href="#setup_logging-18"><span class="linenos">18</span></a><span class="sd">    Set up the logging object and saves the log file to the same dir as the results files.</span>
</span><span id="setup_logging-19"><a href="#setup_logging-19"><span class="linenos">19</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="setup_logging-20"><a href="#setup_logging-20"><span class="linenos">20</span></a>    <span class="n">NOW</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H:%M&quot;</span><span class="p">)</span>
</span><span id="setup_logging-21"><a href="#setup_logging-21"><span class="linenos">21</span></a>
</span><span id="setup_logging-22"><a href="#setup_logging-22"><span class="linenos">22</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">outdir</span> <span class="o">:=</span> <span class="n">Path</span><span class="p">(</span><span class="n">outdir</span><span class="p">))</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="setup_logging-23"><a href="#setup_logging-23"><span class="linenos">23</span></a>        <span class="n">outdir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="setup_logging-24"><a href="#setup_logging-24"><span class="linenos">24</span></a>
</span><span id="setup_logging-25"><a href="#setup_logging-25"><span class="linenos">25</span></a>    <span class="n">LOG_FILE</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outdir</span><span class="si">}</span><span class="s2">/fraggler_</span><span class="si">{</span><span class="n">NOW</span><span class="si">}</span><span class="s2">.log&quot;</span>
</span><span id="setup_logging-26"><a href="#setup_logging-26"><span class="linenos">26</span></a>
</span><span id="setup_logging-27"><a href="#setup_logging-27"><span class="linenos">27</span></a>    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
</span><span id="setup_logging-28"><a href="#setup_logging-28"><span class="linenos">28</span></a>        <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
</span><span id="setup_logging-29"><a href="#setup_logging-29"><span class="linenos">29</span></a>        <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> [</span><span class="si">%(levelname)s</span><span class="s2">] </span><span class="se">\n</span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="setup_logging-30"><a href="#setup_logging-30"><span class="linenos">30</span></a>        <span class="n">datefmt</span><span class="o">=</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %I:%M:%S&quot;</span><span class="p">,</span>
</span><span id="setup_logging-31"><a href="#setup_logging-31"><span class="linenos">31</span></a>        <span class="n">handlers</span><span class="o">=</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">LOG_FILE</span><span class="p">),</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()],</span>
</span><span id="setup_logging-32"><a href="#setup_logging-32"><span class="linenos">32</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set up the logging object and saves the log file to the same dir as the results files.</p>
</div>


                </section>
                <section id="make_fsa_data_df">
                            <input id="make_fsa_data_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">make_fsa_data_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fsa</span>, </span><span class="param"><span class="n">ladder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="make_fsa_data_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#make_fsa_data_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="make_fsa_data_df-6"><a href="#make_fsa_data_df-6"><span class="linenos"> 6</span></a><span class="k">def</span> <span class="nf">make_fsa_data_df</span><span class="p">(</span><span class="n">fsa</span><span class="p">,</span> <span class="n">ladder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="make_fsa_data_df-7"><a href="#make_fsa_data_df-7"><span class="linenos"> 7</span></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DATA1&quot;</span><span class="p">,</span> <span class="s2">&quot;DATA2&quot;</span><span class="p">,</span> <span class="s2">&quot;DATA3&quot;</span><span class="p">,</span> <span class="s2">&quot;DATA4&quot;</span><span class="p">]</span>
</span><span id="make_fsa_data_df-8"><a href="#make_fsa_data_df-8"><span class="linenos"> 8</span></a>    <span class="k">if</span> <span class="n">ladder</span><span class="p">:</span>
</span><span id="make_fsa_data_df-9"><a href="#make_fsa_data_df-9"><span class="linenos"> 9</span></a>        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;DATA205&quot;</span><span class="p">)</span>
</span><span id="make_fsa_data_df-10"><a href="#make_fsa_data_df-10"><span class="linenos">10</span></a>    <span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="make_fsa_data_df-11"><a href="#make_fsa_data_df-11"><span class="linenos">11</span></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span><span id="make_fsa_data_df-12"><a href="#make_fsa_data_df-12"><span class="linenos">12</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="make_fsa_data_df-13"><a href="#make_fsa_data_df-13"><span class="linenos">13</span></a>            <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="make_fsa_data_df-14"><a href="#make_fsa_data_df-14"><span class="linenos">14</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">fsa</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
</span><span id="make_fsa_data_df-15"><a href="#make_fsa_data_df-15"><span class="linenos">15</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
</span><span id="make_fsa_data_df-16"><a href="#make_fsa_data_df-16"><span class="linenos">16</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="make_fsa_data_df-17"><a href="#make_fsa_data_df-17"><span class="linenos">17</span></a>        <span class="p">)</span>
</span><span id="make_fsa_data_df-18"><a href="#make_fsa_data_df-18"><span class="linenos">18</span></a>        <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="make_fsa_data_df-19"><a href="#make_fsa_data_df-19"><span class="linenos">19</span></a>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="plot_fsa_data">
                            <input id="plot_fsa_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_fsa_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fsa</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">ladder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="plot_fsa_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#plot_fsa_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="plot_fsa_data-22"><a href="#plot_fsa_data-22"><span class="linenos">22</span></a><span class="k">def</span> <span class="nf">plot_fsa_data</span><span class="p">(</span><span class="n">fsa</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ladder</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="plot_fsa_data-23"><a href="#plot_fsa_data-23"><span class="linenos">23</span></a>    <span class="n">alt</span><span class="o">.</span><span class="n">data_transformers</span><span class="o">.</span><span class="n">disable_max_rows</span><span class="p">()</span>
</span><span id="plot_fsa_data-24"><a href="#plot_fsa_data-24"><span class="linenos">24</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">make_fsa_data_df</span><span class="p">(</span><span class="n">fsa</span><span class="p">,</span> <span class="n">ladder</span><span class="p">)</span>
</span><span id="plot_fsa_data-25"><a href="#plot_fsa_data-25"><span class="linenos">25</span></a>
</span><span id="plot_fsa_data-26"><a href="#plot_fsa_data-26"><span class="linenos">26</span></a>    <span class="n">plots</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="plot_fsa_data-27"><a href="#plot_fsa_data-27"><span class="linenos">27</span></a>    <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">channel</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
</span><span id="plot_fsa_data-28"><a href="#plot_fsa_data-28"><span class="linenos">28</span></a>        <span class="n">plot</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="plot_fsa_data-29"><a href="#plot_fsa_data-29"><span class="linenos">29</span></a>            <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="n">channel</span><span class="p">])</span>
</span><span id="plot_fsa_data-30"><a href="#plot_fsa_data-30"><span class="linenos">30</span></a>            <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
</span><span id="plot_fsa_data-31"><a href="#plot_fsa_data-31"><span class="linenos">31</span></a>            <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
</span><span id="plot_fsa_data-32"><a href="#plot_fsa_data-32"><span class="linenos">32</span></a>                <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;time:Q&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">),</span>
</span><span id="plot_fsa_data-33"><a href="#plot_fsa_data-33"><span class="linenos">33</span></a>                <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;data:Q&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Intensity&quot;</span><span class="p">),</span>
</span><span id="plot_fsa_data-34"><a href="#plot_fsa_data-34"><span class="linenos">34</span></a>                <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;channel:N&quot;</span><span class="p">),</span>
</span><span id="plot_fsa_data-35"><a href="#plot_fsa_data-35"><span class="linenos">35</span></a>            <span class="p">)</span>
</span><span id="plot_fsa_data-36"><a href="#plot_fsa_data-36"><span class="linenos">36</span></a>            <span class="o">.</span><span class="n">properties</span><span class="p">(</span>
</span><span id="plot_fsa_data-37"><a href="#plot_fsa_data-37"><span class="linenos">37</span></a>                <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
</span><span id="plot_fsa_data-38"><a href="#plot_fsa_data-38"><span class="linenos">38</span></a>                <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
</span><span id="plot_fsa_data-39"><a href="#plot_fsa_data-39"><span class="linenos">39</span></a>            <span class="p">)</span>  <span class="c1"># .interactive()</span>
</span><span id="plot_fsa_data-40"><a href="#plot_fsa_data-40"><span class="linenos">40</span></a>        <span class="p">)</span>
</span><span id="plot_fsa_data-41"><a href="#plot_fsa_data-41"><span class="linenos">41</span></a>        <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">plot</span><span class="p">,</span> <span class="n">channel</span><span class="p">))</span>
</span><span id="plot_fsa_data-42"><a href="#plot_fsa_data-42"><span class="linenos">42</span></a>
</span><span id="plot_fsa_data-43"><a href="#plot_fsa_data-43"><span class="linenos">43</span></a>    <span class="n">all_data</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="plot_fsa_data-44"><a href="#plot_fsa_data-44"><span class="linenos">44</span></a>        <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="plot_fsa_data-45"><a href="#plot_fsa_data-45"><span class="linenos">45</span></a>        <span class="o">.</span><span class="n">mark_line</span><span class="p">()</span>
</span><span id="plot_fsa_data-46"><a href="#plot_fsa_data-46"><span class="linenos">46</span></a>        <span class="o">.</span><span class="n">encode</span><span class="p">(</span>
</span><span id="plot_fsa_data-47"><a href="#plot_fsa_data-47"><span class="linenos">47</span></a>            <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;time:Q&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Time&quot;</span><span class="p">),</span>
</span><span id="plot_fsa_data-48"><a href="#plot_fsa_data-48"><span class="linenos">48</span></a>            <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s2">&quot;data:Q&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Intensity&quot;</span><span class="p">),</span>
</span><span id="plot_fsa_data-49"><a href="#plot_fsa_data-49"><span class="linenos">49</span></a>            <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;channel:N&quot;</span><span class="p">),</span>
</span><span id="plot_fsa_data-50"><a href="#plot_fsa_data-50"><span class="linenos">50</span></a>        <span class="p">)</span>
</span><span id="plot_fsa_data-51"><a href="#plot_fsa_data-51"><span class="linenos">51</span></a>        <span class="o">.</span><span class="n">properties</span><span class="p">(</span>
</span><span id="plot_fsa_data-52"><a href="#plot_fsa_data-52"><span class="linenos">52</span></a>            <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
</span><span id="plot_fsa_data-53"><a href="#plot_fsa_data-53"><span class="linenos">53</span></a>            <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
</span><span id="plot_fsa_data-54"><a href="#plot_fsa_data-54"><span class="linenos">54</span></a>        <span class="p">)</span>  <span class="c1"># .interactive()</span>
</span><span id="plot_fsa_data-55"><a href="#plot_fsa_data-55"><span class="linenos">55</span></a>    <span class="p">)</span>
</span><span id="plot_fsa_data-56"><a href="#plot_fsa_data-56"><span class="linenos">56</span></a>    <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">all_data</span><span class="p">,</span> <span class="s2">&quot;All channels&quot;</span><span class="p">))</span>
</span><span id="plot_fsa_data-57"><a href="#plot_fsa_data-57"><span class="linenos">57</span></a>    <span class="k">return</span> <span class="n">plots</span>
</span></pre></div>


    

                </section>
                <section id="PeakFinder">
                            <input id="PeakFinder-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PeakFinder</span>:

                <label class="view-source-button" for="PeakFinder-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakFinder"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakFinder-75"><a href="#PeakFinder-75"><span class="linenos"> 75</span></a><span class="k">class</span> <span class="nc">PeakFinder</span><span class="p">:</span>
</span><span id="PeakFinder-76"><a href="#PeakFinder-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="PeakFinder-77"><a href="#PeakFinder-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakFinder-78"><a href="#PeakFinder-78"><span class="linenos"> 78</span></a>        <span class="n">model</span><span class="p">:</span> <span class="n">FitLadderModel</span><span class="p">,</span>
</span><span id="PeakFinder-79"><a href="#PeakFinder-79"><span class="linenos"> 79</span></a>        <span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span>
</span><span id="PeakFinder-80"><a href="#PeakFinder-80"><span class="linenos"> 80</span></a>        <span class="n">search_peaks_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">110</span><span class="p">,</span>
</span><span id="PeakFinder-81"><a href="#PeakFinder-81"><span class="linenos"> 81</span></a>        <span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span>
</span><span id="PeakFinder-82"><a href="#PeakFinder-82"><span class="linenos"> 82</span></a>        <span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
</span><span id="PeakFinder-83"><a href="#PeakFinder-83"><span class="linenos"> 83</span></a>        <span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PeakFinder-84"><a href="#PeakFinder-84"><span class="linenos"> 84</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakFinder-85"><a href="#PeakFinder-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
</span><span id="PeakFinder-86"><a href="#PeakFinder-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">adjusted_baisepair_df</span>
</span><span id="PeakFinder-87"><a href="#PeakFinder-87"><span class="linenos"> 87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">file_name</span>
</span><span id="PeakFinder-88"><a href="#PeakFinder-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">search_peaks_start</span> <span class="o">=</span> <span class="n">search_peaks_start</span>
</span><span id="PeakFinder-89"><a href="#PeakFinder-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_height</span> <span class="o">=</span> <span class="n">peak_height</span>
</span><span id="PeakFinder-90"><a href="#PeakFinder-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_ratio</span> <span class="o">=</span> <span class="n">min_ratio</span>
</span><span id="PeakFinder-91"><a href="#PeakFinder-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance_between_assays</span> <span class="o">=</span> <span class="n">distance_between_assays</span>
</span><span id="PeakFinder-92"><a href="#PeakFinder-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder-93"><a href="#PeakFinder-93"><span class="linenos"> 93</span></a>            <span class="n">custom_peaks</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="PeakFinder-94"><a href="#PeakFinder-94"><span class="linenos"> 94</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">custom_peaks</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="PeakFinder-95"><a href="#PeakFinder-95"><span class="linenos"> 95</span></a>            <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">custom_peaks</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="PeakFinder-96"><a href="#PeakFinder-96"><span class="linenos"> 96</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">custom_peaks</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="PeakFinder-97"><a href="#PeakFinder-97"><span class="linenos"> 97</span></a>            <span class="k">else</span> <span class="kc">None</span>
</span><span id="PeakFinder-98"><a href="#PeakFinder-98"><span class="linenos"> 98</span></a>        <span class="p">)</span>
</span><span id="PeakFinder-99"><a href="#PeakFinder-99"><span class="linenos"> 99</span></a>
</span><span id="PeakFinder-100"><a href="#PeakFinder-100"><span class="linenos">100</span></a>        <span class="c1"># Validation of custom_peaks</span>
</span><span id="PeakFinder-101"><a href="#PeakFinder-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run_validation</span><span class="p">()</span>
</span><span id="PeakFinder-102"><a href="#PeakFinder-102"><span class="linenos">102</span></a>        <span class="c1"># find peaks, custom or agnostic</span>
</span><span id="PeakFinder-103"><a href="#PeakFinder-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">()</span>
</span><span id="PeakFinder-104"><a href="#PeakFinder-104"><span class="linenos">104</span></a>        <span class="c1"># continue whether peaks are found or not.</span>
</span><span id="PeakFinder-105"><a href="#PeakFinder-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">found_peaks</span><span class="p">()</span>
</span><span id="PeakFinder-106"><a href="#PeakFinder-106"><span class="linenos">106</span></a>
</span><span id="PeakFinder-107"><a href="#PeakFinder-107"><span class="linenos">107</span></a>    <span class="k">def</span> <span class="nf">run_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PeakFinder-108"><a href="#PeakFinder-108"><span class="linenos">108</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakFinder-109"><a href="#PeakFinder-109"><span class="linenos">109</span></a>            <span class="k">return</span>
</span><span id="PeakFinder-110"><a href="#PeakFinder-110"><span class="linenos">110</span></a>
</span><span id="PeakFinder-111"><a href="#PeakFinder-111"><span class="linenos">111</span></a>        <span class="k">if</span> <span class="n">is_overlapping</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span><span class="p">):</span>
</span><span id="PeakFinder-112"><a href="#PeakFinder-112"><span class="linenos">112</span></a>            <span class="k">raise</span> <span class="n">OverlappingIntervalError</span><span class="p">(</span><span class="s2">&quot;Overlapping intervals!&quot;</span><span class="p">)</span>
</span><span id="PeakFinder-113"><a href="#PeakFinder-113"><span class="linenos">113</span></a>            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PeakFinder-114"><a href="#PeakFinder-114"><span class="linenos">114</span></a>
</span><span id="PeakFinder-115"><a href="#PeakFinder-115"><span class="linenos">115</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">has_columns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span><span class="p">):</span>
</span><span id="PeakFinder-116"><a href="#PeakFinder-116"><span class="linenos">116</span></a>            <span class="k">raise</span> <span class="n">WrongColumnsError</span><span class="p">(</span><span class="s2">&quot;Wrong columns!&quot;</span><span class="p">)</span>
</span><span id="PeakFinder-117"><a href="#PeakFinder-117"><span class="linenos">117</span></a>            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PeakFinder-118"><a href="#PeakFinder-118"><span class="linenos">118</span></a>
</span><span id="PeakFinder-119"><a href="#PeakFinder-119"><span class="linenos">119</span></a>    <span class="k">def</span> <span class="nf">find_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PeakFinder-120"><a href="#PeakFinder-120"><span class="linenos">120</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakFinder-121"><a href="#PeakFinder-121"><span class="linenos">121</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks_customized</span><span class="p">(</span>
</span><span id="PeakFinder-122"><a href="#PeakFinder-122"><span class="linenos">122</span></a>                <span class="n">peak_height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_height</span><span class="p">,</span>
</span><span id="PeakFinder-123"><a href="#PeakFinder-123"><span class="linenos">123</span></a>            <span class="p">)</span>
</span><span id="PeakFinder-124"><a href="#PeakFinder-124"><span class="linenos">124</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PeakFinder-125"><a href="#PeakFinder-125"><span class="linenos">125</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks_agnostic</span><span class="p">(</span>
</span><span id="PeakFinder-126"><a href="#PeakFinder-126"><span class="linenos">126</span></a>                <span class="n">peak_height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_height</span><span class="p">,</span>
</span><span id="PeakFinder-127"><a href="#PeakFinder-127"><span class="linenos">127</span></a>                <span class="n">min_ratio</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_ratio</span><span class="p">,</span>
</span><span id="PeakFinder-128"><a href="#PeakFinder-128"><span class="linenos">128</span></a>                <span class="n">distance_between_assays</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_between_assays</span><span class="p">,</span>
</span><span id="PeakFinder-129"><a href="#PeakFinder-129"><span class="linenos">129</span></a>            <span class="p">)</span>
</span><span id="PeakFinder-130"><a href="#PeakFinder-130"><span class="linenos">130</span></a>
</span><span id="PeakFinder-131"><a href="#PeakFinder-131"><span class="linenos">131</span></a>    <span class="k">def</span> <span class="nf">found_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PeakFinder-132"><a href="#PeakFinder-132"><span class="linenos">132</span></a>        <span class="c1"># if no peaks could be found</span>
</span><span id="PeakFinder-133"><a href="#PeakFinder-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PeakFinder-134"><a href="#PeakFinder-134"><span class="linenos">134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">found_peaks</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PeakFinder-135"><a href="#PeakFinder-135"><span class="linenos">135</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No peaks could be found. Please look at raw data.&quot;</span><span class="p">)</span>
</span><span id="PeakFinder-136"><a href="#PeakFinder-136"><span class="linenos">136</span></a>        <span class="c1"># if peaks are found</span>
</span><span id="PeakFinder-137"><a href="#PeakFinder-137"><span class="linenos">137</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PeakFinder-138"><a href="#PeakFinder-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">found_peaks</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PeakFinder-139"><a href="#PeakFinder-139"><span class="linenos">139</span></a>
</span><span id="PeakFinder-140"><a href="#PeakFinder-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">find_peaks_agnostic</span><span class="p">(</span>
</span><span id="PeakFinder-141"><a href="#PeakFinder-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakFinder-142"><a href="#PeakFinder-142"><span class="linenos">142</span></a>        <span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PeakFinder-143"><a href="#PeakFinder-143"><span class="linenos">143</span></a>        <span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="PeakFinder-144"><a href="#PeakFinder-144"><span class="linenos">144</span></a>        <span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PeakFinder-145"><a href="#PeakFinder-145"><span class="linenos">145</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakFinder-146"><a href="#PeakFinder-146"><span class="linenos">146</span></a>        <span class="n">peaks_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="PeakFinder-147"><a href="#PeakFinder-147"><span class="linenos">147</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_peaks_start</span>
</span><span id="PeakFinder-148"><a href="#PeakFinder-148"><span class="linenos">148</span></a>        <span class="p">]</span>
</span><span id="PeakFinder-149"><a href="#PeakFinder-149"><span class="linenos">149</span></a>        <span class="n">peaks_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">peak_height</span><span class="p">)</span>
</span><span id="PeakFinder-150"><a href="#PeakFinder-150"><span class="linenos">150</span></a>
</span><span id="PeakFinder-151"><a href="#PeakFinder-151"><span class="linenos">151</span></a>        <span class="n">peak_information</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder-152"><a href="#PeakFinder-152"><span class="linenos">152</span></a>            <span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">peaks_index</span><span class="p">]</span>
</span><span id="PeakFinder-153"><a href="#PeakFinder-153"><span class="linenos">153</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peaks_index</span><span class="o">=</span><span class="n">peaks_index</span><span class="p">)</span>
</span><span id="PeakFinder-154"><a href="#PeakFinder-154"><span class="linenos">154</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="PeakFinder-155"><a href="#PeakFinder-155"><span class="linenos">155</span></a>            <span class="c1"># separate the peaks into different assay groups depending on the distance</span>
</span><span id="PeakFinder-156"><a href="#PeakFinder-156"><span class="linenos">156</span></a>            <span class="c1"># between the peaks</span>
</span><span id="PeakFinder-157"><a href="#PeakFinder-157"><span class="linenos">157</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">difference</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">diff</span><span class="p">())</span>
</span><span id="PeakFinder-158"><a href="#PeakFinder-158"><span class="linenos">158</span></a>            <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</span><span id="PeakFinder-159"><a href="#PeakFinder-159"><span class="linenos">159</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
</span><span id="PeakFinder-160"><a href="#PeakFinder-160"><span class="linenos">160</span></a>                <span class="n">assay</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
</span><span id="PeakFinder-161"><a href="#PeakFinder-161"><span class="linenos">161</span></a>                    <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">difference</span> <span class="o">&gt;</span> <span class="n">distance_between_assays</span><span class="p">],</span>
</span><span id="PeakFinder-162"><a href="#PeakFinder-162"><span class="linenos">162</span></a>                    <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">peak_name</span> <span class="o">*</span> <span class="mi">10</span><span class="p">],</span>
</span><span id="PeakFinder-163"><a href="#PeakFinder-163"><span class="linenos">163</span></a>                    <span class="n">default</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NA</span><span class="p">,</span>
</span><span id="PeakFinder-164"><a href="#PeakFinder-164"><span class="linenos">164</span></a>                <span class="p">)</span>
</span><span id="PeakFinder-165"><a href="#PeakFinder-165"><span class="linenos">165</span></a>            <span class="p">)</span>
</span><span id="PeakFinder-166"><a href="#PeakFinder-166"><span class="linenos">166</span></a>            <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;ffill&quot;</span><span class="p">)</span>
</span><span id="PeakFinder-167"><a href="#PeakFinder-167"><span class="linenos">167</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">max_peak</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;assay&quot;</span><span class="p">)[</span><span class="s2">&quot;peaks&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">))</span>
</span><span id="PeakFinder-168"><a href="#PeakFinder-168"><span class="linenos">168</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">max_peak</span><span class="p">)</span>
</span><span id="PeakFinder-169"><a href="#PeakFinder-169"><span class="linenos">169</span></a>            <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">ratio</span> <span class="o">&gt;</span> <span class="n">min_ratio</span><span class="p">]</span>
</span><span id="PeakFinder-170"><a href="#PeakFinder-170"><span class="linenos">170</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="PeakFinder-171"><a href="#PeakFinder-171"><span class="linenos">171</span></a>        <span class="p">)</span>
</span><span id="PeakFinder-172"><a href="#PeakFinder-172"><span class="linenos">172</span></a>
</span><span id="PeakFinder-173"><a href="#PeakFinder-173"><span class="linenos">173</span></a>        <span class="c1"># update peaks_index based on the above filtering</span>
</span><span id="PeakFinder-174"><a href="#PeakFinder-174"><span class="linenos">174</span></a>        <span class="n">peaks_index</span> <span class="o">=</span> <span class="n">peak_information</span><span class="o">.</span><span class="n">peaks_index</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="PeakFinder-175"><a href="#PeakFinder-175"><span class="linenos">175</span></a>
</span><span id="PeakFinder-176"><a href="#PeakFinder-176"><span class="linenos">176</span></a>        <span class="c1"># update class attributes</span>
</span><span id="PeakFinder-177"><a href="#PeakFinder-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_index</span> <span class="o">=</span> <span class="n">peaks_index</span>
</span><span id="PeakFinder-178"><a href="#PeakFinder-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_dataframe</span> <span class="o">=</span> <span class="n">peaks_dataframe</span>
</span><span id="PeakFinder-179"><a href="#PeakFinder-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span> <span class="o">=</span> <span class="n">peak_information</span>
</span><span id="PeakFinder-180"><a href="#PeakFinder-180"><span class="linenos">180</span></a>
</span><span id="PeakFinder-181"><a href="#PeakFinder-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">find_peaks_customized</span><span class="p">(</span>
</span><span id="PeakFinder-182"><a href="#PeakFinder-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakFinder-183"><a href="#PeakFinder-183"><span class="linenos">183</span></a>        <span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PeakFinder-184"><a href="#PeakFinder-184"><span class="linenos">184</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakFinder-185"><a href="#PeakFinder-185"><span class="linenos">185</span></a>
</span><span id="PeakFinder-186"><a href="#PeakFinder-186"><span class="linenos">186</span></a>        <span class="c1"># Filter where to start search for the peaks</span>
</span><span id="PeakFinder-187"><a href="#PeakFinder-187"><span class="linenos">187</span></a>        <span class="n">peaks_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="PeakFinder-188"><a href="#PeakFinder-188"><span class="linenos">188</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_peaks_start</span>
</span><span id="PeakFinder-189"><a href="#PeakFinder-189"><span class="linenos">189</span></a>        <span class="p">]</span>
</span><span id="PeakFinder-190"><a href="#PeakFinder-190"><span class="linenos">190</span></a>        <span class="c1"># Find the peaks</span>
</span><span id="PeakFinder-191"><a href="#PeakFinder-191"><span class="linenos">191</span></a>        <span class="n">peaks_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">peak_height</span><span class="p">)</span>
</span><span id="PeakFinder-192"><a href="#PeakFinder-192"><span class="linenos">192</span></a>
</span><span id="PeakFinder-193"><a href="#PeakFinder-193"><span class="linenos">193</span></a>        <span class="c1"># Filter the df to get right peaks</span>
</span><span id="PeakFinder-194"><a href="#PeakFinder-194"><span class="linenos">194</span></a>        <span class="n">peak_information</span> <span class="o">=</span> <span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">peaks_index</span><span class="p">]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
</span><span id="PeakFinder-195"><a href="#PeakFinder-195"><span class="linenos">195</span></a>            <span class="n">peaks_index</span><span class="o">=</span><span class="n">peaks_index</span>
</span><span id="PeakFinder-196"><a href="#PeakFinder-196"><span class="linenos">196</span></a>        <span class="p">)</span>
</span><span id="PeakFinder-197"><a href="#PeakFinder-197"><span class="linenos">197</span></a>        <span class="c1"># Filter the above df based on the custom peaks from the user</span>
</span><span id="PeakFinder-198"><a href="#PeakFinder-198"><span class="linenos">198</span></a>        <span class="n">customized_peaks</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakFinder-199"><a href="#PeakFinder-199"><span class="linenos">199</span></a>        <span class="k">for</span> <span class="n">assay</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
</span><span id="PeakFinder-200"><a href="#PeakFinder-200"><span class="linenos">200</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder-201"><a href="#PeakFinder-201"><span class="linenos">201</span></a>                <span class="n">peak_information</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&gt;</span> <span class="n">assay</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
</span><span id="PeakFinder-202"><a href="#PeakFinder-202"><span class="linenos">202</span></a>                <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&lt;</span> <span class="n">assay</span><span class="o">.</span><span class="n">stop</span><span class="p">]</span>
</span><span id="PeakFinder-203"><a href="#PeakFinder-203"><span class="linenos">203</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">assay</span><span class="o">=</span><span class="n">assay</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="PeakFinder-204"><a href="#PeakFinder-204"><span class="linenos">204</span></a>            <span class="p">)</span>
</span><span id="PeakFinder-205"><a href="#PeakFinder-205"><span class="linenos">205</span></a>
</span><span id="PeakFinder-206"><a href="#PeakFinder-206"><span class="linenos">206</span></a>            <span class="c1"># Rank the peaks by height and filter out the smallest ones</span>
</span><span id="PeakFinder-207"><a href="#PeakFinder-207"><span class="linenos">207</span></a>            <span class="k">if</span> <span class="n">assay</span><span class="o">.</span><span class="n">amount</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PeakFinder-208"><a href="#PeakFinder-208"><span class="linenos">208</span></a>                <span class="k">if</span> <span class="n">assay</span><span class="o">.</span><span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;LARGEST&quot;</span> <span class="ow">or</span> <span class="n">assay</span><span class="o">.</span><span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="PeakFinder-209"><a href="#PeakFinder-209"><span class="linenos">209</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder-210"><a href="#PeakFinder-210"><span class="linenos">210</span></a>                        <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">max_peak</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</span><span id="PeakFinder-211"><a href="#PeakFinder-211"><span class="linenos">211</span></a>                        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">max_peak</span><span class="p">)</span>
</span><span id="PeakFinder-212"><a href="#PeakFinder-212"><span class="linenos">212</span></a>                        <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">ratio</span> <span class="o">&gt;</span> <span class="n">assay</span><span class="o">.</span><span class="n">min_ratio</span><span class="p">]</span>
</span><span id="PeakFinder-213"><a href="#PeakFinder-213"><span class="linenos">213</span></a>                        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">rank_peak</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</span><span id="PeakFinder-214"><a href="#PeakFinder-214"><span class="linenos">214</span></a>                        <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">rank_peak</span> <span class="o">&lt;=</span> <span class="n">assay</span><span class="o">.</span><span class="n">amount</span><span class="p">]</span>
</span><span id="PeakFinder-215"><a href="#PeakFinder-215"><span class="linenos">215</span></a>                        <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rank_peak&quot;</span><span class="p">])</span>
</span><span id="PeakFinder-216"><a href="#PeakFinder-216"><span class="linenos">216</span></a>                    <span class="p">)</span>
</span><span id="PeakFinder-217"><a href="#PeakFinder-217"><span class="linenos">217</span></a>                <span class="k">elif</span> <span class="n">assay</span><span class="o">.</span><span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;FIRST&quot;</span><span class="p">:</span>
</span><span id="PeakFinder-218"><a href="#PeakFinder-218"><span class="linenos">218</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder-219"><a href="#PeakFinder-219"><span class="linenos">219</span></a>                        <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">max_peak</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</span><span id="PeakFinder-220"><a href="#PeakFinder-220"><span class="linenos">220</span></a>                        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">max_peak</span><span class="p">)</span>
</span><span id="PeakFinder-221"><a href="#PeakFinder-221"><span class="linenos">221</span></a>                        <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">ratio</span> <span class="o">&gt;</span> <span class="n">assay</span><span class="o">.</span><span class="n">min_ratio</span><span class="p">]</span>
</span><span id="PeakFinder-222"><a href="#PeakFinder-222"><span class="linenos">222</span></a>                        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;basepairs&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PeakFinder-223"><a href="#PeakFinder-223"><span class="linenos">223</span></a>                        <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">assay</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span>
</span><span id="PeakFinder-224"><a href="#PeakFinder-224"><span class="linenos">224</span></a>                    <span class="p">)</span>
</span><span id="PeakFinder-225"><a href="#PeakFinder-225"><span class="linenos">225</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PeakFinder-226"><a href="#PeakFinder-226"><span class="linenos">226</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[ERROR]: column `which` must be `FIRST` or `LARGEST`&quot;</span><span class="p">)</span>
</span><span id="PeakFinder-227"><a href="#PeakFinder-227"><span class="linenos">227</span></a>                    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PeakFinder-228"><a href="#PeakFinder-228"><span class="linenos">228</span></a>
</span><span id="PeakFinder-229"><a href="#PeakFinder-229"><span class="linenos">229</span></a>            <span class="n">customized_peaks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="PeakFinder-230"><a href="#PeakFinder-230"><span class="linenos">230</span></a>
</span><span id="PeakFinder-231"><a href="#PeakFinder-231"><span class="linenos">231</span></a>        <span class="n">peak_information</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder-232"><a href="#PeakFinder-232"><span class="linenos">232</span></a>            <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">customized_peaks</span><span class="p">)</span>
</span><span id="PeakFinder-233"><a href="#PeakFinder-233"><span class="linenos">233</span></a>            <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="PeakFinder-234"><a href="#PeakFinder-234"><span class="linenos">234</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="PeakFinder-235"><a href="#PeakFinder-235"><span class="linenos">235</span></a>        <span class="p">)</span>
</span><span id="PeakFinder-236"><a href="#PeakFinder-236"><span class="linenos">236</span></a>
</span><span id="PeakFinder-237"><a href="#PeakFinder-237"><span class="linenos">237</span></a>        <span class="c1"># update peaks_index based on the above filtering</span>
</span><span id="PeakFinder-238"><a href="#PeakFinder-238"><span class="linenos">238</span></a>        <span class="n">peaks_index</span> <span class="o">=</span> <span class="n">peak_information</span><span class="o">.</span><span class="n">peaks_index</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="PeakFinder-239"><a href="#PeakFinder-239"><span class="linenos">239</span></a>
</span><span id="PeakFinder-240"><a href="#PeakFinder-240"><span class="linenos">240</span></a>        <span class="c1"># update class attributes</span>
</span><span id="PeakFinder-241"><a href="#PeakFinder-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_index</span> <span class="o">=</span> <span class="n">peaks_index</span>
</span><span id="PeakFinder-242"><a href="#PeakFinder-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_dataframe</span> <span class="o">=</span> <span class="n">peaks_dataframe</span>
</span><span id="PeakFinder-243"><a href="#PeakFinder-243"><span class="linenos">243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span> <span class="o">=</span> <span class="n">peak_information</span>
</span></pre></div>


    

                            <div id="PeakFinder.__init__" class="classattr">
                                        <input id="PeakFinder.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PeakFinder</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">model</span><span class="p">:</span> <span class="n"><a href="#FitLadderModel">FitLadderModel</a></span>,</span><span class="param">	<span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span>,</span><span class="param">	<span class="n">search_peaks_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">110</span>,</span><span class="param">	<span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">350</span>,</span><span class="param">	<span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span>,</span><span class="param">	<span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="PeakFinder.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakFinder.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakFinder.__init__-76"><a href="#PeakFinder.__init__-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="PeakFinder.__init__-77"><a href="#PeakFinder.__init__-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakFinder.__init__-78"><a href="#PeakFinder.__init__-78"><span class="linenos"> 78</span></a>        <span class="n">model</span><span class="p">:</span> <span class="n">FitLadderModel</span><span class="p">,</span>
</span><span id="PeakFinder.__init__-79"><a href="#PeakFinder.__init__-79"><span class="linenos"> 79</span></a>        <span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.15</span><span class="p">,</span>
</span><span id="PeakFinder.__init__-80"><a href="#PeakFinder.__init__-80"><span class="linenos"> 80</span></a>        <span class="n">search_peaks_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">110</span><span class="p">,</span>
</span><span id="PeakFinder.__init__-81"><a href="#PeakFinder.__init__-81"><span class="linenos"> 81</span></a>        <span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span>
</span><span id="PeakFinder.__init__-82"><a href="#PeakFinder.__init__-82"><span class="linenos"> 82</span></a>        <span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
</span><span id="PeakFinder.__init__-83"><a href="#PeakFinder.__init__-83"><span class="linenos"> 83</span></a>        <span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PeakFinder.__init__-84"><a href="#PeakFinder.__init__-84"><span class="linenos"> 84</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakFinder.__init__-85"><a href="#PeakFinder.__init__-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
</span><span id="PeakFinder.__init__-86"><a href="#PeakFinder.__init__-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">adjusted_baisepair_df</span>
</span><span id="PeakFinder.__init__-87"><a href="#PeakFinder.__init__-87"><span class="linenos"> 87</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fsa_file</span><span class="o">.</span><span class="n">file_name</span>
</span><span id="PeakFinder.__init__-88"><a href="#PeakFinder.__init__-88"><span class="linenos"> 88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">search_peaks_start</span> <span class="o">=</span> <span class="n">search_peaks_start</span>
</span><span id="PeakFinder.__init__-89"><a href="#PeakFinder.__init__-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_height</span> <span class="o">=</span> <span class="n">peak_height</span>
</span><span id="PeakFinder.__init__-90"><a href="#PeakFinder.__init__-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_ratio</span> <span class="o">=</span> <span class="n">min_ratio</span>
</span><span id="PeakFinder.__init__-91"><a href="#PeakFinder.__init__-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance_between_assays</span> <span class="o">=</span> <span class="n">distance_between_assays</span>
</span><span id="PeakFinder.__init__-92"><a href="#PeakFinder.__init__-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder.__init__-93"><a href="#PeakFinder.__init__-93"><span class="linenos"> 93</span></a>            <span class="n">custom_peaks</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="PeakFinder.__init__-94"><a href="#PeakFinder.__init__-94"><span class="linenos"> 94</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">custom_peaks</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
</span><span id="PeakFinder.__init__-95"><a href="#PeakFinder.__init__-95"><span class="linenos"> 95</span></a>            <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">custom_peaks</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="PeakFinder.__init__-96"><a href="#PeakFinder.__init__-96"><span class="linenos"> 96</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">custom_peaks</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
</span><span id="PeakFinder.__init__-97"><a href="#PeakFinder.__init__-97"><span class="linenos"> 97</span></a>            <span class="k">else</span> <span class="kc">None</span>
</span><span id="PeakFinder.__init__-98"><a href="#PeakFinder.__init__-98"><span class="linenos"> 98</span></a>        <span class="p">)</span>
</span><span id="PeakFinder.__init__-99"><a href="#PeakFinder.__init__-99"><span class="linenos"> 99</span></a>
</span><span id="PeakFinder.__init__-100"><a href="#PeakFinder.__init__-100"><span class="linenos">100</span></a>        <span class="c1"># Validation of custom_peaks</span>
</span><span id="PeakFinder.__init__-101"><a href="#PeakFinder.__init__-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run_validation</span><span class="p">()</span>
</span><span id="PeakFinder.__init__-102"><a href="#PeakFinder.__init__-102"><span class="linenos">102</span></a>        <span class="c1"># find peaks, custom or agnostic</span>
</span><span id="PeakFinder.__init__-103"><a href="#PeakFinder.__init__-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">()</span>
</span><span id="PeakFinder.__init__-104"><a href="#PeakFinder.__init__-104"><span class="linenos">104</span></a>        <span class="c1"># continue whether peaks are found or not.</span>
</span><span id="PeakFinder.__init__-105"><a href="#PeakFinder.__init__-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">found_peaks</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="PeakFinder.model" class="classattr">
                                <div class="attr variable">
            <span class="name">model</span>

        
    </div>
    <a class="headerlink" href="#PeakFinder.model"></a>
    
    

                            </div>
                            <div id="PeakFinder.raw_data" class="classattr">
                                <div class="attr variable">
            <span class="name">raw_data</span>

        
    </div>
    <a class="headerlink" href="#PeakFinder.raw_data"></a>
    
    

                            </div>
                            <div id="PeakFinder.file_name" class="classattr">
                                <div class="attr variable">
            <span class="name">file_name</span>

        
    </div>
    <a class="headerlink" href="#PeakFinder.file_name"></a>
    
    

                            </div>
                            <div id="PeakFinder.search_peaks_start" class="classattr">
                                <div class="attr variable">
            <span class="name">search_peaks_start</span>

        
    </div>
    <a class="headerlink" href="#PeakFinder.search_peaks_start"></a>
    
    

                            </div>
                            <div id="PeakFinder.peak_height" class="classattr">
                                <div class="attr variable">
            <span class="name">peak_height</span>

        
    </div>
    <a class="headerlink" href="#PeakFinder.peak_height"></a>
    
    

                            </div>
                            <div id="PeakFinder.min_ratio" class="classattr">
                                <div class="attr variable">
            <span class="name">min_ratio</span>

        
    </div>
    <a class="headerlink" href="#PeakFinder.min_ratio"></a>
    
    

                            </div>
                            <div id="PeakFinder.distance_between_assays" class="classattr">
                                <div class="attr variable">
            <span class="name">distance_between_assays</span>

        
    </div>
    <a class="headerlink" href="#PeakFinder.distance_between_assays"></a>
    
    

                            </div>
                            <div id="PeakFinder.custom_peaks" class="classattr">
                                <div class="attr variable">
            <span class="name">custom_peaks</span>

        
    </div>
    <a class="headerlink" href="#PeakFinder.custom_peaks"></a>
    
    

                            </div>
                            <div id="PeakFinder.run_validation" class="classattr">
                                        <input id="PeakFinder.run_validation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run_validation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PeakFinder.run_validation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakFinder.run_validation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakFinder.run_validation-107"><a href="#PeakFinder.run_validation-107"><span class="linenos">107</span></a>    <span class="k">def</span> <span class="nf">run_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PeakFinder.run_validation-108"><a href="#PeakFinder.run_validation-108"><span class="linenos">108</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakFinder.run_validation-109"><a href="#PeakFinder.run_validation-109"><span class="linenos">109</span></a>            <span class="k">return</span>
</span><span id="PeakFinder.run_validation-110"><a href="#PeakFinder.run_validation-110"><span class="linenos">110</span></a>
</span><span id="PeakFinder.run_validation-111"><a href="#PeakFinder.run_validation-111"><span class="linenos">111</span></a>        <span class="k">if</span> <span class="n">is_overlapping</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span><span class="p">):</span>
</span><span id="PeakFinder.run_validation-112"><a href="#PeakFinder.run_validation-112"><span class="linenos">112</span></a>            <span class="k">raise</span> <span class="n">OverlappingIntervalError</span><span class="p">(</span><span class="s2">&quot;Overlapping intervals!&quot;</span><span class="p">)</span>
</span><span id="PeakFinder.run_validation-113"><a href="#PeakFinder.run_validation-113"><span class="linenos">113</span></a>            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PeakFinder.run_validation-114"><a href="#PeakFinder.run_validation-114"><span class="linenos">114</span></a>
</span><span id="PeakFinder.run_validation-115"><a href="#PeakFinder.run_validation-115"><span class="linenos">115</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">has_columns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span><span class="p">):</span>
</span><span id="PeakFinder.run_validation-116"><a href="#PeakFinder.run_validation-116"><span class="linenos">116</span></a>            <span class="k">raise</span> <span class="n">WrongColumnsError</span><span class="p">(</span><span class="s2">&quot;Wrong columns!&quot;</span><span class="p">)</span>
</span><span id="PeakFinder.run_validation-117"><a href="#PeakFinder.run_validation-117"><span class="linenos">117</span></a>            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="PeakFinder.find_peaks" class="classattr">
                                        <input id="PeakFinder.find_peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_peaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PeakFinder.find_peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakFinder.find_peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakFinder.find_peaks-119"><a href="#PeakFinder.find_peaks-119"><span class="linenos">119</span></a>    <span class="k">def</span> <span class="nf">find_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PeakFinder.find_peaks-120"><a href="#PeakFinder.find_peaks-120"><span class="linenos">120</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakFinder.find_peaks-121"><a href="#PeakFinder.find_peaks-121"><span class="linenos">121</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks_customized</span><span class="p">(</span>
</span><span id="PeakFinder.find_peaks-122"><a href="#PeakFinder.find_peaks-122"><span class="linenos">122</span></a>                <span class="n">peak_height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_height</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks-123"><a href="#PeakFinder.find_peaks-123"><span class="linenos">123</span></a>            <span class="p">)</span>
</span><span id="PeakFinder.find_peaks-124"><a href="#PeakFinder.find_peaks-124"><span class="linenos">124</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PeakFinder.find_peaks-125"><a href="#PeakFinder.find_peaks-125"><span class="linenos">125</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks_agnostic</span><span class="p">(</span>
</span><span id="PeakFinder.find_peaks-126"><a href="#PeakFinder.find_peaks-126"><span class="linenos">126</span></a>                <span class="n">peak_height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_height</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks-127"><a href="#PeakFinder.find_peaks-127"><span class="linenos">127</span></a>                <span class="n">min_ratio</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_ratio</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks-128"><a href="#PeakFinder.find_peaks-128"><span class="linenos">128</span></a>                <span class="n">distance_between_assays</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">distance_between_assays</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks-129"><a href="#PeakFinder.find_peaks-129"><span class="linenos">129</span></a>            <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="PeakFinder.found_peaks" class="classattr">
                                        <input id="PeakFinder.found_peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">found_peaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PeakFinder.found_peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakFinder.found_peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakFinder.found_peaks-131"><a href="#PeakFinder.found_peaks-131"><span class="linenos">131</span></a>    <span class="k">def</span> <span class="nf">found_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PeakFinder.found_peaks-132"><a href="#PeakFinder.found_peaks-132"><span class="linenos">132</span></a>        <span class="c1"># if no peaks could be found</span>
</span><span id="PeakFinder.found_peaks-133"><a href="#PeakFinder.found_peaks-133"><span class="linenos">133</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PeakFinder.found_peaks-134"><a href="#PeakFinder.found_peaks-134"><span class="linenos">134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">found_peaks</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PeakFinder.found_peaks-135"><a href="#PeakFinder.found_peaks-135"><span class="linenos">135</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No peaks could be found. Please look at raw data.&quot;</span><span class="p">)</span>
</span><span id="PeakFinder.found_peaks-136"><a href="#PeakFinder.found_peaks-136"><span class="linenos">136</span></a>        <span class="c1"># if peaks are found</span>
</span><span id="PeakFinder.found_peaks-137"><a href="#PeakFinder.found_peaks-137"><span class="linenos">137</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PeakFinder.found_peaks-138"><a href="#PeakFinder.found_peaks-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">found_peaks</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>


    

                            </div>
                            <div id="PeakFinder.find_peaks_agnostic" class="classattr">
                                        <input id="PeakFinder.find_peaks_agnostic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_peaks_agnostic</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PeakFinder.find_peaks_agnostic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakFinder.find_peaks_agnostic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakFinder.find_peaks_agnostic-140"><a href="#PeakFinder.find_peaks_agnostic-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">find_peaks_agnostic</span><span class="p">(</span>
</span><span id="PeakFinder.find_peaks_agnostic-141"><a href="#PeakFinder.find_peaks_agnostic-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks_agnostic-142"><a href="#PeakFinder.find_peaks_agnostic-142"><span class="linenos">142</span></a>        <span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks_agnostic-143"><a href="#PeakFinder.find_peaks_agnostic-143"><span class="linenos">143</span></a>        <span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks_agnostic-144"><a href="#PeakFinder.find_peaks_agnostic-144"><span class="linenos">144</span></a>        <span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks_agnostic-145"><a href="#PeakFinder.find_peaks_agnostic-145"><span class="linenos">145</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakFinder.find_peaks_agnostic-146"><a href="#PeakFinder.find_peaks_agnostic-146"><span class="linenos">146</span></a>        <span class="n">peaks_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="PeakFinder.find_peaks_agnostic-147"><a href="#PeakFinder.find_peaks_agnostic-147"><span class="linenos">147</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_peaks_start</span>
</span><span id="PeakFinder.find_peaks_agnostic-148"><a href="#PeakFinder.find_peaks_agnostic-148"><span class="linenos">148</span></a>        <span class="p">]</span>
</span><span id="PeakFinder.find_peaks_agnostic-149"><a href="#PeakFinder.find_peaks_agnostic-149"><span class="linenos">149</span></a>        <span class="n">peaks_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">peak_height</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_agnostic-150"><a href="#PeakFinder.find_peaks_agnostic-150"><span class="linenos">150</span></a>
</span><span id="PeakFinder.find_peaks_agnostic-151"><a href="#PeakFinder.find_peaks_agnostic-151"><span class="linenos">151</span></a>        <span class="n">peak_information</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder.find_peaks_agnostic-152"><a href="#PeakFinder.find_peaks_agnostic-152"><span class="linenos">152</span></a>            <span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">peaks_index</span><span class="p">]</span>
</span><span id="PeakFinder.find_peaks_agnostic-153"><a href="#PeakFinder.find_peaks_agnostic-153"><span class="linenos">153</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peaks_index</span><span class="o">=</span><span class="n">peaks_index</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_agnostic-154"><a href="#PeakFinder.find_peaks_agnostic-154"><span class="linenos">154</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="PeakFinder.find_peaks_agnostic-155"><a href="#PeakFinder.find_peaks_agnostic-155"><span class="linenos">155</span></a>            <span class="c1"># separate the peaks into different assay groups depending on the distance</span>
</span><span id="PeakFinder.find_peaks_agnostic-156"><a href="#PeakFinder.find_peaks_agnostic-156"><span class="linenos">156</span></a>            <span class="c1"># between the peaks</span>
</span><span id="PeakFinder.find_peaks_agnostic-157"><a href="#PeakFinder.find_peaks_agnostic-157"><span class="linenos">157</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">difference</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span><span class="o">.</span><span class="n">diff</span><span class="p">())</span>
</span><span id="PeakFinder.find_peaks_agnostic-158"><a href="#PeakFinder.find_peaks_agnostic-158"><span class="linenos">158</span></a>            <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_agnostic-159"><a href="#PeakFinder.find_peaks_agnostic-159"><span class="linenos">159</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
</span><span id="PeakFinder.find_peaks_agnostic-160"><a href="#PeakFinder.find_peaks_agnostic-160"><span class="linenos">160</span></a>                <span class="n">assay</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
</span><span id="PeakFinder.find_peaks_agnostic-161"><a href="#PeakFinder.find_peaks_agnostic-161"><span class="linenos">161</span></a>                    <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">difference</span> <span class="o">&gt;</span> <span class="n">distance_between_assays</span><span class="p">],</span>
</span><span id="PeakFinder.find_peaks_agnostic-162"><a href="#PeakFinder.find_peaks_agnostic-162"><span class="linenos">162</span></a>                    <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">peak_name</span> <span class="o">*</span> <span class="mi">10</span><span class="p">],</span>
</span><span id="PeakFinder.find_peaks_agnostic-163"><a href="#PeakFinder.find_peaks_agnostic-163"><span class="linenos">163</span></a>                    <span class="n">default</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NA</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks_agnostic-164"><a href="#PeakFinder.find_peaks_agnostic-164"><span class="linenos">164</span></a>                <span class="p">)</span>
</span><span id="PeakFinder.find_peaks_agnostic-165"><a href="#PeakFinder.find_peaks_agnostic-165"><span class="linenos">165</span></a>            <span class="p">)</span>
</span><span id="PeakFinder.find_peaks_agnostic-166"><a href="#PeakFinder.find_peaks_agnostic-166"><span class="linenos">166</span></a>            <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;ffill&quot;</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_agnostic-167"><a href="#PeakFinder.find_peaks_agnostic-167"><span class="linenos">167</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">max_peak</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;assay&quot;</span><span class="p">)[</span><span class="s2">&quot;peaks&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">))</span>
</span><span id="PeakFinder.find_peaks_agnostic-168"><a href="#PeakFinder.find_peaks_agnostic-168"><span class="linenos">168</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">max_peak</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_agnostic-169"><a href="#PeakFinder.find_peaks_agnostic-169"><span class="linenos">169</span></a>            <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">ratio</span> <span class="o">&gt;</span> <span class="n">min_ratio</span><span class="p">]</span>
</span><span id="PeakFinder.find_peaks_agnostic-170"><a href="#PeakFinder.find_peaks_agnostic-170"><span class="linenos">170</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="PeakFinder.find_peaks_agnostic-171"><a href="#PeakFinder.find_peaks_agnostic-171"><span class="linenos">171</span></a>        <span class="p">)</span>
</span><span id="PeakFinder.find_peaks_agnostic-172"><a href="#PeakFinder.find_peaks_agnostic-172"><span class="linenos">172</span></a>
</span><span id="PeakFinder.find_peaks_agnostic-173"><a href="#PeakFinder.find_peaks_agnostic-173"><span class="linenos">173</span></a>        <span class="c1"># update peaks_index based on the above filtering</span>
</span><span id="PeakFinder.find_peaks_agnostic-174"><a href="#PeakFinder.find_peaks_agnostic-174"><span class="linenos">174</span></a>        <span class="n">peaks_index</span> <span class="o">=</span> <span class="n">peak_information</span><span class="o">.</span><span class="n">peaks_index</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="PeakFinder.find_peaks_agnostic-175"><a href="#PeakFinder.find_peaks_agnostic-175"><span class="linenos">175</span></a>
</span><span id="PeakFinder.find_peaks_agnostic-176"><a href="#PeakFinder.find_peaks_agnostic-176"><span class="linenos">176</span></a>        <span class="c1"># update class attributes</span>
</span><span id="PeakFinder.find_peaks_agnostic-177"><a href="#PeakFinder.find_peaks_agnostic-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_index</span> <span class="o">=</span> <span class="n">peaks_index</span>
</span><span id="PeakFinder.find_peaks_agnostic-178"><a href="#PeakFinder.find_peaks_agnostic-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_dataframe</span> <span class="o">=</span> <span class="n">peaks_dataframe</span>
</span><span id="PeakFinder.find_peaks_agnostic-179"><a href="#PeakFinder.find_peaks_agnostic-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span> <span class="o">=</span> <span class="n">peak_information</span>
</span></pre></div>


    

                            </div>
                            <div id="PeakFinder.find_peaks_customized" class="classattr">
                                        <input id="PeakFinder.find_peaks_customized-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_peaks_customized</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PeakFinder.find_peaks_customized-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PeakFinder.find_peaks_customized"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PeakFinder.find_peaks_customized-181"><a href="#PeakFinder.find_peaks_customized-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">find_peaks_customized</span><span class="p">(</span>
</span><span id="PeakFinder.find_peaks_customized-182"><a href="#PeakFinder.find_peaks_customized-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks_customized-183"><a href="#PeakFinder.find_peaks_customized-183"><span class="linenos">183</span></a>        <span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PeakFinder.find_peaks_customized-184"><a href="#PeakFinder.find_peaks_customized-184"><span class="linenos">184</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PeakFinder.find_peaks_customized-185"><a href="#PeakFinder.find_peaks_customized-185"><span class="linenos">185</span></a>
</span><span id="PeakFinder.find_peaks_customized-186"><a href="#PeakFinder.find_peaks_customized-186"><span class="linenos">186</span></a>        <span class="c1"># Filter where to start search for the peaks</span>
</span><span id="PeakFinder.find_peaks_customized-187"><a href="#PeakFinder.find_peaks_customized-187"><span class="linenos">187</span></a>        <span class="n">peaks_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
</span><span id="PeakFinder.find_peaks_customized-188"><a href="#PeakFinder.find_peaks_customized-188"><span class="linenos">188</span></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_peaks_start</span>
</span><span id="PeakFinder.find_peaks_customized-189"><a href="#PeakFinder.find_peaks_customized-189"><span class="linenos">189</span></a>        <span class="p">]</span>
</span><span id="PeakFinder.find_peaks_customized-190"><a href="#PeakFinder.find_peaks_customized-190"><span class="linenos">190</span></a>        <span class="c1"># Find the peaks</span>
</span><span id="PeakFinder.find_peaks_customized-191"><a href="#PeakFinder.find_peaks_customized-191"><span class="linenos">191</span></a>        <span class="n">peaks_index</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">peaks</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">peak_height</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-192"><a href="#PeakFinder.find_peaks_customized-192"><span class="linenos">192</span></a>
</span><span id="PeakFinder.find_peaks_customized-193"><a href="#PeakFinder.find_peaks_customized-193"><span class="linenos">193</span></a>        <span class="c1"># Filter the df to get right peaks</span>
</span><span id="PeakFinder.find_peaks_customized-194"><a href="#PeakFinder.find_peaks_customized-194"><span class="linenos">194</span></a>        <span class="n">peak_information</span> <span class="o">=</span> <span class="n">peaks_dataframe</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">peaks_index</span><span class="p">]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
</span><span id="PeakFinder.find_peaks_customized-195"><a href="#PeakFinder.find_peaks_customized-195"><span class="linenos">195</span></a>            <span class="n">peaks_index</span><span class="o">=</span><span class="n">peaks_index</span>
</span><span id="PeakFinder.find_peaks_customized-196"><a href="#PeakFinder.find_peaks_customized-196"><span class="linenos">196</span></a>        <span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-197"><a href="#PeakFinder.find_peaks_customized-197"><span class="linenos">197</span></a>        <span class="c1"># Filter the above df based on the custom peaks from the user</span>
</span><span id="PeakFinder.find_peaks_customized-198"><a href="#PeakFinder.find_peaks_customized-198"><span class="linenos">198</span></a>        <span class="n">customized_peaks</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PeakFinder.find_peaks_customized-199"><a href="#PeakFinder.find_peaks_customized-199"><span class="linenos">199</span></a>        <span class="k">for</span> <span class="n">assay</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_peaks</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
</span><span id="PeakFinder.find_peaks_customized-200"><a href="#PeakFinder.find_peaks_customized-200"><span class="linenos">200</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder.find_peaks_customized-201"><a href="#PeakFinder.find_peaks_customized-201"><span class="linenos">201</span></a>                <span class="n">peak_information</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&gt;</span> <span class="n">assay</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
</span><span id="PeakFinder.find_peaks_customized-202"><a href="#PeakFinder.find_peaks_customized-202"><span class="linenos">202</span></a>                <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">basepairs</span> <span class="o">&lt;</span> <span class="n">assay</span><span class="o">.</span><span class="n">stop</span><span class="p">]</span>
</span><span id="PeakFinder.find_peaks_customized-203"><a href="#PeakFinder.find_peaks_customized-203"><span class="linenos">203</span></a>                <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">assay</span><span class="o">=</span><span class="n">assay</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-204"><a href="#PeakFinder.find_peaks_customized-204"><span class="linenos">204</span></a>            <span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-205"><a href="#PeakFinder.find_peaks_customized-205"><span class="linenos">205</span></a>
</span><span id="PeakFinder.find_peaks_customized-206"><a href="#PeakFinder.find_peaks_customized-206"><span class="linenos">206</span></a>            <span class="c1"># Rank the peaks by height and filter out the smallest ones</span>
</span><span id="PeakFinder.find_peaks_customized-207"><a href="#PeakFinder.find_peaks_customized-207"><span class="linenos">207</span></a>            <span class="k">if</span> <span class="n">assay</span><span class="o">.</span><span class="n">amount</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PeakFinder.find_peaks_customized-208"><a href="#PeakFinder.find_peaks_customized-208"><span class="linenos">208</span></a>                <span class="k">if</span> <span class="n">assay</span><span class="o">.</span><span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;LARGEST&quot;</span> <span class="ow">or</span> <span class="n">assay</span><span class="o">.</span><span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="PeakFinder.find_peaks_customized-209"><a href="#PeakFinder.find_peaks_customized-209"><span class="linenos">209</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder.find_peaks_customized-210"><a href="#PeakFinder.find_peaks_customized-210"><span class="linenos">210</span></a>                        <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">max_peak</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</span><span id="PeakFinder.find_peaks_customized-211"><a href="#PeakFinder.find_peaks_customized-211"><span class="linenos">211</span></a>                        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">max_peak</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-212"><a href="#PeakFinder.find_peaks_customized-212"><span class="linenos">212</span></a>                        <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">ratio</span> <span class="o">&gt;</span> <span class="n">assay</span><span class="o">.</span><span class="n">min_ratio</span><span class="p">]</span>
</span><span id="PeakFinder.find_peaks_customized-213"><a href="#PeakFinder.find_peaks_customized-213"><span class="linenos">213</span></a>                        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">rank_peak</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</span><span id="PeakFinder.find_peaks_customized-214"><a href="#PeakFinder.find_peaks_customized-214"><span class="linenos">214</span></a>                        <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">rank_peak</span> <span class="o">&lt;=</span> <span class="n">assay</span><span class="o">.</span><span class="n">amount</span><span class="p">]</span>
</span><span id="PeakFinder.find_peaks_customized-215"><a href="#PeakFinder.find_peaks_customized-215"><span class="linenos">215</span></a>                        <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;rank_peak&quot;</span><span class="p">])</span>
</span><span id="PeakFinder.find_peaks_customized-216"><a href="#PeakFinder.find_peaks_customized-216"><span class="linenos">216</span></a>                    <span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-217"><a href="#PeakFinder.find_peaks_customized-217"><span class="linenos">217</span></a>                <span class="k">elif</span> <span class="n">assay</span><span class="o">.</span><span class="n">which</span> <span class="o">==</span> <span class="s2">&quot;FIRST&quot;</span><span class="p">:</span>
</span><span id="PeakFinder.find_peaks_customized-218"><a href="#PeakFinder.find_peaks_customized-218"><span class="linenos">218</span></a>                    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder.find_peaks_customized-219"><a href="#PeakFinder.find_peaks_customized-219"><span class="linenos">219</span></a>                        <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">max_peak</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</span><span id="PeakFinder.find_peaks_customized-220"><a href="#PeakFinder.find_peaks_customized-220"><span class="linenos">220</span></a>                        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">peaks</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">max_peak</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-221"><a href="#PeakFinder.find_peaks_customized-221"><span class="linenos">221</span></a>                        <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">ratio</span> <span class="o">&gt;</span> <span class="n">assay</span><span class="o">.</span><span class="n">min_ratio</span><span class="p">]</span>
</span><span id="PeakFinder.find_peaks_customized-222"><a href="#PeakFinder.find_peaks_customized-222"><span class="linenos">222</span></a>                        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;basepairs&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-223"><a href="#PeakFinder.find_peaks_customized-223"><span class="linenos">223</span></a>                        <span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">assay</span><span class="o">.</span><span class="n">amount</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-224"><a href="#PeakFinder.find_peaks_customized-224"><span class="linenos">224</span></a>                    <span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-225"><a href="#PeakFinder.find_peaks_customized-225"><span class="linenos">225</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PeakFinder.find_peaks_customized-226"><a href="#PeakFinder.find_peaks_customized-226"><span class="linenos">226</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[ERROR]: column `which` must be `FIRST` or `LARGEST`&quot;</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-227"><a href="#PeakFinder.find_peaks_customized-227"><span class="linenos">227</span></a>                    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-228"><a href="#PeakFinder.find_peaks_customized-228"><span class="linenos">228</span></a>
</span><span id="PeakFinder.find_peaks_customized-229"><a href="#PeakFinder.find_peaks_customized-229"><span class="linenos">229</span></a>            <span class="n">customized_peaks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-230"><a href="#PeakFinder.find_peaks_customized-230"><span class="linenos">230</span></a>
</span><span id="PeakFinder.find_peaks_customized-231"><a href="#PeakFinder.find_peaks_customized-231"><span class="linenos">231</span></a>        <span class="n">peak_information</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PeakFinder.find_peaks_customized-232"><a href="#PeakFinder.find_peaks_customized-232"><span class="linenos">232</span></a>            <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">customized_peaks</span><span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-233"><a href="#PeakFinder.find_peaks_customized-233"><span class="linenos">233</span></a>            <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</span><span id="PeakFinder.find_peaks_customized-234"><a href="#PeakFinder.find_peaks_customized-234"><span class="linenos">234</span></a>            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">peak_name</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="PeakFinder.find_peaks_customized-235"><a href="#PeakFinder.find_peaks_customized-235"><span class="linenos">235</span></a>        <span class="p">)</span>
</span><span id="PeakFinder.find_peaks_customized-236"><a href="#PeakFinder.find_peaks_customized-236"><span class="linenos">236</span></a>
</span><span id="PeakFinder.find_peaks_customized-237"><a href="#PeakFinder.find_peaks_customized-237"><span class="linenos">237</span></a>        <span class="c1"># update peaks_index based on the above filtering</span>
</span><span id="PeakFinder.find_peaks_customized-238"><a href="#PeakFinder.find_peaks_customized-238"><span class="linenos">238</span></a>        <span class="n">peaks_index</span> <span class="o">=</span> <span class="n">peak_information</span><span class="o">.</span><span class="n">peaks_index</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</span><span id="PeakFinder.find_peaks_customized-239"><a href="#PeakFinder.find_peaks_customized-239"><span class="linenos">239</span></a>
</span><span id="PeakFinder.find_peaks_customized-240"><a href="#PeakFinder.find_peaks_customized-240"><span class="linenos">240</span></a>        <span class="c1"># update class attributes</span>
</span><span id="PeakFinder.find_peaks_customized-241"><a href="#PeakFinder.find_peaks_customized-241"><span class="linenos">241</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_index</span> <span class="o">=</span> <span class="n">peaks_index</span>
</span><span id="PeakFinder.find_peaks_customized-242"><a href="#PeakFinder.find_peaks_customized-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peaks_dataframe</span> <span class="o">=</span> <span class="n">peaks_dataframe</span>
</span><span id="PeakFinder.find_peaks_customized-243"><a href="#PeakFinder.find_peaks_customized-243"><span class="linenos">243</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">peak_information</span> <span class="o">=</span> <span class="n">peak_information</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="FragglerPeak">
                            <input id="FragglerPeak-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">FragglerPeak</span>:

                <label class="view-source-button" for="FragglerPeak-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FragglerPeak"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FragglerPeak-13"><a href="#FragglerPeak-13"><span class="linenos">13</span></a><span class="nd">@dataclass</span>
</span><span id="FragglerPeak-14"><a href="#FragglerPeak-14"><span class="linenos">14</span></a><span class="k">class</span> <span class="nc">FragglerPeak</span><span class="p">:</span>
</span><span id="FragglerPeak-15"><a href="#FragglerPeak-15"><span class="linenos">15</span></a>    <span class="n">fsa</span><span class="p">:</span> <span class="n">FsaFile</span>
</span><span id="FragglerPeak-16"><a href="#FragglerPeak-16"><span class="linenos">16</span></a>    <span class="n">ladder_assigner</span><span class="p">:</span> <span class="n">PeakLadderAssigner</span>
</span><span id="FragglerPeak-17"><a href="#FragglerPeak-17"><span class="linenos">17</span></a>    <span class="n">model</span><span class="p">:</span> <span class="n">FitLadderModel</span>
</span><span id="FragglerPeak-18"><a href="#FragglerPeak-18"><span class="linenos">18</span></a>    <span class="n">peaks</span><span class="p">:</span> <span class="n">PeakFinder</span>
</span></pre></div>


    

                            <div id="FragglerPeak.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">FragglerPeak</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">fsa</span><span class="p">:</span> <span class="n"><a href="#FsaFile">FsaFile</a></span>,</span><span class="param">	<span class="n">ladder_assigner</span><span class="p">:</span> <span class="n"><a href="#PeakLadderAssigner">PeakLadderAssigner</a></span>,</span><span class="param">	<span class="n">model</span><span class="p">:</span> <span class="n"><a href="#FitLadderModel">FitLadderModel</a></span>,</span><span class="param">	<span class="n">peaks</span><span class="p">:</span> <span class="n"><a href="#PeakFinder">PeakFinder</a></span></span>)</span>

        
    </div>
    <a class="headerlink" href="#FragglerPeak.__init__"></a>
    
    

                            </div>
                            <div id="FragglerPeak.fsa" class="classattr">
                                <div class="attr variable">
            <span class="name">fsa</span><span class="annotation">: <a href="#FsaFile">FsaFile</a></span>

        
    </div>
    <a class="headerlink" href="#FragglerPeak.fsa"></a>
    
    

                            </div>
                            <div id="FragglerPeak.ladder_assigner" class="classattr">
                                <div class="attr variable">
            <span class="name">ladder_assigner</span><span class="annotation">: <a href="#PeakLadderAssigner">PeakLadderAssigner</a></span>

        
    </div>
    <a class="headerlink" href="#FragglerPeak.ladder_assigner"></a>
    
    

                            </div>
                            <div id="FragglerPeak.model" class="classattr">
                                <div class="attr variable">
            <span class="name">model</span><span class="annotation">: <a href="#FitLadderModel">FitLadderModel</a></span>

        
    </div>
    <a class="headerlink" href="#FragglerPeak.model"></a>
    
    

                            </div>
                            <div id="FragglerPeak.peaks" class="classattr">
                                <div class="attr variable">
            <span class="name">peaks</span><span class="annotation">: <a href="#PeakFinder">PeakFinder</a></span>

        
    </div>
    <a class="headerlink" href="#FragglerPeak.peaks"></a>
    
    

                            </div>
                </section>
                <section id="FragglerArea">
                            <input id="FragglerArea-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">FragglerArea</span>:

                <label class="view-source-button" for="FragglerArea-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FragglerArea"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FragglerArea-21"><a href="#FragglerArea-21"><span class="linenos">21</span></a><span class="nd">@dataclass</span>
</span><span id="FragglerArea-22"><a href="#FragglerArea-22"><span class="linenos">22</span></a><span class="k">class</span> <span class="nc">FragglerArea</span><span class="p">:</span>
</span><span id="FragglerArea-23"><a href="#FragglerArea-23"><span class="linenos">23</span></a>    <span class="n">fsa</span><span class="p">:</span> <span class="n">FsaFile</span>
</span><span id="FragglerArea-24"><a href="#FragglerArea-24"><span class="linenos">24</span></a>    <span class="n">ladder_assigner</span><span class="p">:</span> <span class="n">PeakLadderAssigner</span>
</span><span id="FragglerArea-25"><a href="#FragglerArea-25"><span class="linenos">25</span></a>    <span class="n">model</span><span class="p">:</span> <span class="n">FitLadderModel</span>
</span><span id="FragglerArea-26"><a href="#FragglerArea-26"><span class="linenos">26</span></a>    <span class="n">peaks</span><span class="p">:</span> <span class="n">PeakFinder</span>
</span><span id="FragglerArea-27"><a href="#FragglerArea-27"><span class="linenos">27</span></a>    <span class="n">areas</span><span class="p">:</span> <span class="n">PeakAreaDeMultiplex</span>
</span></pre></div>


    

                            <div id="FragglerArea.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">FragglerArea</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">fsa</span><span class="p">:</span> <span class="n"><a href="#FsaFile">FsaFile</a></span>,</span><span class="param">	<span class="n">ladder_assigner</span><span class="p">:</span> <span class="n"><a href="#PeakLadderAssigner">PeakLadderAssigner</a></span>,</span><span class="param">	<span class="n">model</span><span class="p">:</span> <span class="n"><a href="#FitLadderModel">FitLadderModel</a></span>,</span><span class="param">	<span class="n">peaks</span><span class="p">:</span> <span class="n"><a href="#PeakFinder">PeakFinder</a></span>,</span><span class="param">	<span class="n">areas</span><span class="p">:</span> <span class="n"><a href="#PeakAreaDeMultiplex">PeakAreaDeMultiplex</a></span></span>)</span>

        
    </div>
    <a class="headerlink" href="#FragglerArea.__init__"></a>
    
    

                            </div>
                            <div id="FragglerArea.fsa" class="classattr">
                                <div class="attr variable">
            <span class="name">fsa</span><span class="annotation">: <a href="#FsaFile">FsaFile</a></span>

        
    </div>
    <a class="headerlink" href="#FragglerArea.fsa"></a>
    
    

                            </div>
                            <div id="FragglerArea.ladder_assigner" class="classattr">
                                <div class="attr variable">
            <span class="name">ladder_assigner</span><span class="annotation">: <a href="#PeakLadderAssigner">PeakLadderAssigner</a></span>

        
    </div>
    <a class="headerlink" href="#FragglerArea.ladder_assigner"></a>
    
    

                            </div>
                            <div id="FragglerArea.model" class="classattr">
                                <div class="attr variable">
            <span class="name">model</span><span class="annotation">: <a href="#FitLadderModel">FitLadderModel</a></span>

        
    </div>
    <a class="headerlink" href="#FragglerArea.model"></a>
    
    

                            </div>
                            <div id="FragglerArea.peaks" class="classattr">
                                <div class="attr variable">
            <span class="name">peaks</span><span class="annotation">: <a href="#PeakFinder">PeakFinder</a></span>

        
    </div>
    <a class="headerlink" href="#FragglerArea.peaks"></a>
    
    

                            </div>
                            <div id="FragglerArea.areas" class="classattr">
                                <div class="attr variable">
            <span class="name">areas</span><span class="annotation">: <a href="#PeakAreaDeMultiplex">PeakAreaDeMultiplex</a></span>

        
    </div>
    <a class="headerlink" href="#FragglerArea.areas"></a>
    
    

                            </div>
                </section>
                <section id="make_fraggler_peak">
                            <input id="make_fraggler_peak-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">make_fraggler_peak</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>,</span><span class="param">	<span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">trace_channel</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="#FragglerPeak">FragglerPeak</a></span> <span class="o">|</span> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="make_fraggler_peak-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#make_fraggler_peak"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="make_fraggler_peak-30"><a href="#make_fraggler_peak-30"><span class="linenos">30</span></a><span class="k">def</span> <span class="nf">make_fraggler_peak</span><span class="p">(</span>
</span><span id="make_fraggler_peak-31"><a href="#make_fraggler_peak-31"><span class="linenos">31</span></a>    <span class="n">file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="make_fraggler_peak-32"><a href="#make_fraggler_peak-32"><span class="linenos">32</span></a>    <span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="make_fraggler_peak-33"><a href="#make_fraggler_peak-33"><span class="linenos">33</span></a>    <span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="make_fraggler_peak-34"><a href="#make_fraggler_peak-34"><span class="linenos">34</span></a>    <span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="make_fraggler_peak-35"><a href="#make_fraggler_peak-35"><span class="linenos">35</span></a>    <span class="n">trace_channel</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="make_fraggler_peak-36"><a href="#make_fraggler_peak-36"><span class="linenos">36</span></a>    <span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="make_fraggler_peak-37"><a href="#make_fraggler_peak-37"><span class="linenos">37</span></a>    <span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="make_fraggler_peak-38"><a href="#make_fraggler_peak-38"><span class="linenos">38</span></a>    <span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="make_fraggler_peak-39"><a href="#make_fraggler_peak-39"><span class="linenos">39</span></a>    <span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="make_fraggler_peak-40"><a href="#make_fraggler_peak-40"><span class="linenos">40</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FragglerPeak</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="make_fraggler_peak-41"><a href="#make_fraggler_peak-41"><span class="linenos">41</span></a>    <span class="n">file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="make_fraggler_peak-42"><a href="#make_fraggler_peak-42"><span class="linenos">42</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="make_fraggler_peak-43"><a href="#make_fraggler_peak-43"><span class="linenos">43</span></a>        <span class="n">fsa</span> <span class="o">=</span> <span class="n">FsaFile</span><span class="p">(</span>
</span><span id="make_fraggler_peak-44"><a href="#make_fraggler_peak-44"><span class="linenos">44</span></a>            <span class="n">file</span><span class="p">,</span>
</span><span id="make_fraggler_peak-45"><a href="#make_fraggler_peak-45"><span class="linenos">45</span></a>            <span class="n">ladder</span><span class="p">,</span>
</span><span id="make_fraggler_peak-46"><a href="#make_fraggler_peak-46"><span class="linenos">46</span></a>            <span class="n">min_height</span><span class="o">=</span><span class="n">min_height</span><span class="p">,</span>
</span><span id="make_fraggler_peak-47"><a href="#make_fraggler_peak-47"><span class="linenos">47</span></a>            <span class="n">trace_channel</span><span class="o">=</span><span class="n">trace_channel</span><span class="p">,</span>
</span><span id="make_fraggler_peak-48"><a href="#make_fraggler_peak-48"><span class="linenos">48</span></a>            <span class="n">size_standard_channel</span><span class="o">=</span><span class="n">size_standard_channel</span><span class="p">,</span>
</span><span id="make_fraggler_peak-49"><a href="#make_fraggler_peak-49"><span class="linenos">49</span></a>        <span class="p">)</span>
</span><span id="make_fraggler_peak-50"><a href="#make_fraggler_peak-50"><span class="linenos">50</span></a>        <span class="n">ladder_assigner</span> <span class="o">=</span> <span class="n">PeakLadderAssigner</span><span class="p">(</span><span class="n">fsa</span><span class="p">)</span>
</span><span id="make_fraggler_peak-51"><a href="#make_fraggler_peak-51"><span class="linenos">51</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">FitLadderModel</span><span class="p">(</span><span class="n">ladder_assigner</span><span class="p">)</span>
</span><span id="make_fraggler_peak-52"><a href="#make_fraggler_peak-52"><span class="linenos">52</span></a>        <span class="n">peaks</span> <span class="o">=</span> <span class="n">PeakFinder</span><span class="p">(</span>
</span><span id="make_fraggler_peak-53"><a href="#make_fraggler_peak-53"><span class="linenos">53</span></a>            <span class="n">model</span><span class="p">,</span>
</span><span id="make_fraggler_peak-54"><a href="#make_fraggler_peak-54"><span class="linenos">54</span></a>            <span class="n">min_ratio</span><span class="o">=</span><span class="n">min_ratio</span><span class="p">,</span>
</span><span id="make_fraggler_peak-55"><a href="#make_fraggler_peak-55"><span class="linenos">55</span></a>            <span class="n">peak_height</span><span class="o">=</span><span class="n">peak_height</span><span class="p">,</span>
</span><span id="make_fraggler_peak-56"><a href="#make_fraggler_peak-56"><span class="linenos">56</span></a>            <span class="n">custom_peaks</span><span class="o">=</span><span class="n">custom_peaks</span><span class="p">,</span>
</span><span id="make_fraggler_peak-57"><a href="#make_fraggler_peak-57"><span class="linenos">57</span></a>            <span class="n">distance_between_assays</span><span class="o">=</span><span class="n">distance_between_assays</span><span class="p">,</span>
</span><span id="make_fraggler_peak-58"><a href="#make_fraggler_peak-58"><span class="linenos">58</span></a>        <span class="p">)</span>
</span><span id="make_fraggler_peak-59"><a href="#make_fraggler_peak-59"><span class="linenos">59</span></a>
</span><span id="make_fraggler_peak-60"><a href="#make_fraggler_peak-60"><span class="linenos">60</span></a>        <span class="k">return</span> <span class="n">FragglerPeak</span><span class="p">(</span>
</span><span id="make_fraggler_peak-61"><a href="#make_fraggler_peak-61"><span class="linenos">61</span></a>            <span class="n">fsa</span><span class="o">=</span><span class="n">fsa</span><span class="p">,</span>
</span><span id="make_fraggler_peak-62"><a href="#make_fraggler_peak-62"><span class="linenos">62</span></a>            <span class="n">ladder_assigner</span><span class="o">=</span><span class="n">ladder_assigner</span><span class="p">,</span>
</span><span id="make_fraggler_peak-63"><a href="#make_fraggler_peak-63"><span class="linenos">63</span></a>            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
</span><span id="make_fraggler_peak-64"><a href="#make_fraggler_peak-64"><span class="linenos">64</span></a>            <span class="n">peaks</span><span class="o">=</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="make_fraggler_peak-65"><a href="#make_fraggler_peak-65"><span class="linenos">65</span></a>        <span class="p">)</span>
</span><span id="make_fraggler_peak-66"><a href="#make_fraggler_peak-66"><span class="linenos">66</span></a>
</span><span id="make_fraggler_peak-67"><a href="#make_fraggler_peak-67"><span class="linenos">67</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="make_fraggler_peak-68"><a href="#make_fraggler_peak-68"><span class="linenos">68</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="make_fraggler_peak-69"><a href="#make_fraggler_peak-69"><span class="linenos">69</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Following file did not work: </span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span>
</span><span id="make_fraggler_peak-70"><a href="#make_fraggler_peak-70"><span class="linenos">70</span></a><span class="s2">        Reason: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span>
</span><span id="make_fraggler_peak-71"><a href="#make_fraggler_peak-71"><span class="linenos">71</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="make_fraggler_peak-72"><a href="#make_fraggler_peak-72"><span class="linenos">72</span></a>        <span class="p">)</span>
</span><span id="make_fraggler_peak-73"><a href="#make_fraggler_peak-73"><span class="linenos">73</span></a>
</span><span id="make_fraggler_peak-74"><a href="#make_fraggler_peak-74"><span class="linenos">74</span></a>        <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="n">stem</span>
</span></pre></div>


    

                </section>
                <section id="make_fraggler_area">
                            <input id="make_fraggler_area-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">make_fraggler_area</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">file</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>,</span><span class="param">	<span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">trace_channel</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">cutoff</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="#FragglerArea">FragglerArea</a></span> <span class="o">|</span> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="make_fraggler_area-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#make_fraggler_area"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="make_fraggler_area-77"><a href="#make_fraggler_area-77"><span class="linenos"> 77</span></a><span class="k">def</span> <span class="nf">make_fraggler_area</span><span class="p">(</span>
</span><span id="make_fraggler_area-78"><a href="#make_fraggler_area-78"><span class="linenos"> 78</span></a>    <span class="n">file</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="make_fraggler_area-79"><a href="#make_fraggler_area-79"><span class="linenos"> 79</span></a>    <span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="make_fraggler_area-80"><a href="#make_fraggler_area-80"><span class="linenos"> 80</span></a>    <span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="make_fraggler_area-81"><a href="#make_fraggler_area-81"><span class="linenos"> 81</span></a>    <span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="make_fraggler_area-82"><a href="#make_fraggler_area-82"><span class="linenos"> 82</span></a>    <span class="n">trace_channel</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="make_fraggler_area-83"><a href="#make_fraggler_area-83"><span class="linenos"> 83</span></a>    <span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="make_fraggler_area-84"><a href="#make_fraggler_area-84"><span class="linenos"> 84</span></a>    <span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="make_fraggler_area-85"><a href="#make_fraggler_area-85"><span class="linenos"> 85</span></a>    <span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="make_fraggler_area-86"><a href="#make_fraggler_area-86"><span class="linenos"> 86</span></a>    <span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="make_fraggler_area-87"><a href="#make_fraggler_area-87"><span class="linenos"> 87</span></a>    <span class="n">cutoff</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="make_fraggler_area-88"><a href="#make_fraggler_area-88"><span class="linenos"> 88</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FragglerArea</span> <span class="o">|</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="make_fraggler_area-89"><a href="#make_fraggler_area-89"><span class="linenos"> 89</span></a>    <span class="n">file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="make_fraggler_area-90"><a href="#make_fraggler_area-90"><span class="linenos"> 90</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="make_fraggler_area-91"><a href="#make_fraggler_area-91"><span class="linenos"> 91</span></a>        <span class="n">fsa</span> <span class="o">=</span> <span class="n">FsaFile</span><span class="p">(</span>
</span><span id="make_fraggler_area-92"><a href="#make_fraggler_area-92"><span class="linenos"> 92</span></a>            <span class="n">file</span><span class="p">,</span>
</span><span id="make_fraggler_area-93"><a href="#make_fraggler_area-93"><span class="linenos"> 93</span></a>            <span class="n">ladder</span><span class="p">,</span>
</span><span id="make_fraggler_area-94"><a href="#make_fraggler_area-94"><span class="linenos"> 94</span></a>            <span class="n">min_height</span><span class="o">=</span><span class="n">min_height</span><span class="p">,</span>
</span><span id="make_fraggler_area-95"><a href="#make_fraggler_area-95"><span class="linenos"> 95</span></a>            <span class="n">trace_channel</span><span class="o">=</span><span class="n">trace_channel</span><span class="p">,</span>
</span><span id="make_fraggler_area-96"><a href="#make_fraggler_area-96"><span class="linenos"> 96</span></a>            <span class="n">size_standard_channel</span><span class="o">=</span><span class="n">size_standard_channel</span><span class="p">,</span>
</span><span id="make_fraggler_area-97"><a href="#make_fraggler_area-97"><span class="linenos"> 97</span></a>        <span class="p">)</span>
</span><span id="make_fraggler_area-98"><a href="#make_fraggler_area-98"><span class="linenos"> 98</span></a>        <span class="n">ladder_assigner</span> <span class="o">=</span> <span class="n">PeakLadderAssigner</span><span class="p">(</span><span class="n">fsa</span><span class="p">)</span>
</span><span id="make_fraggler_area-99"><a href="#make_fraggler_area-99"><span class="linenos"> 99</span></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">FitLadderModel</span><span class="p">(</span><span class="n">ladder_assigner</span><span class="p">)</span>
</span><span id="make_fraggler_area-100"><a href="#make_fraggler_area-100"><span class="linenos">100</span></a>        <span class="n">peaks</span> <span class="o">=</span> <span class="n">PeakFinder</span><span class="p">(</span>
</span><span id="make_fraggler_area-101"><a href="#make_fraggler_area-101"><span class="linenos">101</span></a>            <span class="n">model</span><span class="p">,</span>
</span><span id="make_fraggler_area-102"><a href="#make_fraggler_area-102"><span class="linenos">102</span></a>            <span class="n">min_ratio</span><span class="o">=</span><span class="n">min_ratio</span><span class="p">,</span>
</span><span id="make_fraggler_area-103"><a href="#make_fraggler_area-103"><span class="linenos">103</span></a>            <span class="n">peak_height</span><span class="o">=</span><span class="n">peak_height</span><span class="p">,</span>
</span><span id="make_fraggler_area-104"><a href="#make_fraggler_area-104"><span class="linenos">104</span></a>            <span class="n">custom_peaks</span><span class="o">=</span><span class="n">custom_peaks</span><span class="p">,</span>
</span><span id="make_fraggler_area-105"><a href="#make_fraggler_area-105"><span class="linenos">105</span></a>            <span class="n">distance_between_assays</span><span class="o">=</span><span class="n">distance_between_assays</span><span class="p">,</span>
</span><span id="make_fraggler_area-106"><a href="#make_fraggler_area-106"><span class="linenos">106</span></a>        <span class="p">)</span>
</span><span id="make_fraggler_area-107"><a href="#make_fraggler_area-107"><span class="linenos">107</span></a>        <span class="n">areas</span> <span class="o">=</span> <span class="n">PeakAreaDeMultiplex</span><span class="p">(</span>
</span><span id="make_fraggler_area-108"><a href="#make_fraggler_area-108"><span class="linenos">108</span></a>            <span class="n">peaks</span><span class="p">,</span>
</span><span id="make_fraggler_area-109"><a href="#make_fraggler_area-109"><span class="linenos">109</span></a>            <span class="n">cutoff</span><span class="p">,</span>
</span><span id="make_fraggler_area-110"><a href="#make_fraggler_area-110"><span class="linenos">110</span></a>        <span class="p">)</span>
</span><span id="make_fraggler_area-111"><a href="#make_fraggler_area-111"><span class="linenos">111</span></a>
</span><span id="make_fraggler_area-112"><a href="#make_fraggler_area-112"><span class="linenos">112</span></a>        <span class="k">return</span> <span class="n">FragglerArea</span><span class="p">(</span>
</span><span id="make_fraggler_area-113"><a href="#make_fraggler_area-113"><span class="linenos">113</span></a>            <span class="n">fsa</span><span class="o">=</span><span class="n">fsa</span><span class="p">,</span>
</span><span id="make_fraggler_area-114"><a href="#make_fraggler_area-114"><span class="linenos">114</span></a>            <span class="n">ladder_assigner</span><span class="o">=</span><span class="n">ladder_assigner</span><span class="p">,</span>
</span><span id="make_fraggler_area-115"><a href="#make_fraggler_area-115"><span class="linenos">115</span></a>            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
</span><span id="make_fraggler_area-116"><a href="#make_fraggler_area-116"><span class="linenos">116</span></a>            <span class="n">peaks</span><span class="o">=</span><span class="n">peaks</span><span class="p">,</span>
</span><span id="make_fraggler_area-117"><a href="#make_fraggler_area-117"><span class="linenos">117</span></a>            <span class="n">areas</span><span class="o">=</span><span class="n">areas</span><span class="p">,</span>
</span><span id="make_fraggler_area-118"><a href="#make_fraggler_area-118"><span class="linenos">118</span></a>        <span class="p">)</span>
</span><span id="make_fraggler_area-119"><a href="#make_fraggler_area-119"><span class="linenos">119</span></a>
</span><span id="make_fraggler_area-120"><a href="#make_fraggler_area-120"><span class="linenos">120</span></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="make_fraggler_area-121"><a href="#make_fraggler_area-121"><span class="linenos">121</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
</span><span id="make_fraggler_area-122"><a href="#make_fraggler_area-122"><span class="linenos">122</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Following file did not work: </span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span>
</span><span id="make_fraggler_area-123"><a href="#make_fraggler_area-123"><span class="linenos">123</span></a><span class="s2">        Reason: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span>
</span><span id="make_fraggler_area-124"><a href="#make_fraggler_area-124"><span class="linenos">124</span></a><span class="s2">        &quot;&quot;&quot;</span>
</span><span id="make_fraggler_area-125"><a href="#make_fraggler_area-125"><span class="linenos">125</span></a>        <span class="p">)</span>
</span><span id="make_fraggler_area-126"><a href="#make_fraggler_area-126"><span class="linenos">126</span></a>
</span><span id="make_fraggler_area-127"><a href="#make_fraggler_area-127"><span class="linenos">127</span></a>        <span class="k">return</span> <span class="n">file</span><span class="o">.</span><span class="n">stem</span>
</span></pre></div>


    

                </section>
                <section id="generate_peak_report">
                            <input id="generate_peak_report-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_peak_report</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">fraggler</span><span class="p">:</span> <span class="n"><a href="#FragglerPeak">FragglerPeak</a></span></span><span class="return-annotation">) -> <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">Column</span>:</span></span>

                <label class="view-source-button" for="generate_peak_report-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_peak_report"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_peak_report-64"><a href="#generate_peak_report-64"><span class="linenos"> 64</span></a><span class="k">def</span> <span class="nf">generate_peak_report</span><span class="p">(</span><span class="n">fraggler</span><span class="p">:</span> <span class="n">FragglerPeak</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pn</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">Column</span><span class="p">:</span>
</span><span id="generate_peak_report-65"><a href="#generate_peak_report-65"><span class="linenos"> 65</span></a>    <span class="c1">### ----- Raw Data ----- ###</span>
</span><span id="generate_peak_report-66"><a href="#generate_peak_report-66"><span class="linenos"> 66</span></a>    <span class="n">channel_header</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_peak_report-67"><a href="#generate_peak_report-67"><span class="linenos"> 67</span></a>        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;## Plot of channels&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-68"><a href="#generate_peak_report-68"><span class="linenos"> 68</span></a>        <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;#04c273&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-69"><a href="#generate_peak_report-69"><span class="linenos"> 69</span></a>        <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="generate_peak_report-70"><a href="#generate_peak_report-70"><span class="linenos"> 70</span></a>        <span class="n">textalign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-71"><a href="#generate_peak_report-71"><span class="linenos"> 71</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-72"><a href="#generate_peak_report-72"><span class="linenos"> 72</span></a>    <span class="c1"># PLOT</span>
</span><span id="generate_peak_report-73"><a href="#generate_peak_report-73"><span class="linenos"> 73</span></a>    <span class="n">channel_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">()</span>
</span><span id="generate_peak_report-74"><a href="#generate_peak_report-74"><span class="linenos"> 74</span></a>    <span class="k">for</span> <span class="n">plot</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">plot_fsa_data</span><span class="p">(</span><span class="n">fraggler</span><span class="o">.</span><span class="n">fsa</span><span class="p">):</span>
</span><span id="generate_peak_report-75"><a href="#generate_peak_report-75"><span class="linenos"> 75</span></a>        <span class="n">pane</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Vega</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">interactive</span><span class="p">(),</span> <span class="n">sizing_mode</span><span class="o">=</span><span class="s2">&quot;stretch_both&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="generate_peak_report-76"><a href="#generate_peak_report-76"><span class="linenos"> 76</span></a>        <span class="n">channel_tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pane</span><span class="p">)</span>
</span><span id="generate_peak_report-77"><a href="#generate_peak_report-77"><span class="linenos"> 77</span></a>
</span><span id="generate_peak_report-78"><a href="#generate_peak_report-78"><span class="linenos"> 78</span></a>    <span class="n">channels_section</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">channel_header</span><span class="p">,</span> <span class="n">channel_tab</span><span class="p">)</span>
</span><span id="generate_peak_report-79"><a href="#generate_peak_report-79"><span class="linenos"> 79</span></a>
</span><span id="generate_peak_report-80"><a href="#generate_peak_report-80"><span class="linenos"> 80</span></a>    <span class="c1">### ----- Peaks ----- ###</span>
</span><span id="generate_peak_report-81"><a href="#generate_peak_report-81"><span class="linenos"> 81</span></a>    <span class="n">peaks_header</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_peak_report-82"><a href="#generate_peak_report-82"><span class="linenos"> 82</span></a>        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;## Plot of Peaks&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-83"><a href="#generate_peak_report-83"><span class="linenos"> 83</span></a>        <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;#04c273&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-84"><a href="#generate_peak_report-84"><span class="linenos"> 84</span></a>        <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="generate_peak_report-85"><a href="#generate_peak_report-85"><span class="linenos"> 85</span></a>        <span class="n">textalign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-86"><a href="#generate_peak_report-86"><span class="linenos"> 86</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-87"><a href="#generate_peak_report-87"><span class="linenos"> 87</span></a>
</span><span id="generate_peak_report-88"><a href="#generate_peak_report-88"><span class="linenos"> 88</span></a>    <span class="c1"># PLOT</span>
</span><span id="generate_peak_report-89"><a href="#generate_peak_report-89"><span class="linenos"> 89</span></a>    <span class="n">peaks_plot</span> <span class="o">=</span> <span class="n">PlotPeaks</span><span class="p">(</span><span class="n">fraggler</span><span class="o">.</span><span class="n">peaks</span><span class="p">)</span><span class="o">.</span><span class="n">plot_peaks</span>
</span><span id="generate_peak_report-90"><a href="#generate_peak_report-90"><span class="linenos"> 90</span></a>    <span class="n">peaks_pane</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Matplotlib</span><span class="p">(</span><span class="n">peaks_plot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Peaks&quot;</span><span class="p">)</span>
</span><span id="generate_peak_report-91"><a href="#generate_peak_report-91"><span class="linenos"> 91</span></a>
</span><span id="generate_peak_report-92"><a href="#generate_peak_report-92"><span class="linenos"> 92</span></a>    <span class="c1"># Section</span>
</span><span id="generate_peak_report-93"><a href="#generate_peak_report-93"><span class="linenos"> 93</span></a>    <span class="n">peaks_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">(</span>
</span><span id="generate_peak_report-94"><a href="#generate_peak_report-94"><span class="linenos"> 94</span></a>        <span class="n">peaks_pane</span><span class="p">,</span>
</span><span id="generate_peak_report-95"><a href="#generate_peak_report-95"><span class="linenos"> 95</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-96"><a href="#generate_peak_report-96"><span class="linenos"> 96</span></a>    <span class="n">peaks_section</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">peaks_header</span><span class="p">,</span> <span class="n">peaks_tab</span><span class="p">)</span>
</span><span id="generate_peak_report-97"><a href="#generate_peak_report-97"><span class="linenos"> 97</span></a>
</span><span id="generate_peak_report-98"><a href="#generate_peak_report-98"><span class="linenos"> 98</span></a>    <span class="c1">### ----- Ladder Information ----- ###</span>
</span><span id="generate_peak_report-99"><a href="#generate_peak_report-99"><span class="linenos"> 99</span></a>    <span class="n">ladder_header</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_peak_report-100"><a href="#generate_peak_report-100"><span class="linenos">100</span></a>        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;## Information about the ladder&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-101"><a href="#generate_peak_report-101"><span class="linenos">101</span></a>        <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;#04c273&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-102"><a href="#generate_peak_report-102"><span class="linenos">102</span></a>        <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="generate_peak_report-103"><a href="#generate_peak_report-103"><span class="linenos">103</span></a>        <span class="n">textalign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-104"><a href="#generate_peak_report-104"><span class="linenos">104</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-105"><a href="#generate_peak_report-105"><span class="linenos">105</span></a>    <span class="c1"># Ladder peak plot</span>
</span><span id="generate_peak_report-106"><a href="#generate_peak_report-106"><span class="linenos">106</span></a>    <span class="n">ladder_plot</span> <span class="o">=</span> <span class="n">PlotLadder</span><span class="p">(</span><span class="n">fraggler</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
</span><span id="generate_peak_report-107"><a href="#generate_peak_report-107"><span class="linenos">107</span></a>    <span class="n">ladder_peak_plot</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Matplotlib</span><span class="p">(</span>
</span><span id="generate_peak_report-108"><a href="#generate_peak_report-108"><span class="linenos">108</span></a>        <span class="n">ladder_plot</span><span class="o">.</span><span class="n">plot_ladder_peaks</span><span class="p">,</span>
</span><span id="generate_peak_report-109"><a href="#generate_peak_report-109"><span class="linenos">109</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ladder Peak Plot&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-110"><a href="#generate_peak_report-110"><span class="linenos">110</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-111"><a href="#generate_peak_report-111"><span class="linenos">111</span></a>    <span class="c1"># Ladder Correlation</span>
</span><span id="generate_peak_report-112"><a href="#generate_peak_report-112"><span class="linenos">112</span></a>    <span class="n">ladder_correlation_plot</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Matplotlib</span><span class="p">(</span>
</span><span id="generate_peak_report-113"><a href="#generate_peak_report-113"><span class="linenos">113</span></a>        <span class="n">ladder_plot</span><span class="o">.</span><span class="n">plot_model_fit</span><span class="p">,</span>
</span><span id="generate_peak_report-114"><a href="#generate_peak_report-114"><span class="linenos">114</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ladder Correlation Plot&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-115"><a href="#generate_peak_report-115"><span class="linenos">115</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-116"><a href="#generate_peak_report-116"><span class="linenos">116</span></a>
</span><span id="generate_peak_report-117"><a href="#generate_peak_report-117"><span class="linenos">117</span></a>    <span class="c1"># Section</span>
</span><span id="generate_peak_report-118"><a href="#generate_peak_report-118"><span class="linenos">118</span></a>    <span class="n">ladder_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">(</span>
</span><span id="generate_peak_report-119"><a href="#generate_peak_report-119"><span class="linenos">119</span></a>        <span class="n">ladder_peak_plot</span><span class="p">,</span>
</span><span id="generate_peak_report-120"><a href="#generate_peak_report-120"><span class="linenos">120</span></a>        <span class="n">ladder_correlation_plot</span><span class="p">,</span>
</span><span id="generate_peak_report-121"><a href="#generate_peak_report-121"><span class="linenos">121</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-122"><a href="#generate_peak_report-122"><span class="linenos">122</span></a>    <span class="n">ladder_section</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">ladder_header</span><span class="p">,</span> <span class="n">ladder_tab</span><span class="p">)</span>
</span><span id="generate_peak_report-123"><a href="#generate_peak_report-123"><span class="linenos">123</span></a>
</span><span id="generate_peak_report-124"><a href="#generate_peak_report-124"><span class="linenos">124</span></a>    <span class="c1">### ----- Peaks dataframe ----- ###</span>
</span><span id="generate_peak_report-125"><a href="#generate_peak_report-125"><span class="linenos">125</span></a>    <span class="n">dataframe_header</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_peak_report-126"><a href="#generate_peak_report-126"><span class="linenos">126</span></a>        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;## Peaks Table&quot;</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;#04c273&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">textalign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
</span><span id="generate_peak_report-127"><a href="#generate_peak_report-127"><span class="linenos">127</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-128"><a href="#generate_peak_report-128"><span class="linenos">128</span></a>    <span class="c1"># Create dataframe</span>
</span><span id="generate_peak_report-129"><a href="#generate_peak_report-129"><span class="linenos">129</span></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">fraggler</span><span class="o">.</span><span class="n">fsa</span><span class="o">.</span><span class="n">file_name</span><span class="p">)[</span>
</span><span id="generate_peak_report-130"><a href="#generate_peak_report-130"><span class="linenos">130</span></a>        <span class="p">[</span><span class="s2">&quot;file_name&quot;</span><span class="p">,</span> <span class="s2">&quot;basepairs&quot;</span><span class="p">,</span> <span class="s2">&quot;peaks&quot;</span><span class="p">,</span> <span class="s2">&quot;assay_name&quot;</span><span class="p">]</span>
</span><span id="generate_peak_report-131"><a href="#generate_peak_report-131"><span class="linenos">131</span></a>    <span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;peaks&quot;</span><span class="p">:</span> <span class="s2">&quot;peak_height&quot;</span><span class="p">})</span>
</span><span id="generate_peak_report-132"><a href="#generate_peak_report-132"><span class="linenos">132</span></a>    <span class="c1"># DataFrame Tabulator</span>
</span><span id="generate_peak_report-133"><a href="#generate_peak_report-133"><span class="linenos">133</span></a>    <span class="n">peaks_df_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Tabulator</span><span class="p">(</span>
</span><span id="generate_peak_report-134"><a href="#generate_peak_report-134"><span class="linenos">134</span></a>        <span class="n">df</span><span class="p">,</span>
</span><span id="generate_peak_report-135"><a href="#generate_peak_report-135"><span class="linenos">135</span></a>        <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;fit_columns&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-136"><a href="#generate_peak_report-136"><span class="linenos">136</span></a>        <span class="n">pagination</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-137"><a href="#generate_peak_report-137"><span class="linenos">137</span></a>        <span class="n">page_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
</span><span id="generate_peak_report-138"><a href="#generate_peak_report-138"><span class="linenos">138</span></a>        <span class="n">show_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="generate_peak_report-139"><a href="#generate_peak_report-139"><span class="linenos">139</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Peaks Table&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-140"><a href="#generate_peak_report-140"><span class="linenos">140</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-141"><a href="#generate_peak_report-141"><span class="linenos">141</span></a>
</span><span id="generate_peak_report-142"><a href="#generate_peak_report-142"><span class="linenos">142</span></a>    <span class="c1"># Section</span>
</span><span id="generate_peak_report-143"><a href="#generate_peak_report-143"><span class="linenos">143</span></a>    <span class="n">dataframe_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">(</span><span class="n">peaks_df_tab</span><span class="p">)</span>
</span><span id="generate_peak_report-144"><a href="#generate_peak_report-144"><span class="linenos">144</span></a>    <span class="n">dataframe_section</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">dataframe_header</span><span class="p">,</span> <span class="n">dataframe_tab</span><span class="p">)</span>
</span><span id="generate_peak_report-145"><a href="#generate_peak_report-145"><span class="linenos">145</span></a>
</span><span id="generate_peak_report-146"><a href="#generate_peak_report-146"><span class="linenos">146</span></a>    <span class="c1">### CREATE REPORT ###</span>
</span><span id="generate_peak_report-147"><a href="#generate_peak_report-147"><span class="linenos">147</span></a>
</span><span id="generate_peak_report-148"><a href="#generate_peak_report-148"><span class="linenos">148</span></a>    <span class="n">file_name</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">fsa</span><span class="o">.</span><span class="n">file_name</span>
</span><span id="generate_peak_report-149"><a href="#generate_peak_report-149"><span class="linenos">149</span></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">fsa</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="s2">&quot;RUND1&quot;</span><span class="p">]</span>
</span><span id="generate_peak_report-150"><a href="#generate_peak_report-150"><span class="linenos">150</span></a>    <span class="n">head</span> <span class="o">=</span> <span class="n">make_header</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
</span><span id="generate_peak_report-151"><a href="#generate_peak_report-151"><span class="linenos">151</span></a>
</span><span id="generate_peak_report-152"><a href="#generate_peak_report-152"><span class="linenos">152</span></a>    <span class="n">all_tabs</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">(</span>
</span><span id="generate_peak_report-153"><a href="#generate_peak_report-153"><span class="linenos">153</span></a>        <span class="p">(</span><span class="s2">&quot;Channels&quot;</span><span class="p">,</span> <span class="n">channels_section</span><span class="p">),</span>
</span><span id="generate_peak_report-154"><a href="#generate_peak_report-154"><span class="linenos">154</span></a>        <span class="p">(</span><span class="s2">&quot;Peaks&quot;</span><span class="p">,</span> <span class="n">peaks_section</span><span class="p">),</span>
</span><span id="generate_peak_report-155"><a href="#generate_peak_report-155"><span class="linenos">155</span></a>        <span class="p">(</span><span class="s2">&quot;Ladder&quot;</span><span class="p">,</span> <span class="n">ladder_section</span><span class="p">),</span>
</span><span id="generate_peak_report-156"><a href="#generate_peak_report-156"><span class="linenos">156</span></a>        <span class="p">(</span><span class="s2">&quot;Peaks Table&quot;</span><span class="p">,</span> <span class="n">dataframe_section</span><span class="p">),</span>
</span><span id="generate_peak_report-157"><a href="#generate_peak_report-157"><span class="linenos">157</span></a>        <span class="n">tabs_location</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="generate_peak_report-158"><a href="#generate_peak_report-158"><span class="linenos">158</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-159"><a href="#generate_peak_report-159"><span class="linenos">159</span></a>    <span class="n">report</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
</span><span id="generate_peak_report-160"><a href="#generate_peak_report-160"><span class="linenos">160</span></a>        <span class="n">head</span><span class="p">,</span>
</span><span id="generate_peak_report-161"><a href="#generate_peak_report-161"><span class="linenos">161</span></a>        <span class="n">pn</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">Divider</span><span class="p">(),</span>
</span><span id="generate_peak_report-162"><a href="#generate_peak_report-162"><span class="linenos">162</span></a>        <span class="n">all_tabs</span><span class="p">,</span>
</span><span id="generate_peak_report-163"><a href="#generate_peak_report-163"><span class="linenos">163</span></a>    <span class="p">)</span>
</span><span id="generate_peak_report-164"><a href="#generate_peak_report-164"><span class="linenos">164</span></a>
</span><span id="generate_peak_report-165"><a href="#generate_peak_report-165"><span class="linenos">165</span></a>    <span class="k">return</span> <span class="n">report</span>
</span></pre></div>


    

                </section>
                <section id="generate_area_report">
                            <input id="generate_area_report-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_area_report</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">fraggler</span><span class="p">:</span> <span class="n"><a href="#FragglerArea">FragglerArea</a></span>,</span><span class="param">	<span class="n">peak_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;gauss&#39;</span></span><span class="return-annotation">) -> <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">Column</span>:</span></span>

                <label class="view-source-button" for="generate_area_report-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_area_report"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_area_report-168"><a href="#generate_area_report-168"><span class="linenos">168</span></a><span class="k">def</span> <span class="nf">generate_area_report</span><span class="p">(</span>
</span><span id="generate_area_report-169"><a href="#generate_area_report-169"><span class="linenos">169</span></a>    <span class="n">fraggler</span><span class="p">:</span> <span class="n">FragglerArea</span><span class="p">,</span>
</span><span id="generate_area_report-170"><a href="#generate_area_report-170"><span class="linenos">170</span></a>    <span class="n">peak_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gauss&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-171"><a href="#generate_area_report-171"><span class="linenos">171</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pn</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">Column</span><span class="p">:</span>
</span><span id="generate_area_report-172"><a href="#generate_area_report-172"><span class="linenos">172</span></a>
</span><span id="generate_area_report-173"><a href="#generate_area_report-173"><span class="linenos">173</span></a>    <span class="c1">### ----- Raw Data ----- ###</span>
</span><span id="generate_area_report-174"><a href="#generate_area_report-174"><span class="linenos">174</span></a>    <span class="n">channel_header</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_area_report-175"><a href="#generate_area_report-175"><span class="linenos">175</span></a>        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;## Plot of channels&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-176"><a href="#generate_area_report-176"><span class="linenos">176</span></a>        <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;#04c273&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-177"><a href="#generate_area_report-177"><span class="linenos">177</span></a>        <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="generate_area_report-178"><a href="#generate_area_report-178"><span class="linenos">178</span></a>        <span class="n">textalign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-179"><a href="#generate_area_report-179"><span class="linenos">179</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-180"><a href="#generate_area_report-180"><span class="linenos">180</span></a>    <span class="c1"># PLOT</span>
</span><span id="generate_area_report-181"><a href="#generate_area_report-181"><span class="linenos">181</span></a>    <span class="n">channel_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">()</span>
</span><span id="generate_area_report-182"><a href="#generate_area_report-182"><span class="linenos">182</span></a>    <span class="k">for</span> <span class="n">plot</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">plot_fsa_data</span><span class="p">(</span><span class="n">fraggler</span><span class="o">.</span><span class="n">fsa</span><span class="p">):</span>
</span><span id="generate_area_report-183"><a href="#generate_area_report-183"><span class="linenos">183</span></a>        <span class="n">pane</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Vega</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">interactive</span><span class="p">(),</span> <span class="n">sizing_mode</span><span class="o">=</span><span class="s2">&quot;stretch_both&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="generate_area_report-184"><a href="#generate_area_report-184"><span class="linenos">184</span></a>        <span class="n">channel_tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pane</span><span class="p">)</span>
</span><span id="generate_area_report-185"><a href="#generate_area_report-185"><span class="linenos">185</span></a>
</span><span id="generate_area_report-186"><a href="#generate_area_report-186"><span class="linenos">186</span></a>    <span class="n">channels_section</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">channel_header</span><span class="p">,</span> <span class="n">channel_tab</span><span class="p">)</span>
</span><span id="generate_area_report-187"><a href="#generate_area_report-187"><span class="linenos">187</span></a>
</span><span id="generate_area_report-188"><a href="#generate_area_report-188"><span class="linenos">188</span></a>    <span class="c1">### ----- Peaks ----- ###</span>
</span><span id="generate_area_report-189"><a href="#generate_area_report-189"><span class="linenos">189</span></a>    <span class="n">peaks_header</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_area_report-190"><a href="#generate_area_report-190"><span class="linenos">190</span></a>        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;## Plot of Peaks&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-191"><a href="#generate_area_report-191"><span class="linenos">191</span></a>        <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;#04c273&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-192"><a href="#generate_area_report-192"><span class="linenos">192</span></a>        <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="generate_area_report-193"><a href="#generate_area_report-193"><span class="linenos">193</span></a>        <span class="n">textalign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-194"><a href="#generate_area_report-194"><span class="linenos">194</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-195"><a href="#generate_area_report-195"><span class="linenos">195</span></a>
</span><span id="generate_area_report-196"><a href="#generate_area_report-196"><span class="linenos">196</span></a>    <span class="c1"># PLOT</span>
</span><span id="generate_area_report-197"><a href="#generate_area_report-197"><span class="linenos">197</span></a>    <span class="n">peaks_plot</span> <span class="o">=</span> <span class="n">PlotPeaks</span><span class="p">(</span><span class="n">fraggler</span><span class="o">.</span><span class="n">peaks</span><span class="p">)</span><span class="o">.</span><span class="n">plot_peaks</span>
</span><span id="generate_area_report-198"><a href="#generate_area_report-198"><span class="linenos">198</span></a>    <span class="n">peaks_pane</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Matplotlib</span><span class="p">(</span><span class="n">peaks_plot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Peaks&quot;</span><span class="p">)</span>
</span><span id="generate_area_report-199"><a href="#generate_area_report-199"><span class="linenos">199</span></a>
</span><span id="generate_area_report-200"><a href="#generate_area_report-200"><span class="linenos">200</span></a>    <span class="c1"># Section</span>
</span><span id="generate_area_report-201"><a href="#generate_area_report-201"><span class="linenos">201</span></a>    <span class="n">peaks_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">(</span>
</span><span id="generate_area_report-202"><a href="#generate_area_report-202"><span class="linenos">202</span></a>        <span class="n">peaks_pane</span><span class="p">,</span>
</span><span id="generate_area_report-203"><a href="#generate_area_report-203"><span class="linenos">203</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-204"><a href="#generate_area_report-204"><span class="linenos">204</span></a>    <span class="n">peaks_section</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">peaks_header</span><span class="p">,</span> <span class="n">peaks_tab</span><span class="p">)</span>
</span><span id="generate_area_report-205"><a href="#generate_area_report-205"><span class="linenos">205</span></a>
</span><span id="generate_area_report-206"><a href="#generate_area_report-206"><span class="linenos">206</span></a>    <span class="c1">### ----- Ladder Information ----- ###</span>
</span><span id="generate_area_report-207"><a href="#generate_area_report-207"><span class="linenos">207</span></a>    <span class="n">ladder_header</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_area_report-208"><a href="#generate_area_report-208"><span class="linenos">208</span></a>        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;## Information about the ladder&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-209"><a href="#generate_area_report-209"><span class="linenos">209</span></a>        <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;#04c273&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-210"><a href="#generate_area_report-210"><span class="linenos">210</span></a>        <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="generate_area_report-211"><a href="#generate_area_report-211"><span class="linenos">211</span></a>        <span class="n">textalign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-212"><a href="#generate_area_report-212"><span class="linenos">212</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-213"><a href="#generate_area_report-213"><span class="linenos">213</span></a>    <span class="c1"># Ladder peak plot</span>
</span><span id="generate_area_report-214"><a href="#generate_area_report-214"><span class="linenos">214</span></a>    <span class="n">ladder_plot</span> <span class="o">=</span> <span class="n">PlotLadder</span><span class="p">(</span><span class="n">fraggler</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
</span><span id="generate_area_report-215"><a href="#generate_area_report-215"><span class="linenos">215</span></a>    <span class="n">ladder_peak_plot</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Matplotlib</span><span class="p">(</span>
</span><span id="generate_area_report-216"><a href="#generate_area_report-216"><span class="linenos">216</span></a>        <span class="n">ladder_plot</span><span class="o">.</span><span class="n">plot_ladder_peaks</span><span class="p">,</span>
</span><span id="generate_area_report-217"><a href="#generate_area_report-217"><span class="linenos">217</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ladder Peak Plot&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-218"><a href="#generate_area_report-218"><span class="linenos">218</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-219"><a href="#generate_area_report-219"><span class="linenos">219</span></a>    <span class="c1"># Ladder Correlation</span>
</span><span id="generate_area_report-220"><a href="#generate_area_report-220"><span class="linenos">220</span></a>    <span class="n">ladder_correlation_plot</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Matplotlib</span><span class="p">(</span>
</span><span id="generate_area_report-221"><a href="#generate_area_report-221"><span class="linenos">221</span></a>        <span class="n">ladder_plot</span><span class="o">.</span><span class="n">plot_model_fit</span><span class="p">,</span>
</span><span id="generate_area_report-222"><a href="#generate_area_report-222"><span class="linenos">222</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ladder Correlation Plot&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-223"><a href="#generate_area_report-223"><span class="linenos">223</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-224"><a href="#generate_area_report-224"><span class="linenos">224</span></a>
</span><span id="generate_area_report-225"><a href="#generate_area_report-225"><span class="linenos">225</span></a>    <span class="c1"># Section</span>
</span><span id="generate_area_report-226"><a href="#generate_area_report-226"><span class="linenos">226</span></a>    <span class="n">ladder_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">(</span>
</span><span id="generate_area_report-227"><a href="#generate_area_report-227"><span class="linenos">227</span></a>        <span class="n">ladder_peak_plot</span><span class="p">,</span>
</span><span id="generate_area_report-228"><a href="#generate_area_report-228"><span class="linenos">228</span></a>        <span class="n">ladder_correlation_plot</span><span class="p">,</span>
</span><span id="generate_area_report-229"><a href="#generate_area_report-229"><span class="linenos">229</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-230"><a href="#generate_area_report-230"><span class="linenos">230</span></a>    <span class="n">ladder_section</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">ladder_header</span><span class="p">,</span> <span class="n">ladder_tab</span><span class="p">)</span>
</span><span id="generate_area_report-231"><a href="#generate_area_report-231"><span class="linenos">231</span></a>
</span><span id="generate_area_report-232"><a href="#generate_area_report-232"><span class="linenos">232</span></a>    <span class="c1">### ----- Areas Information ----- ###</span>
</span><span id="generate_area_report-233"><a href="#generate_area_report-233"><span class="linenos">233</span></a>    <span class="n">areas_header</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_area_report-234"><a href="#generate_area_report-234"><span class="linenos">234</span></a>        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;## Peak Areas&quot;</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;#04c273&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">textalign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
</span><span id="generate_area_report-235"><a href="#generate_area_report-235"><span class="linenos">235</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-236"><a href="#generate_area_report-236"><span class="linenos">236</span></a>    <span class="n">areas_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">()</span>
</span><span id="generate_area_report-237"><a href="#generate_area_report-237"><span class="linenos">237</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">plot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fraggler</span><span class="o">.</span><span class="n">areas</span><span class="o">.</span><span class="n">area_plots</span><span class="p">):</span>
</span><span id="generate_area_report-238"><a href="#generate_area_report-238"><span class="linenos">238</span></a>        <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Assay </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="generate_area_report-239"><a href="#generate_area_report-239"><span class="linenos">239</span></a>        <span class="n">plot_pane</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Matplotlib</span><span class="p">(</span><span class="n">plot</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="generate_area_report-240"><a href="#generate_area_report-240"><span class="linenos">240</span></a>        <span class="n">areas_tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot_pane</span><span class="p">)</span>
</span><span id="generate_area_report-241"><a href="#generate_area_report-241"><span class="linenos">241</span></a>
</span><span id="generate_area_report-242"><a href="#generate_area_report-242"><span class="linenos">242</span></a>    <span class="c1"># Section</span>
</span><span id="generate_area_report-243"><a href="#generate_area_report-243"><span class="linenos">243</span></a>    <span class="n">areas_section</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">areas_header</span><span class="p">,</span> <span class="n">areas_tab</span><span class="p">)</span>
</span><span id="generate_area_report-244"><a href="#generate_area_report-244"><span class="linenos">244</span></a>
</span><span id="generate_area_report-245"><a href="#generate_area_report-245"><span class="linenos">245</span></a>    <span class="c1">### ----- Peaks DataFrame ----- ###</span>
</span><span id="generate_area_report-246"><a href="#generate_area_report-246"><span class="linenos">246</span></a>    <span class="n">dataframe_header</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_area_report-247"><a href="#generate_area_report-247"><span class="linenos">247</span></a>        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;## Peaks Table&quot;</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;#04c273&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">textalign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
</span><span id="generate_area_report-248"><a href="#generate_area_report-248"><span class="linenos">248</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-249"><a href="#generate_area_report-249"><span class="linenos">249</span></a>
</span><span id="generate_area_report-250"><a href="#generate_area_report-250"><span class="linenos">250</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fraggler</span><span class="o">.</span><span class="n">areas</span><span class="p">,</span> <span class="s2">&quot;final_df&quot;</span><span class="p">):</span>
</span><span id="generate_area_report-251"><a href="#generate_area_report-251"><span class="linenos">251</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">areas</span><span class="o">.</span><span class="n">assays_dataframe</span><span class="p">(</span><span class="n">peak_model</span><span class="p">)</span>
</span><span id="generate_area_report-252"><a href="#generate_area_report-252"><span class="linenos">252</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="generate_area_report-253"><a href="#generate_area_report-253"><span class="linenos">253</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">areas</span><span class="o">.</span><span class="n">final_df</span>
</span><span id="generate_area_report-254"><a href="#generate_area_report-254"><span class="linenos">254</span></a>
</span><span id="generate_area_report-255"><a href="#generate_area_report-255"><span class="linenos">255</span></a>    <span class="c1"># DataFrame Tabulator</span>
</span><span id="generate_area_report-256"><a href="#generate_area_report-256"><span class="linenos">256</span></a>    <span class="n">peaks_df_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Tabulator</span><span class="p">(</span>
</span><span id="generate_area_report-257"><a href="#generate_area_report-257"><span class="linenos">257</span></a>        <span class="n">df</span><span class="p">,</span>
</span><span id="generate_area_report-258"><a href="#generate_area_report-258"><span class="linenos">258</span></a>        <span class="n">layout</span><span class="o">=</span><span class="s2">&quot;fit_columns&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-259"><a href="#generate_area_report-259"><span class="linenos">259</span></a>        <span class="n">pagination</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-260"><a href="#generate_area_report-260"><span class="linenos">260</span></a>        <span class="n">page_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
</span><span id="generate_area_report-261"><a href="#generate_area_report-261"><span class="linenos">261</span></a>        <span class="n">show_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="generate_area_report-262"><a href="#generate_area_report-262"><span class="linenos">262</span></a>        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Peaks Table&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-263"><a href="#generate_area_report-263"><span class="linenos">263</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-264"><a href="#generate_area_report-264"><span class="linenos">264</span></a>
</span><span id="generate_area_report-265"><a href="#generate_area_report-265"><span class="linenos">265</span></a>    <span class="c1"># Section</span>
</span><span id="generate_area_report-266"><a href="#generate_area_report-266"><span class="linenos">266</span></a>    <span class="n">dataframe_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">(</span><span class="n">peaks_df_tab</span><span class="p">)</span>
</span><span id="generate_area_report-267"><a href="#generate_area_report-267"><span class="linenos">267</span></a>    <span class="n">dataframe_section</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">dataframe_header</span><span class="p">,</span> <span class="n">dataframe_tab</span><span class="p">)</span>
</span><span id="generate_area_report-268"><a href="#generate_area_report-268"><span class="linenos">268</span></a>
</span><span id="generate_area_report-269"><a href="#generate_area_report-269"><span class="linenos">269</span></a>    <span class="c1">### CREATE REPORT ###</span>
</span><span id="generate_area_report-270"><a href="#generate_area_report-270"><span class="linenos">270</span></a>
</span><span id="generate_area_report-271"><a href="#generate_area_report-271"><span class="linenos">271</span></a>    <span class="n">file_name</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">fsa</span><span class="o">.</span><span class="n">file_name</span>
</span><span id="generate_area_report-272"><a href="#generate_area_report-272"><span class="linenos">272</span></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">fsa</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="s2">&quot;RUND1&quot;</span><span class="p">]</span>
</span><span id="generate_area_report-273"><a href="#generate_area_report-273"><span class="linenos">273</span></a>    <span class="n">head</span> <span class="o">=</span> <span class="n">make_header</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">date</span><span class="p">)</span>
</span><span id="generate_area_report-274"><a href="#generate_area_report-274"><span class="linenos">274</span></a>
</span><span id="generate_area_report-275"><a href="#generate_area_report-275"><span class="linenos">275</span></a>    <span class="n">all_tabs</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">(</span>
</span><span id="generate_area_report-276"><a href="#generate_area_report-276"><span class="linenos">276</span></a>        <span class="p">(</span><span class="s2">&quot;Channels&quot;</span><span class="p">,</span> <span class="n">channels_section</span><span class="p">),</span>
</span><span id="generate_area_report-277"><a href="#generate_area_report-277"><span class="linenos">277</span></a>        <span class="p">(</span><span class="s2">&quot;Peaks&quot;</span><span class="p">,</span> <span class="n">peaks_section</span><span class="p">),</span>
</span><span id="generate_area_report-278"><a href="#generate_area_report-278"><span class="linenos">278</span></a>        <span class="p">(</span><span class="s2">&quot;Ladder&quot;</span><span class="p">,</span> <span class="n">ladder_section</span><span class="p">),</span>
</span><span id="generate_area_report-279"><a href="#generate_area_report-279"><span class="linenos">279</span></a>        <span class="p">(</span><span class="s2">&quot;Areas&quot;</span><span class="p">,</span> <span class="n">areas_section</span><span class="p">),</span>
</span><span id="generate_area_report-280"><a href="#generate_area_report-280"><span class="linenos">280</span></a>        <span class="p">(</span><span class="s2">&quot;Peak Table&quot;</span><span class="p">,</span> <span class="n">dataframe_section</span><span class="p">),</span>
</span><span id="generate_area_report-281"><a href="#generate_area_report-281"><span class="linenos">281</span></a>        <span class="n">tabs_location</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="generate_area_report-282"><a href="#generate_area_report-282"><span class="linenos">282</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-283"><a href="#generate_area_report-283"><span class="linenos">283</span></a>    <span class="n">report</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
</span><span id="generate_area_report-284"><a href="#generate_area_report-284"><span class="linenos">284</span></a>        <span class="n">head</span><span class="p">,</span>
</span><span id="generate_area_report-285"><a href="#generate_area_report-285"><span class="linenos">285</span></a>        <span class="n">pn</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">Divider</span><span class="p">(),</span>
</span><span id="generate_area_report-286"><a href="#generate_area_report-286"><span class="linenos">286</span></a>        <span class="n">all_tabs</span><span class="p">,</span>
</span><span id="generate_area_report-287"><a href="#generate_area_report-287"><span class="linenos">287</span></a>    <span class="p">)</span>
</span><span id="generate_area_report-288"><a href="#generate_area_report-288"><span class="linenos">288</span></a>
</span><span id="generate_area_report-289"><a href="#generate_area_report-289"><span class="linenos">289</span></a>    <span class="k">return</span> <span class="n">report</span>
</span></pre></div>


    

                </section>
                <section id="generate_no_peaks_report">
                            <input id="generate_no_peaks_report-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">generate_no_peaks_report</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">fsa</span><span class="p">:</span> <span class="n"><a href="#FsaFile">FsaFile</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="generate_no_peaks_report-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#generate_no_peaks_report"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="generate_no_peaks_report-292"><a href="#generate_no_peaks_report-292"><span class="linenos">292</span></a><span class="k">def</span> <span class="nf">generate_no_peaks_report</span><span class="p">(</span><span class="n">fsa</span><span class="p">:</span> <span class="n">FsaFile</span><span class="p">):</span>
</span><span id="generate_no_peaks_report-293"><a href="#generate_no_peaks_report-293"><span class="linenos">293</span></a>    <span class="n">channel_header</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_no_peaks_report-294"><a href="#generate_no_peaks_report-294"><span class="linenos">294</span></a>        <span class="n">text</span><span class="o">=</span><span class="s2">&quot;## Plot of channels&quot;</span><span class="p">,</span>
</span><span id="generate_no_peaks_report-295"><a href="#generate_no_peaks_report-295"><span class="linenos">295</span></a>        <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;#04c273&quot;</span><span class="p">,</span>
</span><span id="generate_no_peaks_report-296"><a href="#generate_no_peaks_report-296"><span class="linenos">296</span></a>        <span class="n">height</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
</span><span id="generate_no_peaks_report-297"><a href="#generate_no_peaks_report-297"><span class="linenos">297</span></a>        <span class="n">textalign</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="generate_no_peaks_report-298"><a href="#generate_no_peaks_report-298"><span class="linenos">298</span></a>    <span class="p">)</span>
</span><span id="generate_no_peaks_report-299"><a href="#generate_no_peaks_report-299"><span class="linenos">299</span></a>    <span class="c1"># PLOT</span>
</span><span id="generate_no_peaks_report-300"><a href="#generate_no_peaks_report-300"><span class="linenos">300</span></a>    <span class="n">channel_tab</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">()</span>
</span><span id="generate_no_peaks_report-301"><a href="#generate_no_peaks_report-301"><span class="linenos">301</span></a>    <span class="k">for</span> <span class="n">plot</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">plot_fsa_data</span><span class="p">(</span><span class="n">fsa</span><span class="p">):</span>
</span><span id="generate_no_peaks_report-302"><a href="#generate_no_peaks_report-302"><span class="linenos">302</span></a>        <span class="n">pane</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Vega</span><span class="p">(</span><span class="n">plot</span><span class="o">.</span><span class="n">interactive</span><span class="p">(),</span> <span class="n">sizing_mode</span><span class="o">=</span><span class="s2">&quot;stretch_both&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="generate_no_peaks_report-303"><a href="#generate_no_peaks_report-303"><span class="linenos">303</span></a>        <span class="n">channel_tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pane</span><span class="p">)</span>
</span><span id="generate_no_peaks_report-304"><a href="#generate_no_peaks_report-304"><span class="linenos">304</span></a>    <span class="n">channels_section</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">channel_header</span><span class="p">,</span> <span class="n">channel_tab</span><span class="p">)</span>
</span><span id="generate_no_peaks_report-305"><a href="#generate_no_peaks_report-305"><span class="linenos">305</span></a>
</span><span id="generate_no_peaks_report-306"><a href="#generate_no_peaks_report-306"><span class="linenos">306</span></a>    <span class="c1">### CREATE REPORT ###</span>
</span><span id="generate_no_peaks_report-307"><a href="#generate_no_peaks_report-307"><span class="linenos">307</span></a>    <span class="n">file_name</span> <span class="o">=</span> <span class="n">fsa</span><span class="o">.</span><span class="n">file_name</span>
</span><span id="generate_no_peaks_report-308"><a href="#generate_no_peaks_report-308"><span class="linenos">308</span></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">fsa</span><span class="o">.</span><span class="n">fsa</span><span class="p">[</span><span class="s2">&quot;RUND1&quot;</span><span class="p">]</span>
</span><span id="generate_no_peaks_report-309"><a href="#generate_no_peaks_report-309"><span class="linenos">309</span></a>    <span class="n">head</span> <span class="o">=</span> <span class="n">header</span><span class="p">(</span>
</span><span id="generate_no_peaks_report-310"><a href="#generate_no_peaks_report-310"><span class="linenos">310</span></a>        <span class="s2">&quot;# No peaks could be generated. Please look at the raw data.&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">100</span>
</span><span id="generate_no_peaks_report-311"><a href="#generate_no_peaks_report-311"><span class="linenos">311</span></a>    <span class="p">)</span>
</span><span id="generate_no_peaks_report-312"><a href="#generate_no_peaks_report-312"><span class="linenos">312</span></a>
</span><span id="generate_no_peaks_report-313"><a href="#generate_no_peaks_report-313"><span class="linenos">313</span></a>    <span class="n">all_tabs</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Tabs</span><span class="p">(</span>
</span><span id="generate_no_peaks_report-314"><a href="#generate_no_peaks_report-314"><span class="linenos">314</span></a>        <span class="p">(</span><span class="s2">&quot;Channels&quot;</span><span class="p">,</span> <span class="n">channels_section</span><span class="p">),</span>
</span><span id="generate_no_peaks_report-315"><a href="#generate_no_peaks_report-315"><span class="linenos">315</span></a>        <span class="n">tabs_location</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="generate_no_peaks_report-316"><a href="#generate_no_peaks_report-316"><span class="linenos">316</span></a>    <span class="p">)</span>
</span><span id="generate_no_peaks_report-317"><a href="#generate_no_peaks_report-317"><span class="linenos">317</span></a>    <span class="n">report</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
</span><span id="generate_no_peaks_report-318"><a href="#generate_no_peaks_report-318"><span class="linenos">318</span></a>        <span class="n">head</span><span class="p">,</span>
</span><span id="generate_no_peaks_report-319"><a href="#generate_no_peaks_report-319"><span class="linenos">319</span></a>        <span class="n">pn</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">Divider</span><span class="p">(),</span>
</span><span id="generate_no_peaks_report-320"><a href="#generate_no_peaks_report-320"><span class="linenos">320</span></a>        <span class="n">all_tabs</span><span class="p">,</span>
</span><span id="generate_no_peaks_report-321"><a href="#generate_no_peaks_report-321"><span class="linenos">321</span></a>    <span class="p">)</span>
</span><span id="generate_no_peaks_report-322"><a href="#generate_no_peaks_report-322"><span class="linenos">322</span></a>
</span><span id="generate_no_peaks_report-323"><a href="#generate_no_peaks_report-323"><span class="linenos">323</span></a>    <span class="k">return</span> <span class="n">report</span>
</span></pre></div>


    

                </section>
                <section id="peak_report">
                            <input id="peak_report-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">peak_report</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">in_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">out_folder</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span>,</span><span class="param">	<span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>,</span><span class="param">	<span class="n">channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;DATA1&#39;</span>,</span><span class="param">	<span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span>,</span><span class="param">	<span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span>,</span><span class="param">	<span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;excel&#39;</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="peak_report-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#peak_report"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="peak_report-160"><a href="#peak_report-160"><span class="linenos">160</span></a><span class="k">def</span> <span class="nf">peak_report</span><span class="p">(</span>
</span><span id="peak_report-161"><a href="#peak_report-161"><span class="linenos">161</span></a>    <span class="n">in_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="peak_report-162"><a href="#peak_report-162"><span class="linenos">162</span></a>    <span class="n">out_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="peak_report-163"><a href="#peak_report-163"><span class="linenos">163</span></a>    <span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="peak_report-164"><a href="#peak_report-164"><span class="linenos">164</span></a>    <span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="peak_report-165"><a href="#peak_report-165"><span class="linenos">165</span></a>    <span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
</span><span id="peak_report-166"><a href="#peak_report-166"><span class="linenos">166</span></a>    <span class="n">channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;DATA1&quot;</span><span class="p">,</span>
</span><span id="peak_report-167"><a href="#peak_report-167"><span class="linenos">167</span></a>    <span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
</span><span id="peak_report-168"><a href="#peak_report-168"><span class="linenos">168</span></a>    <span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="peak_report-169"><a href="#peak_report-169"><span class="linenos">169</span></a>    <span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
</span><span id="peak_report-170"><a href="#peak_report-170"><span class="linenos">170</span></a>    <span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="peak_report-171"><a href="#peak_report-171"><span class="linenos">171</span></a>    <span class="n">out_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;excel&quot;</span><span class="p">,</span>
</span><span id="peak_report-172"><a href="#peak_report-172"><span class="linenos">172</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="peak_report-173"><a href="#peak_report-173"><span class="linenos">173</span></a>
</span><span id="peak_report-174"><a href="#peak_report-174"><span class="linenos">174</span></a>    <span class="k">if</span> <span class="n">custom_peaks</span><span class="p">:</span>
</span><span id="peak_report-175"><a href="#peak_report-175"><span class="linenos">175</span></a>        <span class="n">peak_height</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="peak_report-176"><a href="#peak_report-176"><span class="linenos">176</span></a>
</span><span id="peak_report-177"><a href="#peak_report-177"><span class="linenos">177</span></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ASCII_ART</span><span class="p">)</span>
</span><span id="peak_report-178"><a href="#peak_report-178"><span class="linenos">178</span></a>
</span><span id="peak_report-179"><a href="#peak_report-179"><span class="linenos">179</span></a>    <span class="c1"># Logging</span>
</span><span id="peak_report-180"><a href="#peak_report-180"><span class="linenos">180</span></a>    <span class="n">fraggler</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">(</span><span class="n">out_folder</span><span class="p">)</span>
</span><span id="peak_report-181"><a href="#peak_report-181"><span class="linenos">181</span></a>    <span class="n">INFO</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="peak_report-182"><a href="#peak_report-182"><span class="linenos">182</span></a><span class="s2">    Runned command:</span>
</span><span id="peak_report-183"><a href="#peak_report-183"><span class="linenos">183</span></a><span class="s2">    </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span><span class="si">}</span>
</span><span id="peak_report-184"><a href="#peak_report-184"><span class="linenos">184</span></a>
</span><span id="peak_report-185"><a href="#peak_report-185"><span class="linenos">185</span></a><span class="s2">    Running fraggler with following parameters:</span>
</span><span id="peak_report-186"><a href="#peak_report-186"><span class="linenos">186</span></a><span class="s2">        In path: </span><span class="si">{</span><span class="n">in_path</span><span class="si">}</span>
</span><span id="peak_report-187"><a href="#peak_report-187"><span class="linenos">187</span></a><span class="s2">        Out folder: </span><span class="si">{</span><span class="n">out_folder</span><span class="si">}</span>
</span><span id="peak_report-188"><a href="#peak_report-188"><span class="linenos">188</span></a><span class="s2">        Ladder: </span><span class="si">{</span><span class="n">ladder</span><span class="si">}</span>
</span><span id="peak_report-189"><a href="#peak_report-189"><span class="linenos">189</span></a><span class="s2">        Min ratio: </span><span class="si">{</span><span class="n">min_ratio</span><span class="si">}</span>
</span><span id="peak_report-190"><a href="#peak_report-190"><span class="linenos">190</span></a><span class="s2">        Min height: </span><span class="si">{</span><span class="n">min_height</span><span class="si">}</span>
</span><span id="peak_report-191"><a href="#peak_report-191"><span class="linenos">191</span></a><span class="s2">        Trace channel: </span><span class="si">{</span><span class="n">channel</span><span class="si">}</span>
</span><span id="peak_report-192"><a href="#peak_report-192"><span class="linenos">192</span></a><span class="s2">        Peak Height: </span><span class="si">{</span><span class="n">peak_height</span><span class="si">}</span>
</span><span id="peak_report-193"><a href="#peak_report-193"><span class="linenos">193</span></a><span class="s2">        Custom Peaks: </span><span class="si">{</span><span class="n">custom_peaks</span><span class="si">}</span>
</span><span id="peak_report-194"><a href="#peak_report-194"><span class="linenos">194</span></a><span class="s2">        Out format: </span><span class="si">{</span><span class="n">out_format</span><span class="si">}</span>
</span><span id="peak_report-195"><a href="#peak_report-195"><span class="linenos">195</span></a><span class="s2">        Size standard channel: </span><span class="si">{</span><span class="n">size_standard_channel</span><span class="si">}</span>
</span><span id="peak_report-196"><a href="#peak_report-196"><span class="linenos">196</span></a><span class="s2">        Distance between assays: </span><span class="si">{</span><span class="n">distance_between_assays</span><span class="si">}</span>
</span><span id="peak_report-197"><a href="#peak_report-197"><span class="linenos">197</span></a><span class="s2">    &quot;&quot;&quot;</span>
</span><span id="peak_report-198"><a href="#peak_report-198"><span class="linenos">198</span></a>    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">INFO</span><span class="p">)</span>
</span><span id="peak_report-199"><a href="#peak_report-199"><span class="linenos">199</span></a>
</span><span id="peak_report-200"><a href="#peak_report-200"><span class="linenos">200</span></a>    <span class="c1"># Files</span>
</span><span id="peak_report-201"><a href="#peak_report-201"><span class="linenos">201</span></a>    <span class="n">files</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">get_files</span><span class="p">(</span><span class="n">in_path</span><span class="p">)</span>
</span><span id="peak_report-202"><a href="#peak_report-202"><span class="linenos">202</span></a>    <span class="n">out_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">out_folder</span><span class="p">)</span>
</span><span id="peak_report-203"><a href="#peak_report-203"><span class="linenos">203</span></a>
</span><span id="peak_report-204"><a href="#peak_report-204"><span class="linenos">204</span></a>    <span class="c1"># Generate a peak area report for each file</span>
</span><span id="peak_report-205"><a href="#peak_report-205"><span class="linenos">205</span></a>    <span class="n">failed_files</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="peak_report-206"><a href="#peak_report-206"><span class="linenos">206</span></a>    <span class="n">no_peaks</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="peak_report-207"><a href="#peak_report-207"><span class="linenos">207</span></a>    <span class="n">peak_dfs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="peak_report-208"><a href="#peak_report-208"><span class="linenos">208</span></a>    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span><span id="peak_report-209"><a href="#peak_report-209"><span class="linenos">209</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing file: </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="peak_report-210"><a href="#peak_report-210"><span class="linenos">210</span></a>        <span class="n">fraggler_object</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">make_fraggler_peak</span><span class="p">(</span>
</span><span id="peak_report-211"><a href="#peak_report-211"><span class="linenos">211</span></a>            <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="peak_report-212"><a href="#peak_report-212"><span class="linenos">212</span></a>            <span class="n">ladder</span><span class="o">=</span><span class="n">ladder</span><span class="p">,</span>
</span><span id="peak_report-213"><a href="#peak_report-213"><span class="linenos">213</span></a>            <span class="n">min_height</span><span class="o">=</span><span class="n">min_height</span><span class="p">,</span>
</span><span id="peak_report-214"><a href="#peak_report-214"><span class="linenos">214</span></a>            <span class="n">min_ratio</span><span class="o">=</span><span class="n">min_ratio</span><span class="p">,</span>
</span><span id="peak_report-215"><a href="#peak_report-215"><span class="linenos">215</span></a>            <span class="n">trace_channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span>
</span><span id="peak_report-216"><a href="#peak_report-216"><span class="linenos">216</span></a>            <span class="n">distance_between_assays</span><span class="o">=</span><span class="n">distance_between_assays</span><span class="p">,</span>
</span><span id="peak_report-217"><a href="#peak_report-217"><span class="linenos">217</span></a>            <span class="n">size_standard_channel</span><span class="o">=</span><span class="n">size_standard_channel</span><span class="p">,</span>
</span><span id="peak_report-218"><a href="#peak_report-218"><span class="linenos">218</span></a>            <span class="n">peak_height</span><span class="o">=</span><span class="n">peak_height</span><span class="p">,</span>
</span><span id="peak_report-219"><a href="#peak_report-219"><span class="linenos">219</span></a>            <span class="n">custom_peaks</span><span class="o">=</span><span class="n">custom_peaks</span><span class="p">,</span>
</span><span id="peak_report-220"><a href="#peak_report-220"><span class="linenos">220</span></a>        <span class="p">)</span>
</span><span id="peak_report-221"><a href="#peak_report-221"><span class="linenos">221</span></a>
</span><span id="peak_report-222"><a href="#peak_report-222"><span class="linenos">222</span></a>        <span class="c1"># If make_fraggler_object failed</span>
</span><span id="peak_report-223"><a href="#peak_report-223"><span class="linenos">223</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fraggler_object</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="peak_report-224"><a href="#peak_report-224"><span class="linenos">224</span></a>            <span class="n">failed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fraggler_object</span><span class="p">)</span>
</span><span id="peak_report-225"><a href="#peak_report-225"><span class="linenos">225</span></a>            <span class="n">fsa</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">FsaFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">ladder</span><span class="p">)</span>
</span><span id="peak_report-226"><a href="#peak_report-226"><span class="linenos">226</span></a>            <span class="n">report</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">generate_no_peaks_report</span><span class="p">(</span><span class="n">fsa</span><span class="p">)</span>
</span><span id="peak_report-227"><a href="#peak_report-227"><span class="linenos">227</span></a>            <span class="n">out_name</span> <span class="o">=</span> <span class="n">out_folder</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_fraggler_failed.html&quot;</span>
</span><span id="peak_report-228"><a href="#peak_report-228"><span class="linenos">228</span></a>            <span class="n">report</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">out_name</span><span class="p">)</span>
</span><span id="peak_report-229"><a href="#peak_report-229"><span class="linenos">229</span></a>            <span class="k">continue</span>
</span><span id="peak_report-230"><a href="#peak_report-230"><span class="linenos">230</span></a>
</span><span id="peak_report-231"><a href="#peak_report-231"><span class="linenos">231</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">fraggler_object</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">found_peaks</span><span class="p">:</span>
</span><span id="peak_report-232"><a href="#peak_report-232"><span class="linenos">232</span></a>            <span class="n">no_peaks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span>
</span><span id="peak_report-233"><a href="#peak_report-233"><span class="linenos">233</span></a>            <span class="n">fsa</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">FsaFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">ladder</span><span class="p">)</span>
</span><span id="peak_report-234"><a href="#peak_report-234"><span class="linenos">234</span></a>            <span class="n">report</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">generate_no_peaks_report</span><span class="p">(</span><span class="n">fsa</span><span class="p">)</span>
</span><span id="peak_report-235"><a href="#peak_report-235"><span class="linenos">235</span></a>            <span class="n">out_name</span> <span class="o">=</span> <span class="n">out_folder</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_failed.html&quot;</span>
</span><span id="peak_report-236"><a href="#peak_report-236"><span class="linenos">236</span></a>            <span class="n">report</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">out_name</span><span class="p">)</span>
</span><span id="peak_report-237"><a href="#peak_report-237"><span class="linenos">237</span></a>            <span class="k">continue</span>
</span><span id="peak_report-238"><a href="#peak_report-238"><span class="linenos">238</span></a>
</span><span id="peak_report-239"><a href="#peak_report-239"><span class="linenos">239</span></a>        <span class="c1"># add peaks to dataframe</span>
</span><span id="peak_report-240"><a href="#peak_report-240"><span class="linenos">240</span></a>        <span class="n">df</span> <span class="o">=</span> <span class="n">fraggler_object</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">peak_information</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
</span><span id="peak_report-241"><a href="#peak_report-241"><span class="linenos">241</span></a>            <span class="n">file_name</span><span class="o">=</span><span class="n">fraggler_object</span><span class="o">.</span><span class="n">fsa</span><span class="o">.</span><span class="n">file_name</span>
</span><span id="peak_report-242"><a href="#peak_report-242"><span class="linenos">242</span></a>        <span class="p">)[[</span><span class="s2">&quot;file_name&quot;</span><span class="p">,</span> <span class="s2">&quot;basepairs&quot;</span><span class="p">,</span> <span class="s2">&quot;peaks&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;peaks&quot;</span><span class="p">:</span> <span class="s2">&quot;peak_height&quot;</span><span class="p">})</span>
</span><span id="peak_report-243"><a href="#peak_report-243"><span class="linenos">243</span></a>        <span class="n">peak_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="peak_report-244"><a href="#peak_report-244"><span class="linenos">244</span></a>
</span><span id="peak_report-245"><a href="#peak_report-245"><span class="linenos">245</span></a>        <span class="c1"># generate report</span>
</span><span id="peak_report-246"><a href="#peak_report-246"><span class="linenos">246</span></a>        <span class="n">report</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">generate_peak_report</span><span class="p">(</span><span class="n">fraggler_object</span><span class="p">)</span>
</span><span id="peak_report-247"><a href="#peak_report-247"><span class="linenos">247</span></a>        <span class="n">out_name</span> <span class="o">=</span> <span class="n">out_folder</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_fraggler_peak.html&quot;</span>
</span><span id="peak_report-248"><a href="#peak_report-248"><span class="linenos">248</span></a>        <span class="n">report</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">out_name</span><span class="p">)</span>
</span><span id="peak_report-249"><a href="#peak_report-249"><span class="linenos">249</span></a>
</span><span id="peak_report-250"><a href="#peak_report-250"><span class="linenos">250</span></a>    <span class="c1"># Save dataframe</span>
</span><span id="peak_report-251"><a href="#peak_report-251"><span class="linenos">251</span></a>    <span class="k">if</span> <span class="n">peak_dfs</span><span class="p">:</span>
</span><span id="peak_report-252"><a href="#peak_report-252"><span class="linenos">252</span></a>        <span class="n">save_df_format</span><span class="p">(</span><span class="n">peak_dfs</span><span class="p">,</span> <span class="n">out_folder</span><span class="p">,</span> <span class="n">in_path</span><span class="p">,</span> <span class="n">out_format</span><span class="p">)</span>
</span><span id="peak_report-253"><a href="#peak_report-253"><span class="linenos">253</span></a>
</span><span id="peak_report-254"><a href="#peak_report-254"><span class="linenos">254</span></a>    <span class="c1"># log failed files</span>
</span><span id="peak_report-255"><a href="#peak_report-255"><span class="linenos">255</span></a>    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fraggler done for files in </span><span class="si">{</span><span class="n">in_path</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</span><span id="peak_report-256"><a href="#peak_report-256"><span class="linenos">256</span></a>
</span><span id="peak_report-257"><a href="#peak_report-257"><span class="linenos">257</span></a>    <span class="k">if</span> <span class="n">failed_files</span><span class="p">:</span>
</span><span id="peak_report-258"><a href="#peak_report-258"><span class="linenos">258</span></a>        <span class="n">failed_files</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">failed_files</span><span class="p">)</span>
</span><span id="peak_report-259"><a href="#peak_report-259"><span class="linenos">259</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">YELLOW</span><span class="si">}</span><span class="s2">Following files failed: </span><span class="si">{</span><span class="n">failed_files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="peak_report-260"><a href="#peak_report-260"><span class="linenos">260</span></a>    <span class="k">if</span> <span class="n">no_peaks</span><span class="p">:</span>
</span><span id="peak_report-261"><a href="#peak_report-261"><span class="linenos">261</span></a>        <span class="n">no_peaks</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">no_peaks</span><span class="p">)</span>
</span><span id="peak_report-262"><a href="#peak_report-262"><span class="linenos">262</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">YELLOW</span><span class="si">}</span><span class="s2">Following files had no peaks: </span><span class="si">{</span><span class="n">no_peaks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="area_report">
                            <input id="area_report-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">area_report</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">in_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">out_folder</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">peak_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;gauss&#39;</span>,</span><span class="param">	<span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span>,</span><span class="param">	<span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>,</span><span class="param">	<span class="n">cutoff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">175</span>,</span><span class="param">	<span class="n">channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;DATA1&#39;</span>,</span><span class="param">	<span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span>,</span><span class="param">	<span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span>,</span><span class="param">	<span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;excel&#39;</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="area_report-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#area_report"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="area_report-55"><a href="#area_report-55"><span class="linenos"> 55</span></a><span class="k">def</span> <span class="nf">area_report</span><span class="p">(</span>
</span><span id="area_report-56"><a href="#area_report-56"><span class="linenos"> 56</span></a>    <span class="n">in_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="area_report-57"><a href="#area_report-57"><span class="linenos"> 57</span></a>    <span class="n">out_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="area_report-58"><a href="#area_report-58"><span class="linenos"> 58</span></a>    <span class="n">ladder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="area_report-59"><a href="#area_report-59"><span class="linenos"> 59</span></a>    <span class="n">peak_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gauss&quot;</span><span class="p">,</span>
</span><span id="area_report-60"><a href="#area_report-60"><span class="linenos"> 60</span></a>    <span class="n">min_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
</span><span id="area_report-61"><a href="#area_report-61"><span class="linenos"> 61</span></a>    <span class="n">min_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
</span><span id="area_report-62"><a href="#area_report-62"><span class="linenos"> 62</span></a>    <span class="n">cutoff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">175</span><span class="p">,</span>
</span><span id="area_report-63"><a href="#area_report-63"><span class="linenos"> 63</span></a>    <span class="n">channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;DATA1&quot;</span><span class="p">,</span>
</span><span id="area_report-64"><a href="#area_report-64"><span class="linenos"> 64</span></a>    <span class="n">peak_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
</span><span id="area_report-65"><a href="#area_report-65"><span class="linenos"> 65</span></a>    <span class="n">size_standard_channel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="area_report-66"><a href="#area_report-66"><span class="linenos"> 66</span></a>    <span class="n">distance_between_assays</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
</span><span id="area_report-67"><a href="#area_report-67"><span class="linenos"> 67</span></a>    <span class="n">custom_peaks</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="area_report-68"><a href="#area_report-68"><span class="linenos"> 68</span></a>    <span class="n">out_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;excel&quot;</span><span class="p">,</span>
</span><span id="area_report-69"><a href="#area_report-69"><span class="linenos"> 69</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="area_report-70"><a href="#area_report-70"><span class="linenos"> 70</span></a>
</span><span id="area_report-71"><a href="#area_report-71"><span class="linenos"> 71</span></a>    <span class="nb">print</span><span class="p">(</span><span class="n">ASCII_ART</span><span class="p">)</span>
</span><span id="area_report-72"><a href="#area_report-72"><span class="linenos"> 72</span></a>    <span class="k">if</span> <span class="n">custom_peaks</span><span class="p">:</span>
</span><span id="area_report-73"><a href="#area_report-73"><span class="linenos"> 73</span></a>        <span class="n">peak_height</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="area_report-74"><a href="#area_report-74"><span class="linenos"> 74</span></a>
</span><span id="area_report-75"><a href="#area_report-75"><span class="linenos"> 75</span></a>    <span class="c1"># Logging</span>
</span><span id="area_report-76"><a href="#area_report-76"><span class="linenos"> 76</span></a>    <span class="n">fraggler</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">(</span><span class="n">out_folder</span><span class="p">)</span>
</span><span id="area_report-77"><a href="#area_report-77"><span class="linenos"> 77</span></a>    <span class="n">INFO</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="area_report-78"><a href="#area_report-78"><span class="linenos"> 78</span></a><span class="s2">    Runned command:</span>
</span><span id="area_report-79"><a href="#area_report-79"><span class="linenos"> 79</span></a><span class="s2">    </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span><span class="si">}</span>
</span><span id="area_report-80"><a href="#area_report-80"><span class="linenos"> 80</span></a>
</span><span id="area_report-81"><a href="#area_report-81"><span class="linenos"> 81</span></a><span class="s2">    Running fraggler with following parameters:</span>
</span><span id="area_report-82"><a href="#area_report-82"><span class="linenos"> 82</span></a><span class="s2">        In path: </span><span class="si">{</span><span class="n">in_path</span><span class="si">}</span>
</span><span id="area_report-83"><a href="#area_report-83"><span class="linenos"> 83</span></a><span class="s2">        Out folder: </span><span class="si">{</span><span class="n">out_folder</span><span class="si">}</span>
</span><span id="area_report-84"><a href="#area_report-84"><span class="linenos"> 84</span></a><span class="s2">        Ladder: </span><span class="si">{</span><span class="n">ladder</span><span class="si">}</span>
</span><span id="area_report-85"><a href="#area_report-85"><span class="linenos"> 85</span></a><span class="s2">        Peak model: </span><span class="si">{</span><span class="n">peak_model</span><span class="si">}</span>
</span><span id="area_report-86"><a href="#area_report-86"><span class="linenos"> 86</span></a><span class="s2">        Min ratio: </span><span class="si">{</span><span class="n">min_ratio</span><span class="si">}</span>
</span><span id="area_report-87"><a href="#area_report-87"><span class="linenos"> 87</span></a><span class="s2">        Min height: </span><span class="si">{</span><span class="n">min_height</span><span class="si">}</span>
</span><span id="area_report-88"><a href="#area_report-88"><span class="linenos"> 88</span></a><span class="s2">        Cutoff: </span><span class="si">{</span><span class="n">cutoff</span><span class="si">}</span>
</span><span id="area_report-89"><a href="#area_report-89"><span class="linenos"> 89</span></a><span class="s2">        Trace channel: </span><span class="si">{</span><span class="n">channel</span><span class="si">}</span>
</span><span id="area_report-90"><a href="#area_report-90"><span class="linenos"> 90</span></a><span class="s2">        Peak Height: </span><span class="si">{</span><span class="n">peak_height</span><span class="si">}</span>
</span><span id="area_report-91"><a href="#area_report-91"><span class="linenos"> 91</span></a><span class="s2">        Custom Peaks: </span><span class="si">{</span><span class="n">custom_peaks</span><span class="si">}</span>
</span><span id="area_report-92"><a href="#area_report-92"><span class="linenos"> 92</span></a><span class="s2">        Out format: </span><span class="si">{</span><span class="n">out_format</span><span class="si">}</span>
</span><span id="area_report-93"><a href="#area_report-93"><span class="linenos"> 93</span></a><span class="s2">        Size standard channel: </span><span class="si">{</span><span class="n">size_standard_channel</span><span class="si">}</span>
</span><span id="area_report-94"><a href="#area_report-94"><span class="linenos"> 94</span></a><span class="s2">        Distance between assays: </span><span class="si">{</span><span class="n">distance_between_assays</span><span class="si">}</span>
</span><span id="area_report-95"><a href="#area_report-95"><span class="linenos"> 95</span></a><span class="s2">    &quot;&quot;&quot;</span>
</span><span id="area_report-96"><a href="#area_report-96"><span class="linenos"> 96</span></a>    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">INFO</span><span class="p">)</span>
</span><span id="area_report-97"><a href="#area_report-97"><span class="linenos"> 97</span></a>
</span><span id="area_report-98"><a href="#area_report-98"><span class="linenos"> 98</span></a>    <span class="c1"># Files</span>
</span><span id="area_report-99"><a href="#area_report-99"><span class="linenos"> 99</span></a>    <span class="n">files</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">get_files</span><span class="p">(</span><span class="n">in_path</span><span class="p">)</span>
</span><span id="area_report-100"><a href="#area_report-100"><span class="linenos">100</span></a>    <span class="n">out_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">out_folder</span><span class="p">)</span>
</span><span id="area_report-101"><a href="#area_report-101"><span class="linenos">101</span></a>
</span><span id="area_report-102"><a href="#area_report-102"><span class="linenos">102</span></a>    <span class="c1"># Generate a peak area report for each file</span>
</span><span id="area_report-103"><a href="#area_report-103"><span class="linenos">103</span></a>    <span class="n">failed_files</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="area_report-104"><a href="#area_report-104"><span class="linenos">104</span></a>    <span class="n">no_peaks</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="area_report-105"><a href="#area_report-105"><span class="linenos">105</span></a>    <span class="n">peak_dfs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="area_report-106"><a href="#area_report-106"><span class="linenos">106</span></a>    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span><span id="area_report-107"><a href="#area_report-107"><span class="linenos">107</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing file: </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="area_report-108"><a href="#area_report-108"><span class="linenos">108</span></a>        <span class="n">fraggler_object</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">make_fraggler_area</span><span class="p">(</span>
</span><span id="area_report-109"><a href="#area_report-109"><span class="linenos">109</span></a>            <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
</span><span id="area_report-110"><a href="#area_report-110"><span class="linenos">110</span></a>            <span class="n">ladder</span><span class="o">=</span><span class="n">ladder</span><span class="p">,</span>
</span><span id="area_report-111"><a href="#area_report-111"><span class="linenos">111</span></a>            <span class="n">min_height</span><span class="o">=</span><span class="n">min_height</span><span class="p">,</span>
</span><span id="area_report-112"><a href="#area_report-112"><span class="linenos">112</span></a>            <span class="n">min_ratio</span><span class="o">=</span><span class="n">min_ratio</span><span class="p">,</span>
</span><span id="area_report-113"><a href="#area_report-113"><span class="linenos">113</span></a>            <span class="n">trace_channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span>
</span><span id="area_report-114"><a href="#area_report-114"><span class="linenos">114</span></a>            <span class="n">distance_between_assays</span><span class="o">=</span><span class="n">distance_between_assays</span><span class="p">,</span>
</span><span id="area_report-115"><a href="#area_report-115"><span class="linenos">115</span></a>            <span class="n">size_standard_channel</span><span class="o">=</span><span class="n">size_standard_channel</span><span class="p">,</span>
</span><span id="area_report-116"><a href="#area_report-116"><span class="linenos">116</span></a>            <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
</span><span id="area_report-117"><a href="#area_report-117"><span class="linenos">117</span></a>            <span class="n">peak_height</span><span class="o">=</span><span class="n">peak_height</span><span class="p">,</span>
</span><span id="area_report-118"><a href="#area_report-118"><span class="linenos">118</span></a>            <span class="n">custom_peaks</span><span class="o">=</span><span class="n">custom_peaks</span><span class="p">,</span>
</span><span id="area_report-119"><a href="#area_report-119"><span class="linenos">119</span></a>        <span class="p">)</span>
</span><span id="area_report-120"><a href="#area_report-120"><span class="linenos">120</span></a>
</span><span id="area_report-121"><a href="#area_report-121"><span class="linenos">121</span></a>        <span class="c1"># If make_fraggler_object failed</span>
</span><span id="area_report-122"><a href="#area_report-122"><span class="linenos">122</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fraggler_object</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="area_report-123"><a href="#area_report-123"><span class="linenos">123</span></a>            <span class="n">failed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fraggler_object</span><span class="p">)</span>
</span><span id="area_report-124"><a href="#area_report-124"><span class="linenos">124</span></a>            <span class="n">fsa</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">FsaFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">ladder</span><span class="p">)</span>
</span><span id="area_report-125"><a href="#area_report-125"><span class="linenos">125</span></a>            <span class="n">report</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">generate_no_peaks_report</span><span class="p">(</span><span class="n">fsa</span><span class="p">)</span>
</span><span id="area_report-126"><a href="#area_report-126"><span class="linenos">126</span></a>            <span class="n">out_name</span> <span class="o">=</span> <span class="n">out_folder</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_fraggler_failed.html&quot;</span>
</span><span id="area_report-127"><a href="#area_report-127"><span class="linenos">127</span></a>            <span class="n">report</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">out_name</span><span class="p">)</span>
</span><span id="area_report-128"><a href="#area_report-128"><span class="linenos">128</span></a>            <span class="k">continue</span>
</span><span id="area_report-129"><a href="#area_report-129"><span class="linenos">129</span></a>
</span><span id="area_report-130"><a href="#area_report-130"><span class="linenos">130</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">fraggler_object</span><span class="o">.</span><span class="n">peaks</span><span class="o">.</span><span class="n">found_peaks</span><span class="p">:</span>
</span><span id="area_report-131"><a href="#area_report-131"><span class="linenos">131</span></a>            <span class="n">no_peaks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span>
</span><span id="area_report-132"><a href="#area_report-132"><span class="linenos">132</span></a>            <span class="n">fsa</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">FsaFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">ladder</span><span class="p">)</span>
</span><span id="area_report-133"><a href="#area_report-133"><span class="linenos">133</span></a>            <span class="n">report</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">generate_no_peaks_report</span><span class="p">(</span><span class="n">fsa</span><span class="p">)</span>
</span><span id="area_report-134"><a href="#area_report-134"><span class="linenos">134</span></a>            <span class="n">out_name</span> <span class="o">=</span> <span class="n">out_folder</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_failed.html&quot;</span>
</span><span id="area_report-135"><a href="#area_report-135"><span class="linenos">135</span></a>            <span class="n">report</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">out_name</span><span class="p">)</span>
</span><span id="area_report-136"><a href="#area_report-136"><span class="linenos">136</span></a>            <span class="k">continue</span>
</span><span id="area_report-137"><a href="#area_report-137"><span class="linenos">137</span></a>
</span><span id="area_report-138"><a href="#area_report-138"><span class="linenos">138</span></a>        <span class="c1"># generate report and peak table</span>
</span><span id="area_report-139"><a href="#area_report-139"><span class="linenos">139</span></a>
</span><span id="area_report-140"><a href="#area_report-140"><span class="linenos">140</span></a>        <span class="n">peak_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fraggler_object</span><span class="o">.</span><span class="n">areas</span><span class="o">.</span><span class="n">assays_dataframe</span><span class="p">(</span><span class="n">peak_model</span><span class="p">))</span>
</span><span id="area_report-141"><a href="#area_report-141"><span class="linenos">141</span></a>        <span class="n">report</span> <span class="o">=</span> <span class="n">fraggler</span><span class="o">.</span><span class="n">generate_area_report</span><span class="p">(</span><span class="n">fraggler_object</span><span class="p">,</span> <span class="n">peak_model</span><span class="p">)</span>
</span><span id="area_report-142"><a href="#area_report-142"><span class="linenos">142</span></a>        <span class="n">out_name</span> <span class="o">=</span> <span class="n">out_folder</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_fraggler_area.html&quot;</span>
</span><span id="area_report-143"><a href="#area_report-143"><span class="linenos">143</span></a>        <span class="n">report</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">out_name</span><span class="p">)</span>
</span><span id="area_report-144"><a href="#area_report-144"><span class="linenos">144</span></a>
</span><span id="area_report-145"><a href="#area_report-145"><span class="linenos">145</span></a>    <span class="c1"># Save dataframe</span>
</span><span id="area_report-146"><a href="#area_report-146"><span class="linenos">146</span></a>    <span class="k">if</span> <span class="n">peak_dfs</span><span class="p">:</span>
</span><span id="area_report-147"><a href="#area_report-147"><span class="linenos">147</span></a>        <span class="n">save_df_format</span><span class="p">(</span><span class="n">peak_dfs</span><span class="p">,</span> <span class="n">out_folder</span><span class="p">,</span> <span class="n">in_path</span><span class="p">,</span> <span class="n">out_format</span><span class="p">)</span>
</span><span id="area_report-148"><a href="#area_report-148"><span class="linenos">148</span></a>
</span><span id="area_report-149"><a href="#area_report-149"><span class="linenos">149</span></a>    <span class="c1"># log failed files</span>
</span><span id="area_report-150"><a href="#area_report-150"><span class="linenos">150</span></a>    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fraggler done for files in </span><span class="si">{</span><span class="n">in_path</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
</span><span id="area_report-151"><a href="#area_report-151"><span class="linenos">151</span></a>
</span><span id="area_report-152"><a href="#area_report-152"><span class="linenos">152</span></a>    <span class="k">if</span> <span class="n">failed_files</span><span class="p">:</span>
</span><span id="area_report-153"><a href="#area_report-153"><span class="linenos">153</span></a>        <span class="n">failed_files</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">failed_files</span><span class="p">)</span>
</span><span id="area_report-154"><a href="#area_report-154"><span class="linenos">154</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">YELLOW</span><span class="si">}</span><span class="s2">Following files failed: </span><span class="si">{</span><span class="n">failed_files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="area_report-155"><a href="#area_report-155"><span class="linenos">155</span></a>    <span class="k">if</span> <span class="n">no_peaks</span><span class="p">:</span>
</span><span id="area_report-156"><a href="#area_report-156"><span class="linenos">156</span></a>        <span class="n">no_peaks</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">no_peaks</span><span class="p">)</span>
</span><span id="area_report-157"><a href="#area_report-157"><span class="linenos">157</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">YELLOW</span><span class="si">}</span><span class="s2">Following files had no peaks: </span><span class="si">{</span><span class="n">no_peaks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


    

                </section>
    </main>
</body>
</html>